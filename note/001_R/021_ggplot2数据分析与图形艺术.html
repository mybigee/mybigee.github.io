<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<script src="https://note.ilulj.top/script/script.js"></script>
<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
  --mermaid-theme: night;
}

[lang='mermaid'] .label {
  color: #333;
}

/* CSS Document */

/** code highlight */

.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable {
    color: #b8bfc6;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

.CodeMirror-gutters {
    border-right: none;
}

/* CSS Document */

/** markdown source **/
.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property
{
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
	color: #8aa1e1;
}@import "";
@import "";
@import "";

:root {
    --bg-color:  #363B40;
    --side-bar-bg-color: #2E3033;
    --text-color: #b8bfc6;

    --select-text-bg-color:#4a89dc;

    --item-hover-bg-color: #0a0d16;
    --control-text-color: #b7b7b7;
    --control-text-hover-color: #eee;
    --window-border: 1px solid #555;

    --active-file-bg-color: rgb(34, 34, 34);
    --active-file-border-color: #8d8df0;

    --primary-color: #a3d5fe;

    --active-file-text-color: white;
    --item-hover-bg-color: #70717d;
    --item-hover-text-color: white;
    --primary-color: #6dc1e7;

    --rawblock-edit-panel-bd: #333;

    --search-select-bg-color: #428bca;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

html,
body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    background: #363B40;
    background: var(--bg-color);
    fill: currentColor;
    line-height: 1.625rem;
}

#write {
    max-width: 914px;
}


@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
    color: #b8bfc6;
    border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after {
    background: #333;
}

.native-window #md-notification {
    border: 1px solid #70717d;
}

.popover.bottom > .arrow:after {
    border-bottom-color: #333;
}

html,
body,
button,
input,
select,
textarea {
    font-family: "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
}

hr {
    height: 2px;
    border: 0;
    margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: "Lucida Grande", "Corbel", sans-serif;
    font-weight: normal;
    clear: both;
    -ms-word-wrap: break-word;
    word-wrap: break-word;
    margin: 0;
    padding: 0;
    color: #DEDEDE
}

h1 {
    font-size: 2.5rem;
    /* 36px */
    line-height: 2.75rem;
    /* 40px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1.5px;
}

h2 {
    font-size: 1.63rem;
    /* 24px */
    line-height: 1.875rem;
    /* 30px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h3 {
    font-size: 1.17rem;
    /* 18px */
    line-height: 1.5rem;
    /* 24px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h4 {
    font-size: 1.12rem;
    /* 16px */
    line-height: 1.375rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    color: white;
}

h5 {
    font-size: 0.97rem;
    /* 16px */
    line-height: 1.25rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    font-weight: bold;
}

h6 {
    font-size: 0.93rem;
    /* 16px */
    line-height: 1rem;
    /* 16px */
    margin-bottom: 0.75rem;
    color: white;
}

@media (min-width: 980px) {
    h3.md-focus:before,
    h4.md-focus:before,
    h5.md-focus:before,
    h6.md-focus:before {
        color: #ddd;
        border: 1px solid #ddd;
        border-radius: 3px;
        position: absolute;
        left: -1.642857143rem;
        top: .357142857rem;
        float: left;
        font-size: 9px;
        padding-left: 2px;
        padding-right: 2px;
        vertical-align: bottom;
        font-weight: normal;
        line-height: normal;
    }

    h3.md-focus:before {
        content: 'h3';
    }

    h4.md-focus:before {
        content: 'h4';
    }

    h5.md-focus:before {
        content: 'h5';
        top: 0px;
    }

    h6.md-focus:before {
        content: 'h6';
        top: 0px;
    }
}

a {
    text-decoration: none;
    outline: 0;
}

a:hover {
    outline: 0;
}

a:focus {
    outline: thin dotted;
}

sup.md-footnote {
    background-color: #555;
    color: #ddd;
}

p {
    -ms-word-wrap: break-word;
    word-wrap: break-word;
}

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode {
    margin-top: 0;
    margin-bottom: 1.5rem;
    /* 24px */
}

audio:not([controls]) {
    display: none;
}

[hidden] {
    display: none;
}

::-moz-selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

*.in-text-selection,
::selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

ul,
ol {
    padding: 0 0 0 1.875rem;
    /* 30px */
}

ul {
    list-style: square;
}

ol {
    list-style: decimal;
}

ul ul,
ol ol,
ul ol,
ol ul {
    margin: 0;
}

b,
th,
dt,
strong {
    font-weight: bold;
}

i,
em,
dfn,
cite {
    font-style: italic;
}

blockquote {
    padding-left: 1.875rem;
    margin: 0 0 1.875rem 1.875rem;
    border-left: solid 2px #474d54;
    padding-left: 30px;
    margin-top: 35px;
}

pre,
code,
kbd,
tt,
var {
    font-size: 0.875em;
    font-family: Monaco, Consolas, "Andale Mono", "DejaVu Sans Mono", monospace;
}

code,
tt,
var {
    background: rgba(0, 0, 0, 0.05);
}

kbd {
    padding: 2px 4px;
    font-size: 90%;
    color: #fff;
    background-color: #333;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
}

pre.md-fences {
    padding: 10px 10px 10px 30px;
    margin-bottom: 20px;
    background: #333;
}

.CodeMirror-gutters {
    background: #333;
    border-right: 1px solid transparent;
}

.enable-diagrams pre.md-fences[lang="sequence"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="flow"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="mermaid"] .code-tooltip {
    bottom: -2.2em;
    right: 4px;
}

code,
kbd,
tt,
var {
    padding: 2px 5px;
}

table {
    max-width: 100%;
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

th,
td {
    padding: 5px 10px;
    vertical-align: top;
}

a {
    -webkit-transition: all .2s ease-in-out;
    transition: all .2s ease-in-out;
}

hr {
    background: #474d54;
    /* variable */
}

h1 {
    margin-top: 2em;
}

a {
    color: #e0e0e0;
    text-decoration: underline;
}

a:hover {
    color: #fff;
}

.md-inline-math script {
    color: #81b1db;
}

b,
th,
dt,
strong {
    color: #DEDEDE;
    /* variable */
}

mark {
    background: #D3D40E;
}

blockquote {
    color: #9DA2A6;
}

table a {
    color: #DEDEDE;
    /* variable */
}

th,
td {
    border: solid 1px #474d54;
    /* variable */
}

.task-list {
    padding-left: 0;
}

.md-task-list-item {
    padding-left: 1.25rem;
}

.md-task-list-item > input {
    top: auto;
}

.md-task-list-item > input:before {
    content: "";
    display: inline-block;
    width: 0.875rem;
    height: 0.875rem;
    vertical-align: middle;
    text-align: center;
    border: 1px solid #b8bfc6;
    background-color: #363B40;
    margin-top: -0.4rem;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
    content: '\221A';
    /*◘*/
    font-size: 0.625rem;
    line-height: 0.625rem;
    color: #DEDEDE;
}

/** quick open **/
.auto-suggest-container {
    border: 0px;
    background-color: #525C65;
}

#typora-quick-open {
    background-color: #525C65;
}

#typora-quick-open input{
    background-color: #525C65;
    border: 0;
    border-bottom: 1px solid grey;
}

.typora-quick-open-item {
    background-color: inherit;
    color: inherit;
}

.typora-quick-open-item.active,
.typora-quick-open-item:hover {
    background-color: #4D8BDB;
    color: white;
}

.typora-quick-open-item:hover {
    background-color: rgba(77, 139, 219, 0.8);
}

.typora-search-spinner > div {
  background-color: #fff;
}

#write pre.md-meta-block {
    border-bottom: 1px dashed #ccc;
    background: transparent;
    padding-bottom: 0.6em;
    line-height: 1.6em;
}

.btn,
.btn .btn-default {
    background: transparent;
    color: #b8bfc6;
}

.ty-table-edit {
    border-top: 1px solid gray;
    background-color: #363B40;
}

.popover-title {
    background: transparent;
}

.md-image>.md-meta {
    color: #BBBBBB;
    background: transparent;
}

.md-expand.md-image>.md-meta {
    color: #DDD;
}

#write>h3:before,
#write>h4:before,
#write>h5:before,
#write>h6:before {
    border: none;
    border-radius: 0px;
    color: #888;
    text-decoration: underline;
    left: -1.4rem;
    top: 0.2rem;
}

#write>h3.md-focus:before {
    top: 2px;
}

#write>h4.md-focus:before {
    top: 2px;
}

.md-toc-item {
    color: #A8C2DC;
}

#write div.md-toc-tooltip {
    background-color: #363B40;
}

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus {
    color: white;
    background: black;
}

#toc-dropmenu {
    background: rgba(50, 54, 59, 0.93);
    border: 1px solid rgba(253, 253, 253, 0.15);
}

#toc-dropmenu .divider {
    background-color: #9b9b9b;
}

.outline-expander:before {
    top: 2px;
}

#typora-sidebar {
    box-shadow: none;
    border-right: 1px dashed;
    border-right: none;
}

.sidebar-tabs {
    border-bottom:0;
}

#typora-sidebar:hover .outline-title-wrapper {
    border-left: 1px dashed;
}

.outline-title-wrapper .btn {
    color: inherit;
}

.outline-item:hover {
    border-color: #363B40;
    background-color: #363B40;
    color: white;
}

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr {
    color: #8C8E92;
    display: inline;
}

.md-comment {
    color: #5a95e3;
    opacity: 0.8;
}

.md-inline-math svg {
    color: #b8bfc6;
}

#math-inline-preview .md-arrow:after {
    background: black;
}

.modal-content {
    background: var(--bg-color);
    border: 0;
}

.modal-title {
    font-size: 1.5em;
}

.modal-content input {
    background-color: rgba(26, 21, 21, 0.51);
    color: white;
}

.modal-content .input-group-addon {
    color: white;
}

.modal-backdrop {
    background-color: rgba(174, 174, 174, 0.7);
}

.modal-content .btn-primary {
    border-color: var(--primary-color);
}

.md-table-resize-popover {
    background-color: #333;
}

.form-inline .input-group .input-group-addon {
    color: white;
}

#md-searchpanel {
    border-bottom: 1px dashed grey;
}

/** UI for electron */

.context-menu,
#spell-check-panel,
#footer-word-count-info {
    background-color: #42464A;
}

.context-menu.dropdown-menu .divider,
.dropdown-menu .divider {
    background-color: #777777;
    opacity: 1;
}

footer {
    color: inherit;
}

@media (max-width: 1000px) {
    footer {
        border-top: none;
    }
    footer:hover {
        color: inherit;
    }
}

#file-info-file-path .file-info-field-value:hover {
    background-color: #555;
    color: #dedede;
}

.megamenu-content,
.megamenu-opened header {
    background: var(--bg-color);
}

.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn {
    color: inherit;
}

.megamenu-menu-panel input[type='text'] {
    background: inherit;
    border: 0;
    border-bottom: 1px solid;
}

#recent-file-panel-action-btn {
    background: inherit;
    border: 1px grey solid;
}

.megamenu-menu-panel .dropdown-menu > li > a {
    color: inherit;
    background-color: #2F353A;
    text-decoration: none;
}

.megamenu-menu-panel table td:nth-child(1) {
    color: inherit;
    font-weight: bold;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(1) {
    color: white;
}

.modal-footer .btn-default, 
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) {
    border: 1px solid;
    border-color: transparent;
}

.btn-primary {
    color: white;
}

.btn-default:hover, .btn-default:focus, .btn-default.focus, .btn-default:active, .btn-default.active, .open > .dropdown-toggle.btn-default {
    color: white;
    border: 1px solid #ddd;
    background-color: inherit;
}

.modal-header {
    border-bottom: 0;
}

.modal-footer {
    border-top: 0;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
    border: 1px solid #eee;
    background: transparent;
}

.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover {
    background-color: inherit;
}

.typora-node::-webkit-scrollbar {
    width: 5px;
}

.typora-node::-webkit-scrollbar-thumb:vertical {
    background: rgba(250, 250, 250, 0.3);
}

.typora-node::-webkit-scrollbar-thumb:vertical:active {
    background: rgba(250, 250, 250, 0.5);
}

#w-unpin {
    background-color: #4182c4;
}

#top-titlebar, #top-titlebar * {
    color: var(--item-hover-text-color);
}

.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count {
    background: #333333;
}

#toggle-sourceview-btn:hover {
    color: #eee;
    background: #333333;
}

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * {
    color: #686868 !important;
}

.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container)>input {
    opacity: #686868 !important;
}

.on-focus-mode li[cid]:not(.md-focus-container){
    color: #686868;
}

.on-focus-mode .md-fences.md-focus .CodeMirror-code>*:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * {
    color: #686868 !important;
}

.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container {
    color: #fff;
}

.on-focus-mode #typora-source .CodeMirror-code>*:not(.CodeMirror-activeline) * {
    color: #686868 !important;
}


/*diagrams*/
#write .md-focus .md-diagram-panel {
    border: 1px solid #ddd;
    margin-left: -1px;
    width: calc(100% + 2px);
}

/*diagrams*/
#write .md-focus.md-fences-with-lineno .md-diagram-panel {
    margin-left: auto;
}

.md-diagram-panel-error {
    color: #f1908e;
}

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover {
    color: #eee;
}

.sidebar-footer-item:hover,
.footer-item:hover {
    background: inherit;
    color: white;
}

.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after {
    color: white;
}

#sidebar-files-menu {
    border:solid 1px;
    box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.79);
    background-color: var(--bg-color);
}

.file-list-item {
    border-bottom:none;
}

.file-list-item-summary {
    opacity: 1;
}

.file-list-item.active:first-child {
    border-top: none;
}

.file-node-background {
    height: 32px;
}

.file-library-node.active>.file-node-content,
.file-list-item.active {
    color: white;
    color: var(--active-file-text-color);
}

.file-library-node.active>.file-node-background{
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}
.file-list-item.active {
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}

#ty-tooltip {
    background-color: black;
    color: #eee;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: 0.3rem;
    -webkit-appearance: none;
}

.md-mathjax-midline {
    background-color: #57616b;
    border-bottom: none;
}

footer.ty-footer {
    border-color: #656565;
}

.ty-preferences .btn-default {
    background: transparent;
}
.ty-preferences .btn-default:hover {
    background: #57616b;
}

.ty-preferences select {
    border: 1px solid #989698;
    height: 21px;
}

.ty-preferences .nav-group-item.active,
.export-item.active,
.export-items-list-control,
.export-detail {
    background: var(--item-hover-bg-color);
}

.ty-preferences input[type="search"] {
    border-color: #333;
    background: #333;
    line-height: 22px;
    border-radius: 6px;
    color: white;
}

.ty-preferences input[type="search"]:focus {
    box-shadow: none;
}

[data-is-directory="true"] .file-node-content {
    margin-bottom: 0;
}

.file-node-title {
    line-height: 22px;
}

.html-for-mac .file-node-open-state, .html-for-mac .file-node-icon {
    line-height: 26px;
}

::-webkit-scrollbar-thumb {
    background: rgba(230, 230, 230, 0.30);
}

::-webkit-scrollbar-thumb:active {
    background: rgba(230, 230, 230, 0.50);
}

#typora-sidebar:hover div.sidebar-content-content::-webkit-scrollbar-thumb:horizontal {
    background: rgba(230, 230, 230, 0.30);
}

.nav-group-item:active {
    background-color: #474d54 !important;
}

.md-search-hit {
    background: rgba(199, 140, 60, 0.81);
    color: #eee;
}

.md-search-hit * {
    color: #eee;
}

#md-searchpanel input {
    color: white;
}

.modal-backdrop.in {
    opacity: 1;
    backdrop-filter: blur(1px);
}

.clear-btn-icon {
    top: 8px;
}


</style><title>021_ggplot2数据分析与图形艺术</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='ggplot2数据分析与图形艺术'><span>ggplot2数据分析与图形艺术</span></h1><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n877"><a class="md-toc-inner" href="#ggplot2数据分析与图形艺术">ggplot2数据分析与图形艺术</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n879"><a class="md-toc-inner" href="#第1章-简介">第1章 简介</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n888"><a class="md-toc-inner" href="#第2章-ggplot2入门">第2章 ggplot2入门</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n889"><a class="md-toc-inner" href="#数据集">数据集</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n917"><a class="md-toc-inner" href="#示例">示例</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n939"><a class="md-toc-inner" href="#图形属性">图形属性</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n983"><a class="md-toc-inner" href="#分面">分面</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1014"><a class="md-toc-inner" href="#几何对象">几何对象</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1037"><a class="md-toc-inner" href="#geomsmooth">geom_smooth()</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1073"><a class="md-toc-inner" href="#箱线图和扰动点图">箱线图和扰动点图</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1096"><a class="md-toc-inner" href="#直方图和频数多边图">直方图和频数多边图</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1137"><a class="md-toc-inner" href="#条形图">条形图</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1157"><a class="md-toc-inner" href="#时间序列中的折线图和路径图">时间序列中的折线图和路径图</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1212"><a class="md-toc-inner" href="#修饰坐标轴">修饰坐标轴</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1239"><a class="md-toc-inner" href="#输出">输出</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1263"><a class="md-toc-inner" href="#快速绘图qplot">快速绘图qplot()</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n1285"><a class="md-toc-inner" href="#第3章-工具箱">第3章 工具箱</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1286"><a class="md-toc-inner" href="#基本图形类型">基本图形类型</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1319"><a class="md-toc-inner" href="#标签label">标签label</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1392"><a class="md-toc-inner" href="#注解">注解</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1441"><a class="md-toc-inner" href="#群体几何对象">群体几何对象</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1586"><a class="md-toc-inner" href="#曲面图">曲面图</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1604"><a class="md-toc-inner" href="#绘制地图">绘制地图</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1608"><a class="md-toc-inner" href="#矢量边界">矢量边界</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1635"><a class="md-toc-inner" href="#点状元数据">点状元数据</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1652"><a class="md-toc-inner" href="#光栅图">光栅图</a></span><span role="listitem" class="md-toc-item md-toc-h4" data-ref="n1658"><a class="md-toc-inner" href="#区域元数据">区域元数据</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1662"><a class="md-toc-inner" href="#不确定性关系">不确定性关系</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n1705"><a class="md-toc-inner" href="#含权数据">含权数据</a></span></p></div><h2 id='第1章-简介'><span>第1章 简介</span></h2><ul><li><p><span>一张图就是从数据到几何对象（geometric object，简称geom，包括点、线、条形等）的图形属性(aesthetic attributes，缩写为 aes，包括颜色、形状、大小等)的一个映射。此外，图形中还可能包含数据的统计变换(statistical transformation，缩写为 stat)，最后绘制在某个特定的坐标系 (coordinate system，缩写为 coord)中，而分面 (facet，指将绘图窗口划分为若干个子窗口)则可以用来生成不同数据子集的同一个图形。总而言之，一张统计图形就是由上述这些独立的图形部件所组成的。</span></p></li><li><p><span>所有的图形都由以下部件组成：数据（data）、图层（layer）、标度（scale）、坐标系（coord）、分面（facet）、主题（theme）</span></p></li><li><p><span>安装ggplot2：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"ggplot2"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre></li></ul><h2 id='第2章-ggplot2入门'><span>第2章 ggplot2入门</span></h2><h3 id='数据集'><span>数据集</span></h3><ul><li><p><span>本章使用的数据集：ggplot2自带的数据集</span><code>mpg</code><span>，它记录了美国 1999 年和2008 年部分汽车的制造厂商、型号、类别、驱动系统和耗油量等信息。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">manufacturer</span> <span class="cm-variable">model</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">displ</span> &nbsp;<span class="cm-variable">year</span> &nbsp; <span class="cm-variable">cyl</span> <span class="cm-variable">trans</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">drv</span> &nbsp; &nbsp; <span class="cm-variable">cty</span> &nbsp; <span class="cm-variable">hwy</span> <span class="cm-variable">fl</span> &nbsp; &nbsp;<span class="cm-variable">class</span> &nbsp;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">dbl</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">1</span> <span class="cm-variable">audi</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">a4</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1.8</span> &nbsp;<span class="cm-number">1999</span> &nbsp; &nbsp; <span class="cm-number">4</span> <span class="cm-variable">auto</span>(<span class="cm-variable">l5</span>) &nbsp; <span class="cm-variable">f</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">18</span> &nbsp; &nbsp;<span class="cm-number">29</span> <span class="cm-variable">p</span> &nbsp; &nbsp; <span class="cm-variable">compact</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">2</span> <span class="cm-variable">audi</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">a4</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1.8</span> &nbsp;<span class="cm-number">1999</span> &nbsp; &nbsp; <span class="cm-number">4</span> <span class="cm-variable">manual</span>(<span class="cm-variable">m5</span>) <span class="cm-variable">f</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">21</span> &nbsp; &nbsp;<span class="cm-number">29</span> <span class="cm-variable">p</span> &nbsp; &nbsp; <span class="cm-variable">compact</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ul><li><span>cty 和 hwy 分别记录城市和高速公路驾驶耗油量</span></li><li><span>displ表示发动机排量</span></li><li><span>drv 表示驱动系统：前轮驱动 (f)后轮动(r)和四驱动(4)</span></li><li><span>model 表示车辆型号</span></li><li><span>class表示车辆类别</span></li></ul></li><li><p><span>练习题：</span></p><ul><li><p><span>列举五个可以用于获取 mpg 数据集信息的函数：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="R"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mpg</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">?<span class="cm-variable">mpg</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">help</span>(<span class="cm-variable">mpg</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">View</span>(<span class="cm-variable">mpg</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">str</span>(<span class="cm-variable">mpg</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">mpg</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tail</span>(<span class="cm-variable">mpg</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre></li><li><p><span>如何获取 ggplot2内置的其他数据集?</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>(<span class="cm-variable">package</span><span class="cm-operator">=</span><span class="cm-string">"ggplot2"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre></li><li><p><span>数据集中，哪个制造商有最多车型?哪个车型的型号最丰富?</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">models</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tapply</span>(<span class="cm-variable">mpg</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">model</span>, <span class="cm-variable">mpg</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">manufacturer</span>, <span class="cm-variable">table</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nums</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sapply</span>(<span class="cm-variable">models</span>, <span class="cm-variable">length</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-variable">nums</span>[<span class="cm-variable">max</span>(<span class="cm-variable">nums</span>) <span class="cm-operator">==</span> <span class="cm-variable">nums</span>]<span class="cm-tab" role="presentation" cm-text="	"> </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># toyota </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># &nbsp;  6 </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">classs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tapply</span>(<span class="cm-variable">mpg</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">class</span>, <span class="cm-variable">mpg</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">model</span>, <span class="cm-variable">table</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nums</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sapply</span>(<span class="cm-variable">classs</span>, <span class="cm-variable">length</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nums</span>[<span class="cm-variable">max</span>(<span class="cm-variable">nums</span>) <span class="cm-operator">==</span> <span class="cm-variable">nums</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># &nbsp; &nbsp;  altima impreza awd </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># &nbsp; &nbsp; &nbsp; &nbsp; 2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 261px;"></div><div class="CodeMirror-gutters" style="display: none; height: 261px;"></div></div></div></pre></li></ul></li></ul><h3 id='示例'><span>示例</span></h3><ul><li><p><span>ggplot2图像的三个基本构成：</span></p><ol start='' ><li><span>数据。</span></li><li><span>图形属性映射，设定变量如何映射到图层的图形属性上。</span></li><li><span>几何对象，至少一层，用于指定绘图所用的几何对象。</span></li></ol></li><li><p><span>示例代码：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># mpg:数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># aes(x = displ,y = hwy):图形属性映射</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># geom_point():几何对象，散点图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">displ</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ul><li><span>这里的 </span><code>+</code><span> 表示 添加图层。</span></li></ul></li></ul><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 001.png" alt="第2章 001" style="zoom: 67%;" /></p><ul><li><p><span>练习题：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">model</span>,<span class="cm-variable">manufacturer</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cty</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">diamonds</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">carat</span>,<span class="cm-variable">price</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cty</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_histogram</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre></li></ul><h3 id='图形属性'><span>图形属性</span></h3><ul><li><span>颜色属性，写入</span><code>aes()</code><span>中，如：</span><code>aes(color=class)</code><span>，其中color（美式）既可以写为colour（英式）或缩写为col。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">class</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 002.png" alt="第2章 002" style="zoom:67%;" /></p><ul><li><p><span>对比：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"blue"</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"blue"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 003.png" referrerpolicy="no-referrer" alt="第2章 003"></th><th><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 004.png" referrerpolicy="no-referrer" alt="第2章 004"></th></tr></thead><tbody></tbody></table></figure><ul><li><span>左边图中，蓝色经过标度变换，变为了粉色，而右图却是正常的蓝色。</span></li></ul></li><li><p><span>形状属性：</span><code>shape</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">shape</span> <span class="cm-operator">=</span> <span class="cm-variable">drv</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre></li><li><p><span>大小属性：</span><code>size</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-variable">cyl</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre></li></ul><figure><table><thead><tr><th><span>shape</span></th><th><span>size</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 005.png" referrerpolicy="no-referrer" alt="第2章 005"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 006.png" referrerpolicy="no-referrer" alt="第2章 006"></td></tr></tbody></table></figure><ul><li><p><span>练习题：</span></p><ul><li><span>练习使用颜色、形状和大小等图形属性。把它们映射为连续型变量时是什么样的?映射为分类变量呢?在图像中映射多个图形属性效果如何?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 连续变量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mydf</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">100</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-variable">sin</span>(<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">100</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mydf</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">shape</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Error</span> <span class="cm-keyword">in</span> <span class="cm-variable-3">`geom_point()`</span><span class="cm-operator">:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">!</span> <span class="cm-variable">Problem</span> <span class="cm-keyword">while</span> <span class="cm-variable">computing</span> <span class="cm-variable">aesthetics.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ℹ <span class="cm-variable">Error</span> <span class="cm-variable">occurred</span> <span class="cm-keyword">in</span> <span class="cm-variable">the</span> <span class="cm-number">1</span><span class="cm-variable">st</span> <span class="cm-variable">layer.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Caused</span> <span class="cm-variable">by</span> <span class="cm-variable">error</span> <span class="cm-keyword">in</span> <span class="cm-variable-3">`scale_f()`</span><span class="cm-operator">:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">!</span> <span class="cm-variable">A</span> <span class="cm-variable">continuous</span> <span class="cm-variable">variable</span> <span class="cm-variable">cannot</span> <span class="cm-variable">be</span> <span class="cm-variable">mapped</span> <span class="cm-variable">to</span> <span class="cm-variable">the</span> <span class="cm-variable">shape</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">aesthetic</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ℹ <span class="cm-variable">choose</span> <span class="cm-variable">a</span> <span class="cm-variable">different</span> <span class="cm-variable">aesthetic</span> <span class="cm-variable">or</span> <span class="cm-variable">use</span> <span class="cm-variable-3">`scale_shape_binned()`</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Run</span> <span class="cm-variable-3">`rlang::last_error()`</span> <span class="cm-variable">to</span> <span class="cm-variable">see</span> <span class="cm-variable">where</span> <span class="cm-variable">the</span> <span class="cm-variable">error</span> <span class="cm-variable">occurred.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 分类变量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mydf</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">100</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">rep</span>(<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,<span class="cm-number">100</span>),<span class="cm-variable">LETTERS</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mydf</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">shape</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 007.png" alt="第2章 007" style="zoom:67%;" /></p><ul><li><span>把 trans 映射为形状又是什么样呢?为什么?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">shape</span><span class="cm-operator">=</span><span class="cm-variable">trans</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 008.png" alt="第2章 008" style="zoom: 67%;" /></p></li></ul><h3 id='分面'><span>分面</span></h3><ul><li><span>它会将数据分割为若干子集，然后创建图形的矩阵，再把每一个子集绘制到图形矩阵的窗格中。</span></li><li><span>分面可以分为两种类型：</span><strong><span>网格型</span></strong><span>和</span><strong><span>封装型</span></strong><span>。由于封装型更为常用，所以此处我们主要讨论封装型，今后再学习网格型。对图像进行分面处理只需加入代码</span><code>facet_wrap()</code><span>，括号中输入</span><code>~和分类变量</code><span>。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">class</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 009.png" alt="第2章 009" style="zoom:67%;" /></p><ul><li><p><span>练习题：</span></p><ul><li><span>对连续型变量如 hwy 进行分面会怎么样?对于 cyl呢?其中主要区别是什么?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">hwy</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># cyl报错</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 010.png" alt="第2章 010" style="zoom:67%;" /></p><ul><li><span>阅读 facet_wrap()相关说明，思考应当如何控制输出图像矩阵的行列数</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 默认6列</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">hwy</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 修改列数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">hwy</span>,<span class="cm-variable">ncol</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 修改行数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">hwy</span>,<span class="cm-variable">nrow</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th><span>修改列数</span></th><th><span>修改行数</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 011.png" referrerpolicy="no-referrer" alt="第2章 011"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 012.png" referrerpolicy="no-referrer" alt="第2章 012"></td></tr></tbody></table></figure><ul><li><p><span>facet_wrap()的 scales 是做什么用的?你什么时候会使用到它。</span></p><p><span>该参数的取值由</span><code>fixed</code><span>（默认）、</span><code>free</code><span>、</span><code>free_x</code><span>、</span><code>free_y</code><span>，默认情况下每一个子图的大小一样，比例固定，而如果修改为free，则会根据子图内点的多少修改大小。</span></p></li></ul></li></ul><h3 id='几何对象'><span>几何对象</span></h3><ul><li><span>即类似于前面遇到的</span><code>geom_point()</code></li></ul><figure><table><thead><tr><th><span>函数</span></th><th><span>作用</span></th></tr></thead><tbody><tr><td><span>geom_smooth()</span></td><td><span>拟合一条平滑曲线，并将曲线和标准误展示在图中</span></td></tr><tr><td><span>geom_boxplot()</span></td><td><span>绘制箱线图，用以概括一系列点的分布情况</span></td></tr><tr><td><span>geom_histogram()</span><br><span>geom_freqpoly()</span></td><td><span>展示连续型变量的分布</span></td></tr><tr><td><span>geom_bar()</span></td><td><span>绘制分类变量的分布情况</span></td></tr><tr><td><span>geom_path()</span><br><span>geom_line()</span></td><td><span>在数据点之间绘制连线。折线图只能创建从左到右的连线，路径图则可以是任意方向:折线图常用于描绘数据随时间变化的趋势</span></td></tr></tbody></table></figure><h4 id='geomsmooth'><span>geom_smooth()</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 添加平滑曲线</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 013.png" alt="第2章 013" style="zoom:50%;" /></p><ul><li><span>图中灰色部分表示置信区间，如果想要取消置信区间，可设置参数</span><code>se = FALSE</code><span>。</span></li><li><span>曲线的平滑程度由参数 span 控制，其取值范围是从0(很不平滑)到1(很平滑)。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 取消置信区间</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">se</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 平滑度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">span</span> <span class="cm-operator">=</span> <span class="cm-number">0.2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">span</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><figure><table><thead><tr><th><span>参数设置</span></th><th><span>结果图片</span></th></tr></thead><tbody><tr><td><span>se=FALSE</span></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 014.png" alt="第2章 014" style="zoom:50%;" /></td></tr><tr><td><span>span=0.2</span></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 015.png" alt="第2章 015" style="zoom:50%;" /></td></tr><tr><td><span>span=1</span></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 016.png" alt="第2章 016" style="zoom:50%;" /></td></tr></tbody></table></figure><ul><li><p><span>method 是</span><code>geom_smooth()</code><span>的重要参数之一，它提供了平滑曲线的多种拟合方式，</span><code>method =&quot;loess&quot;</code><span>，是n较小时的默认选项，使用局部回归拟合。Loess 对于大数据并不十分适用(内存的消耗是 O(n</span><sup><span>2</span></sup><span>))，因此当n超过1000时将默认采用另一种平滑算法。</span></p></li><li><p><code>method =&quot;gam&quot;</code><span>可以调用</span><code>mgcv</code><span>包来拟合一个广义可加模型。不过你需要先加载</span><code>mgcv</code><span>包,然后调用公式</span><code>formula = y~s(x)</code><span>或</span><code>y~s(x，bs=&quot;cs&quot;)</code><span>(用于大量数据)，这是数据量超过 1000 时 ggplot2 的默认选项。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">mgcv</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_smooth</span>(<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"gam"</span>,<span class="cm-variable">formula</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span> <span class="cm-operator">~</span> <span class="cm-variable">s</span>(<span class="cm-variable">x</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 017.png" alt="第2章 017" style="zoom: 67%;" /></p></li><li><p><code>method =&quot;lm&quot;</code><span>拟合线性模型，默认进行线性拟合。</span></p><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 018.png" alt="第2章 018" style="zoom:67%;" /></p></li><li><p><code>method =&quot;rlm&quot;</code><span>与 </span><code>lm()</code><span>类似，但它合算法更健，因此结果对异常值不太敏感。这一方法是 R包MASS 的一部分，因此使用时需要先加载 R包MASS。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">MASS</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_smooth</span>(<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"rlm"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 019.png" alt="第2章 019" style="zoom:67%;" /></p></li></ul><h4 id='箱线图和扰动点图'><span>箱线图和扰动点图</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 020.png" alt="第2章 020" style="zoom:50%;" /></p><ul><li><p><span>由于车辆类别和耗油量取值均较少，图形重叠问题比较严重。大量数据点的堆积致使数据分布不太明显，下面介绍三种工具来解决这个问题：</span></p><ul><li><strong><span>扰动点图</span></strong><span>：</span><code>geom_jitter()</code><span>，在数据中加入一些随机噪声避免图形重叠。箱线图只用5个数字对分布进行概括，这太简略了。</span></li><li><strong><span>箱线图</span></strong><span>：</span><code>geom_boxplot()</code><span>，用若于统计量概括数据分布情况。扰动点图虽将所有的点都绘制入图中却只适用于相对小的数据集。</span></li><li><strong><span>小提琴图</span></strong><span>：</span><code>geom_violin()</code><span>，简要展示分布“密度”，突出数据分布密集的区域。小提琴图展示信息最丰富，却依赖于分布密度的计算，而这有时会很难解释。</span></li></ul></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_jitter</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_boxplot</span>(<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-string">"red"</span>,<span class="cm-variable">fill</span><span class="cm-operator">=</span><span class="cm-string">"skyblue"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_violin</span>(<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-string">"blue"</span>,<span class="cm-variable">fill</span><span class="cm-operator">=</span><span class="cm-string">"green"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><figure><table><thead><tr><th><span>扰动点图</span></th><th><span>箱线图</span></th><th><span>小提琴图</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 021.png" referrerpolicy="no-referrer" alt="第2章 021"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 022.png" referrerpolicy="no-referrer" alt="第2章 022"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 023.png" referrerpolicy="no-referrer" alt="第2章 023"></td></tr></tbody></table></figure><h4 id='直方图和频数多边图'><span>直方图和频数多边图</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-string">"blue"</span>,<span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-number">1.2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_freqpoly</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"skyblue"</span>,<span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><figure><table><thead><tr><th><span>直方图</span></th><th><span>频数多边图</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 024.png" referrerpolicy="no-referrer" alt="第2章 024"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 025.png" referrerpolicy="no-referrer" alt="第2章 025"></td></tr></tbody></table></figure><ul><li><span>直方图和频数多边图工作原理相同：先将数据汇总，再计算在每一个水平下观测的数量。唯一的区别在于展现方式：直方图使用条形，而频数多边图使用线形。适用于</span><strong><span>连续变化的数据</span></strong><span>。</span></li><li><span>参数</span><code>binwidth</code><span>用以调整组距(如果不需要均匀组距可以修改</span><code>breaks</code><span>参数)。试验调整组距非常重要，你的数据会被默认分为 </span><strong><span>30 组</span></strong><span> (bins，但这不一定合适。所以你需要多次测试组距，而且你可能会发现需要使用不同的组距来完整展现数据。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_freqpoly</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"skyblue"</span>,<span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-number">2</span>,<span class="cm-variable">binwidth</span> <span class="cm-operator">=</span> <span class="cm-number">2.5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_freqpoly</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"skyblue"</span>,<span class="cm-variable">size</span><span class="cm-operator">=</span><span class="cm-number">2</span>,<span class="cm-variable">binwidth</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><figure><table><thead><tr><th><span>binwidth = 2.5</span></th><th><span>binwidth = 0.5</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 026.png" referrerpolicy="no-referrer" alt="第2章 026"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 027.png" referrerpolicy="no-referrer" alt="第2章 027"></td></tr><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 028.png" referrerpolicy="no-referrer" alt="第2章 028"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 029.png" referrerpolicy="no-referrer" alt="第2章 029"></td></tr></tbody></table></figure><ul><li><code>geom_density()</code><span>绘制的密度曲线图与频数多边图相似。但我不倾向使用密度曲线图，因为理解解释密度曲线的含义比较困难，而且密度曲线有一些隐含的假设，例如曲线应该是无界、连续且平滑的，但这些假设不一定适用于真实数据。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_density</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 030.png" alt="第2章 030" style="zoom:67%;" /></p><ul><li><span>不同的子集选用不同的颜色（col）或填充色（fill），也可以使用分面工具，虽然这不利于比较各子集间的关系，但每个子集的分布会更为清晰。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">drv</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_freqpoly</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">fill</span><span class="cm-operator">=</span><span class="cm-variable">drv</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>(<span class="cm-variable">binwidth</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">drv</span>,<span class="cm-variable">ncol</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 031.png" referrerpolicy="no-referrer" alt="第2章 031"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 032.png" referrerpolicy="no-referrer" alt="第2章 032"></td></tr></tbody></table></figure><h4 id='条形图'><span>条形图</span></h4><ul><li><span>离散变量情形下，条形图与直方图相类似，通过</span><code>geom_bar()</code><span>绘制。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">manufacturer</span>,<span class="cm-variable">fill</span><span class="cm-operator">=</span><span class="cm-variable">manufacturer</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_bar</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 033.png" alt="第2章 033" style="zoom:67%;" /></p><ul><li><span>另一种条形图已经过预处理，如下图，已知三种药品和它们的平均疗效，处理这类数据，需要修改 </span><code>geom_bar()</code><span>中的默认设置，不必进行分类计数不过，此时使用</span><code>geom_point()</code><span>更合适，因为它占用更少内存，而且不要求y轴包括0。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">drugs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">drug</span> <span class="cm-arg-is">=</span> <span class="cm-variable">letters</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">effect</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">4.2</span>,<span class="cm-number">9.7</span>,<span class="cm-number">6.1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">drugs</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drug</span>,<span class="cm-variable">effect</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_bar</span>(<span class="cm-variable">stat</span> <span class="cm-operator">=</span> <span class="cm-string">"identity"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">drugs</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drug</span>,<span class="cm-variable">effect</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 034.png" referrerpolicy="no-referrer" alt="第2章 034"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 035.png" referrerpolicy="no-referrer" alt="第2章 035"></td></tr></tbody></table></figure><ul><li><span>如果你想直接使用条形图的高度来表示数据中的值，可以使用 </span><code>geom_col()</code><span>，</span><code>geom_bar()</code><span>默认使用的统计变换方法是</span><code>count</code><span>，而</span><code>geom_col()</code><span>使用</span><code>identity</code><span>不做变换。</span></li></ul><h3 id='时间序列中的折线图和路径图'><span>时间序列中的折线图和路径图</span></h3><ul><li><strong><span>折线图</span></strong><span>和</span><strong><span>路径图</span></strong><span>常用于可视化时间序列数据。</span></li><li><span>折线图将点从左到右进行连接，路径图则按照点在数据集中的顺序对其进行连接(折线图等价于将数据按照x取值进行排序，然后绘制路径图)。</span></li><li><span>折线图的x轴一般是时间，它展示了</span><strong><span>单个变量</span></strong><span>随时间变化的情况。路径图则展示了</span><strong><span>两个变量</span></strong><span>随时间联动的情况，时间反映在点的顺序上。</span></li><li><span>此处使用</span><code>economics</code><span>数据集，它包含美国过去 40 年的经济数据。unemploy：失业人数，pop：总人口，uempmed：失业星期数的中位数。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span><span class="cm-operator">/</span><span class="cm-variable">pop</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">uempmed</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 036.png" referrerpolicy="no-referrer" alt="第2章 036"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 037.png" referrerpolicy="no-referrer" alt="第2章 037"></td></tr></tbody></table></figure><ul><li><span>为了考察这种关系的更多细节，我们可以将两个时间序列绘制在同一张图中。尽管我们可以用一张散点图来表示失业率和失业时间长度之间的关系，但我们并不能从中看出变量随时间的变化。对此，解决的办法是将临近时点的散点连接起来，形成一张</span><strong><span>路径图</span></strong><span>。</span></li><li><span>在下面画出了失业率和失业时间长度随时间变化的路径。由于线条有很多交叉，因此在第一张图中时间变化的方向并不明显。第二张图中，我们将年份映射到了颜色属性上，这让我们能更容易地看出时间的行进方向。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">unemploy</span><span class="cm-operator">/</span><span class="cm-variable">pop</span>,<span class="cm-variable">uempmed</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_path</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">year</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-keyword">function</span>(<span class="cm-variable">date</span>){<span class="cm-variable">as.POSIXlt</span>(<span class="cm-variable">date</span>)<span class="cm-operator cm-dollar">$</span><span class="cm-variable">year</span> <span class="cm-operator">+</span> <span class="cm-number">1900</span>}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">unemploy</span><span class="cm-operator">/</span><span class="cm-variable">pop</span>,<span class="cm-variable">uempmed</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_path</span>(<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-string">"grey50"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">year</span>(<span class="cm-variable">date</span>)))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 038.png" referrerpolicy="no-referrer" alt="第2章 038"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 039.png" referrerpolicy="no-referrer" alt="第2章 039"></td></tr></tbody></table></figure><ul><li><p><span>练习题：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">class</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">reorder</span>(<span class="cm-variable">class</span>,<span class="cm-variable">hwy</span>),<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 040.png" referrerpolicy="no-referrer" alt="第2章 040"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 041.png" referrerpolicy="no-referrer" alt="第2章 041"></td></tr></tbody></table></figure><ul><li><code>recorder()</code><span>的作用是class按hwy均值的大小升序排列。</span></li></ul></li><li><p><span>阅读 geom_bar()的在线文档，weight 图形属性有什么作用：统计分组内，weight指定的权重之和。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>, <span class="cm-variable">aes</span>(<span class="cm-variable">class</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">weight</span> <span class="cm-operator">=</span> <span class="cm-variable">displ</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>, <span class="cm-variable">aes</span>(<span class="cm-variable">class</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 042.png" referrerpolicy="no-referrer" alt="第2章 042"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 043.png" referrerpolicy="no-referrer" alt="第2章 043"></td></tr></tbody></table></figure></li></ul><h3 id='修饰坐标轴'><span>修饰坐标轴</span></h3><ul><li><span>使用</span><code>xlab()</code><span>和</span><code>ylab()</code><span>修改两个坐标轴的标签</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cty</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-number">3</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cty</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-number">3</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">xlab</span>(<span class="cm-string">"city driving(mpg)"</span>) <span class="cm-operator">+</span> <span class="cm-variable">ylab</span>(<span class="cm-string">"highway driving(mpg)"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 忽略坐标轴标签</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cty</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-number">3</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">xlab</span>(<span class="cm-atom">NULL</span>) <span class="cm-operator">+</span> <span class="cm-variable">ylab</span>(<span class="cm-atom">NULL</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th style='text-align:left;' ><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 044.png" referrerpolicy="no-referrer" alt="第2章 044"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 045.png" referrerpolicy="no-referrer" alt="第2章 045"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 046.png" referrerpolicy="no-referrer" alt="第2章 046"></td></tr></tbody></table></figure><ul><li><span>使用</span><code>xlim()</code><span>和</span><code>ylim()</code><span>调整坐标轴显示的范围。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># width = 0.25：设置离散点显示的宽度为左右各0.25倍宽度</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_jitter</span>(<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">0.25</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_jitter</span>(<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">0.25</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">xlim</span>(<span class="cm-variable">c</span>(<span class="cm-string">"f"</span>,<span class="cm-string">"r"</span>)) <span class="cm-operator">+</span> <span class="cm-variable">ylim</span>(<span class="cm-number">20</span>,<span class="cm-number">30</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 对于连续型标度，NA 可以设置单侧区间界限</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_jitter</span>(<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">0.25</span>,<span class="cm-variable">na.rm</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ylim</span>(<span class="cm-atom">NA</span>,<span class="cm-number">30</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 047.png" referrerpolicy="no-referrer" alt="第2章 047"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 048.png" referrerpolicy="no-referrer" alt="第2章 048"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 049.png" referrerpolicy="no-referrer" alt="第2章 049"></td></tr></tbody></table></figure><h3 id='输出'><span>输出</span></h3><ul><li><span>将绘图的结果赋值给一个变量，然后通过</span><code>print()</code><span>函数进行输出</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># col映射为连续值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">cyl</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># col映射为离散值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">factor</span>(<span class="cm-variable">cyl</span>))) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span>(<span class="cm-variable">p1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span>(<span class="cm-variable">p2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 050.png" referrerpolicy="no-referrer" alt="第2章 050"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 051.png" referrerpolicy="no-referrer" alt="第2章 051"></td></tr></tbody></table></figure><ul><li><span>通过</span><code>ggsave()</code><span>函数，将文件保存到本地硬盘。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">factor</span>(<span class="cm-variable">cyl</span>))) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggsave</span>(<span class="cm-string">"d://p2.png"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggsave</span>(<span class="cm-string">"d://p2.pdf"</span>,<span class="cm-variable">width</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>,<span class="cm-variable">height</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></pre><ul><li><span>使用</span><code>summary()</code><span>查看详细的信息。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">summary</span>(<span class="cm-variable">p2</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span><span class="cm-operator">:</span> <span class="cm-variable">manufacturer</span>, <span class="cm-variable">model</span>, <span class="cm-variable">displ</span>, <span class="cm-variable">year</span>, <span class="cm-variable">cyl</span>, <span class="cm-variable">trans</span>, <span class="cm-variable">drv</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cty</span>, <span class="cm-variable">hwy</span>, <span class="cm-variable">fl</span>, <span class="cm-variable">class</span> [<span class="cm-number">234</span><span class="cm-variable">x11</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mapping</span><span class="cm-operator">:</span> &nbsp;<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-operator">~</span><span class="cm-variable">displ</span>, <span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-operator">~</span><span class="cm-variable">hwy</span>, <span class="cm-variable">colour</span> <span class="cm-operator">=</span> <span class="cm-operator">~</span><span class="cm-variable">factor</span>(<span class="cm-variable">cyl</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">faceting</span><span class="cm-operator">:</span> <span class="cm-operator">&lt;</span><span class="cm-variable">ggproto</span> <span class="cm-variable">object</span><span class="cm-operator">:</span> <span class="cm-variable">Class</span> <span class="cm-variable">FacetNull</span>, <span class="cm-variable">Facet</span>, <span class="cm-variable">gg</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">compute_layout</span><span class="cm-operator">:</span> <span class="cm-keyword">function</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">draw_back</span><span class="cm-operator">:</span> <span class="cm-keyword">function</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">...........</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">vars</span><span class="cm-operator">:</span> <span class="cm-keyword">function</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">super</span><span class="cm-operator">:</span> &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">ggproto</span> <span class="cm-variable">object</span><span class="cm-operator">:</span> <span class="cm-variable">Class</span> <span class="cm-variable">FacetNull</span>, <span class="cm-variable">Facet</span>, <span class="cm-variable">gg</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">-----------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">geom_point</span><span class="cm-operator">:</span> <span class="cm-variable">na.rm</span> <span class="cm-operator">=</span> <span class="cm-variable">FALSE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stat_identity</span><span class="cm-operator">:</span> <span class="cm-variable">na.rm</span> <span class="cm-operator">=</span> <span class="cm-variable">FALSE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">position_identity</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 364px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><ul><li><span>通过</span><code>saveRDS()</code><span>，把图像缓存副本保存到硬盘中。它所保存的图像完整副本可以通过</span><code>readRDS()</code><span>快速恢复。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">saveRDS</span>(<span class="cm-variable">p2</span>,<span class="cm-string">"d://p2.rds"</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p3</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">readRDS</span>(<span class="cm-string">"d://p2.rds"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p3</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></pre><h3 id='快速绘图qplot'><span>快速绘图qplot()</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">qplot</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">mpg</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">qplot</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">mpg</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 052.png" referrerpolicy="no-referrer" alt="第2章 052"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 053.png" referrerpolicy="no-referrer" alt="第2章 053"></td></tr></tbody></table></figure><ul><li><p><span>没有声明的情况下，</span><code>qplot()</code><span>会根据已有数据自动选择适当的呈现方式。举例来说，如果只定义</span><code>qplot()</code><span>函数的 x和y变量，它会自动绘制散点图。如果只定义x变量，它会根据不同的变量类型自动生成直方图或条形图。</span></p></li><li><p><code>qplot()</code><span>对所有变量进行默认标度变换，如果你要指定某一图形属性为常量，需要使用</span><code>I()</code><span>参数：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 蓝色会进行标度变换</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">qplot</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">mpg</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"blue"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 按原来的蓝色</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">qplot</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">mpg</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">I</span>(<span class="cm-string">"blue"</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 054.png" referrerpolicy="no-referrer" alt="第2章 054"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第2章\第2章 055.png" referrerpolicy="no-referrer" alt="第2章 055"></td></tr></tbody></table></figure></li></ul><h2 id='第3章-工具箱'><span>第3章 工具箱</span></h2><h3 id='基本图形类型'><span>基本图形类型</span></h3><ul><li><span>以下几何对象是 ggplot2 的基本组成部分，每种几何对象自身既可独立构建图形，同时也可以组合起来构建更复杂的几何对象。这些几何对象基本上都关联了一种常见的图形:当图形构建只使用一种几何对象时，这幅图往往被冠有一个特定的名称。</span></li><li><code>geom_area()</code><span>：用于绘制</span><strong><span>面积图</span></strong><span>，即在普通线图的基础上，依 y 轴方向填充了下方面积的图形。对于分组数据，各组将按照依次堆积的方式绘制。</span></li><li><code>geom_bar(stat = &quot;identity&quot;)</code><span>：绘制</span><strong><span>条形图</span></strong><span>，我们需要指定 stat = &quot;identity”，因为默认的统计变换将自动对“值”进行计数(所以本质上这是一个一维的几何对象)，而统计变换可以保持数据不变。默认情况下，相同位置的多个条形图会以依次向上堆积的形式绘制。</span></li><li><code>geom_line()</code><span>：绘制</span><strong><span>折线图</span></strong><span>，图形属性 group 决定了哪些观测是连接在一起的。</span><code>geom_line()</code><span>将各点从左至右进行连接，</span><code>geom_path()</code><span>与之类似，但其中线条是根据它们在数据中出现的顺序进行连接的。这两类几何对象均接受 </span><code>linetype</code><span> 图形属性，即可将分类变量映射为</span><strong><span>实线</span></strong><span>、</span><strong><span>虚线</span></strong><span>和</span><strong><span>点线</span></strong><span>。</span></li><li><code>geom_point()</code><span>：绘制</span><strong><span>散点图</span></strong><span>，并支持 </span><code>shape</code><span> 图形属性。</span></li><li><code>geom_polygon()</code><span>：绘制</span><strong><span>多边形</span></strong><span>，即填充后的路径。各行数据代表着多边形的各个顶点，绘图前把多边形的点数据坐标和原始数据合并往往更方便。</span></li><li><code>geom_rect()</code><span>，</span><code>geom_tile()</code><span>和 </span><code>geom_raster()</code><span>绘制</span><strong><span>矩形</span></strong><span>，</span><code>geom_rect()</code><span>有xmin、ymin、xmax 和 ymax，即矩形的各顶点坐标参数定义。</span><code>geom_tile()</code><span>与之相同，但定义参数的是矩形的中心坐标和尺寸，即 x、y、width 和 height。</span><code>geom_raster()</code><span>则是当所有</span><strong><span>瓦片</span></strong><span> (tile)大小相同时 </span><code>geom_tile()</code><span>的精简版。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">3</span>,<span class="cm-number">1</span>,<span class="cm-number">5</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">2</span>,<span class="cm-number">4</span>,<span class="cm-number">6</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">label</span> <span class="cm-arg-is">=</span> <span class="cm-variable">letters</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">label</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">labs</span>(<span class="cm-variable">X</span> <span class="cm-operator">=</span> <span class="cm-atom">NULL</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-atom">NULL</span>) <span class="cm-operator">+</span> <span class="cm-comment"># 去除坐标轴标签</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme</span>(<span class="cm-variable">plot.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">20</span>)) <span class="cm-comment"># 设置标题的尺寸</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 散点图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>) <span class="cm-operator">+</span> <span class="cm-variable">ggtitle</span>(<span class="cm-string">"geom_point()"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 显示label文本</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_text</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-variable">ggtitle</span>(<span class="cm-string">"geom_text()"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用原始数据显示条形图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>(<span class="cm-variable">stat</span> <span class="cm-operator">=</span> <span class="cm-string">"identity"</span>) <span class="cm-operator">+</span> <span class="cm-variable">ggtitle</span>(<span class="cm-string">"geom_text()"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制瓦片图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_tile</span>() <span class="cm-operator">+</span> <span class="cm-variable">ggtitle</span>(<span class="cm-string">"geom_tile()"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 001.png" referrerpolicy="no-referrer" alt="第3章 001"></th><th><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 002.png" referrerpolicy="no-referrer" alt="第3章 002"></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 003.png" referrerpolicy="no-referrer" alt="第3章 003"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 004.png" referrerpolicy="no-referrer" alt="第3章 004"></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制折线图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制面积图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_area</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制路径图(按x的向后顺序)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_path</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制多边形</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_polygon</span>(<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 005.png" referrerpolicy="no-referrer" alt="第3章 005"></th><th><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 006.png" referrerpolicy="no-referrer" alt="第3章 006"></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 007.png" referrerpolicy="no-referrer" alt="第3章 007"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 008.png" referrerpolicy="no-referrer" alt="第3章 008"></td></tr></tbody></table></figure><h3 id='标签label'><span>标签label</span></h3><ul><li><span>主要通过</span><code>geom_text()</code><span>函数。</span></li><li><strong><span>family</span></strong><span>参数修改字体，目前只有三种通用字体，sans（黑体）、serif（宋体）、mono（等宽字体）</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">family</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"sans"</span>,<span class="cm-string">"serif"</span>,<span class="cm-string">"mono"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">text</span> <span class="cm-operator">=</span> <span class="cm-variable">rep</span>(<span class="cm-string">"ABC"</span>,<span class="cm-number">3</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">family</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">text</span>,<span class="cm-variable">family</span> <span class="cm-operator">=</span> <span class="cm-variable">family</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 009.png" alt="第3章 009" style="zoom:67%;" /></p><ul><li><span>目前共有五种图形设备使用比较广泛：png()、pdf()、基于Windows、Mac、Linux的屏幕设备。</span></li><li><strong><span>fontface</span></strong><span>设置字体风格：默认（plain）、粗体（bold）和斜体（italic）</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">face</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"plain"</span>,<span class="cm-string">"bold"</span>,<span class="cm-string">"italic"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">face</span>,<span class="cm-variable">fontface</span> <span class="cm-operator">=</span> <span class="cm-variable">face</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"#00FF00"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 010.png" alt="第3章 010" style="zoom:67%;" /></p><ul><li><strong><span>hjust</span></strong><span>（&quot;left&quot;,&quot;center&quot;,&quot;right&quot;,&quot;inward&quot;,&quot;outword&quot;）和</span><strong><span>vjust</span></strong><span>（&quot;bottom&quot;,&quot;middle&quot;,&quot;top&quot;,&quot;inward&quot;,&quot;outward&quot;）改变文本的对其方式，默认为center，其中inward把文字向中间对其。</span></li><li><code>hjust</code><span>和</span><code>vjust</code><span>的值仅在0和1之间限定：0表示bottom和left、1表示top和right、0.5表示middle和center</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">1</span>,<span class="cm-number">2</span>,<span class="cm-number">1</span>,<span class="cm-number">2</span>,<span class="cm-number">1.5</span>),<span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">1</span>,<span class="cm-number">1</span>,<span class="cm-number">2</span>,<span class="cm-number">2</span>,<span class="cm-number">1.5</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">text</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"bottom-left"</span>,<span class="cm-string">"bpttom-right"</span>,<span class="cm-string">"top-left"</span>,<span class="cm-string">"top-right"</span>,<span class="cm-string">"center"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">text</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">8</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">text</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-string">"inward"</span>,<span class="cm-variable">vjust</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"inward"</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">8</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 011.png" referrerpolicy="no-referrer" alt="第3章 011"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 012.png" referrerpolicy="no-referrer" alt="第3章 012"></td></tr></tbody></table></figure><ul><li><strong><span>size</span></strong><span> 调整字体大小。与大多数工具不同的是，ggplot2 字体不以常见的磅(pts为单位而是使用毫米(mm)这也是 ggplot2各元素的通用单位1 英寸(inch)等于72.27pts，所以将 pt 换算为 mm，只需乘72.27/25.4)。</span></li><li><strong><span>angle</span></strong><span>定义文本的转角度。数值即为对应的度数，如90就是逆时针旋转90°。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-string">"111"</span>,<span class="cm-variable">angle</span> <span class="cm-operator">=</span> <span class="cm-number">90</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 013.png" alt="第3章 013" style="zoom:67%;" /></p><ul><li><span>一般我们在给数据点添加标签时，并不希望文本覆盖到点(或条形)上，所以通常我们会把文本绘制于数据点稍微错开的地方。</span><strong><span>nudge_x</span></strong><span>和 </span><strong><span>nudge_y</span></strong><span> 参数设置文本在数据点附近的具体位置。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">trt</span> <span class="cm-operator">=</span> <span class="cm-variable">letters</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>],<span class="cm-variable">resp</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">1.2</span>,<span class="cm-number">3.4</span>,<span class="cm-number">2.5</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">resp</span>,<span class="cm-variable">trt</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">paste0</span>(<span class="cm-string">"("</span>,<span class="cm-variable">resp</span>,<span class="cm-string">")"</span>)),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">nudge_y</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-number">0.3</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">6</span>) <span class="cm-operator">+</span> <span class="cm-variable">xlim</span>(<span class="cm-number">1</span>,<span class="cm-number">3.6</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 014.png" alt="第3章 014" style="zoom:67%;" /></p><ul><li><span>如果 </span><code>check_overlap = TRUE</code><span>，重叠标签会自动删除。原理很简单，标签会根据数据框中的顺序依次绘制在图像中;如果某个标签会覆盖到已有数据点，它就会被自动省略。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">model</span>)) <span class="cm-operator">+</span> <span class="cm-variable">xlim</span>(<span class="cm-number">1</span>,<span class="cm-number">8</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">model</span>),<span class="cm-variable">check_overlap</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">xlim</span>(<span class="cm-number">1</span>,<span class="cm-number">8</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 015.png" referrerpolicy="no-referrer" alt="第3章 015"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 016.png" referrerpolicy="no-referrer" alt="第3章 016"></td></tr></tbody></table></figure><ul><li><code>geom_label()</code><span>是</span><code>geom_text()</code><span>的衍生版本，它会在文本外绘制矩形框，可以让标签在复杂背景中显得更为清晰。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mylabel</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">waiting</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">55</span>,<span class="cm-number">80</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">eruptions</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-number">2</span>,<span class="cm-number">4.3</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">label</span> <span class="cm-arg-is">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"peak one"</span>,<span class="cm-string">"peak two"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">faithfuld</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">waiting</span>,<span class="cm-variable">eruptions</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_tile</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">density</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_label</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">mylabel</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">label</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 234px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 017.png" referrerpolicy="no-referrer" alt="第3章 017"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 018.png" referrerpolicy="no-referrer" alt="第3章 018"></td></tr></tbody></table></figure><ul><li><span>文本标签还可以替代图例，这可以使图像更清晰明了，毕竟标签距离数据点更近。Toby Dylan Hocking 制作的 </span><code>directlabels</code><span> (</span><a href='https://github.com/tdhock/directlabels' target='_blank' class='url'>https://github.com/tdhock/directlabels</a><span>)程序包提供了若干相关工具：directlabels 程序包提供了一系列标签定位方法，如 smart.grid 适用于散点图起步，以及修饰频数多边图和折线图的其他方法。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"directlabels"</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">directlabels</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">class</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">class</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># show.legend = F：去掉点图的图例</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">show.legend</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">directlabels</span><span class="cm-operator">::</span><span class="cm-variable">geom_dl</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">class</span>),<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"smart.grid"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 019.png" referrerpolicy="no-referrer" alt="第3章 019"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 020.png" referrerpolicy="no-referrer" alt="第3章 020"></td></tr></tbody></table></figure><h3 id='注解'><span>注解</span></h3><ul><li><span>注解会在图像中添加元数据，元数据依然是数据，所以可以使用以下函数：</span></li><li><strong><span>geom_text()</span></strong><span>可添加文本说明或为点添加标签。对于多数图像，为所有观测点都添加标签有害无益，然而抽取部分观测添加标签可能会非常有用-一-我们往往需要标注出离群点或其他重要的点。</span></li><li><strong><span>geom_rect()</span></strong><span>标注图形中你感兴趣的矩形区域。geom_rect() 拥有 xmin、xmax、ymin 和ymax 参数。</span></li><li><strong><span>geom_line()</span></strong><span>、</span><strong><span>geom_path()</span></strong><span>和 </span><strong><span>geom_segment()</span></strong><span>均可添加直线。这些几何对象都支持 arrow 参数，可以用来在直线上绘制箭头。我们也可以使用 arrow函数绘制，它支持 angle、length、ends 和 type 几个参数。</span></li><li><strong><span>geom_hline()</span></strong><span>、</span><strong><span>geom.vline()</span></strong><span>和 </span><strong><span>geom_abline()</span></strong><span>在图形中添加参照线(基准线)，其跨度为整张图像。</span></li><li><span>一般来说，注解既可添加在前景(必要时使用 </span><strong><span>alpha</span></strong><span> 函数以保证能看清数据)也可以添加于背景中。添加于背景时，默认使用白色字体，这样比较容易看清，在图中也不显得突元。</span></li><li><span>绘制美国失业率的时间序列曲线：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><ul><li><span>我们可以在图中添加注解标明各个总统的当政时间。此处请注意代码中-的使用：</span><code>-Inf</code><span>和</span><code>Inf</code><span>分别代表注解的添加位置，即上和下(或左和右)。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 根据每一个政党的执政开始时间和结束时间画矩形</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_rect</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">xmin</span> <span class="cm-operator">=</span> <span class="cm-variable">start</span>,<span class="cm-variable">xmax</span> <span class="cm-operator">=</span> <span class="cm-variable">end</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">party</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># alpha的值位于0~1之间，值越小，颜色越浅</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  ,<span class="cm-variable">ymin</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-atom">Inf</span>,<span class="cm-variable">ymax</span> <span class="cm-operator">=</span> <span class="cm-atom">Inf</span>,<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.4</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">presidential</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># xintercept：在x上的截距</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 作用是标出政党每次执政的时间分界线</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_vline</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">xintercept</span> <span class="cm-operator">=</span> <span class="cm-variable">as.numeric</span>(<span class="cm-variable">start</span>)),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">presidential</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"grey50"</span>,<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">start</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">2500</span>,<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">name</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-comment"># 底端和左对其，水平右移50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">presidential</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>,<span class="cm-variable">vjust</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>,<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>,<span class="cm-variable">nudge_x</span> <span class="cm-operator">=</span> <span class="cm-number">50</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 修改背景颜色</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_fill_manual</span>(<span class="cm-variable">values</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"blue"</span>,<span class="cm-string">"red"</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 021.png" referrerpolicy="no-referrer" alt="第3章 021"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 022.png" referrerpolicy="no-referrer" alt="第3章 022"></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 获取最大值和最小值</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">yrng</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">range</span>(<span class="cm-variable">economics</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">unemploy</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">xrng</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">range</span>(<span class="cm-variable">economics</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">date</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将文本切割为每段40长度，然后用换行符连接</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">caption</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">strwrap</span>(<span class="cm-string">"Unemployment rates in the US have varied alot over the years"</span>,<span class="cm-number">40</span>),<span class="cm-variable">collapse</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\n</span><span class="cm-string">"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_text</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">caption</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">xrng</span>[<span class="cm-number">1</span>],<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">yrng</span>[<span class="cm-number">2</span>],<span class="cm-variable">caption</span> <span class="cm-operator">=</span> <span class="cm-variable">caption</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>,<span class="cm-variable">vjust</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 260px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><ul><li><span>使用</span><code>annotate()</code><span>简化：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">economics</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">date</span>,<span class="cm-variable">unemploy</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> <span class="cm-variable">annotate</span>(<span class="cm-variable">geom</span> <span class="cm-operator">=</span> <span class="cm-string">"text"</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">xrng</span>[<span class="cm-number">1</span>],<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">yrng</span>[<span class="cm-number">2</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">label</span> <span class="cm-operator">=</span> <span class="cm-variable">caption</span>,<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>,<span class="cm-variable">vjust</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 023.png" referrerpolicy="no-referrer" alt="第3章 023"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 024.png" referrerpolicy="no-referrer" alt="第3章 024"></td></tr></tbody></table></figure><ul><li><span>各类注解，尤其是参照线，在通过分面比较组间关系时格外有用。</span></li><li><code>geom_bin2d()</code><span>：将平面划分为矩形，然后计算每一个矩形内的案例数，根据案例数的多少映射到矩形中，是</span><code>geom_point()</code><span>的类似函数。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">diamonds</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">log10</span>(<span class="cm-variable">carat</span>),<span class="cm-variable">log10</span>(<span class="cm-variable">price</span>))) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_bin2d</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">cut</span>,<span class="cm-variable">nrow</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 025.png" alt="第3章 025" style="zoom:67%;" /></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 提取模型的系数，以下示例提取线性回归方程的回归参数</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mod_coef</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">coef</span>(<span class="cm-variable">lm</span>(<span class="cm-variable">log10</span>(<span class="cm-variable">price</span>) <span class="cm-operator">~</span> <span class="cm-variable">log10</span>(<span class="cm-variable">carat</span>),<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">diamonds</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">diamonds</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">log10</span>(<span class="cm-variable">carat</span>),<span class="cm-variable">log10</span>(<span class="cm-variable">price</span>))) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 利用上面的回归系数绘制直线</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_bin2d</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_abline</span>(<span class="cm-variable">intercept</span> <span class="cm-operator">=</span> <span class="cm-variable">mod_coef</span>[<span class="cm-number">1</span>],</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">slope</span> <span class="cm-operator">=</span> <span class="cm-variable">mod_coef</span>[<span class="cm-number">2</span>],<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"white"</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">cut</span>,<span class="cm-variable">nrow</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 026.png" alt="第3章 026" style="zoom:67%;" /></p><h3 id='群体几何对象'><span>群体几何对象</span></h3><ul><li><p><span>几何对象可以大体分为</span><strong><span>个体</span></strong><span>(individual)和</span><strong><span>总体</span></strong><span>(collective)两类。</span><strong><span>个体几何对象</span></strong><span>对数据框的每一条(行)数据绘制一个可以区别于其他个体的图形对象如散点图中每个点均代表一个观测。而</span><strong><span>群组几何对象</span></strong><span>则用来表示多个观测。它们可以是统计摘要的一个结果，如箱线图，或是几何对象的基础展示，如多边图折线图和路径图则同时具备上述两种特点：其线路由一系列线段组成，而每条线段又都对应着两个点。我们该如何控制哪些观测值用哪种图形元素呢?这就是图形属性</span><strong><span>group</span></strong><span>的任务了。</span></p></li><li><p><span>图中所有离散型变量的交互作用被设为分组的默认值，通常这样可以正确地给数据分组，但是如果</span><strong><span>没能正确分组或者图中没有离散型变量</span></strong><span>，就需要自定义分组结构，即将</span><strong><span>group</span></strong><span>映射到一个在不同的组有不同取值的变量。</span></p></li><li><p><span>一般有以下</span><strong><span>三种情况不能正确分组</span></strong><span>：</span></p><p><span>使用</span><code>nlme</code><span>包下的数据</span><code>Oxboys</code><span>，它记录了26个男孩(</span><strong><span>Subjec</span></strong><span>t)在9个不同时期(</span><strong><span>Occasion</span></strong><span>)所测定的身高(</span><strong><span>height</span></strong><span>)和中心化后的年龄(</span><strong><span>age</span></strong><span>)，其中Subiect 和Occasion 以有序因子形式存储。一个Subject是一个人。</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">nlme</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">Oxboys</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Grouped</span> <span class="cm-variable">Data</span><span class="cm-operator">:</span> <span class="cm-variable">height</span> <span class="cm-operator">~</span> <span class="cm-variable">age</span> <span class="cm-operator">|</span> <span class="cm-variable">Subject</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">Subject</span> &nbsp; &nbsp; <span class="cm-variable">age</span> <span class="cm-variable">height</span> <span class="cm-variable">Occasion</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> <span class="cm-operator">-</span><span class="cm-number">1.0000</span> &nbsp;<span class="cm-number">140.5</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> <span class="cm-operator">-</span><span class="cm-number">0.7479</span> &nbsp;<span class="cm-number">143.4</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">......</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><ul><li><span>很多时候，我们都想将数据分成若干组，并用相同的方式对每个组进行渲染。当从总体上查看数据时，我们通常希望区分每个个体而不是识别他们。这在含有多个个体的纵向数据中是很常见的，而这类图形也被形象地称为“</span><strong><span>细面图</span></strong><span>”(spaghetti plot)。如下图展示了每个男孩(每个对象)的成长轨迹：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">age</span>,<span class="cm-variable">height</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">Subject</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 027.png" alt="第3章 027" style="zoom:67%;" /></p><ul><li><span>如果分组变量设置有误，就会得到一张毫无用处的锯齿状图像：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">age</span>,<span class="cm-variable">height</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 028.png" alt="第3章 028" style="zoom:67%;" /></p><ul><li><span>如果分组由多个变量定义而非单一变量，使用 </span><strong><span>interaction</span></strong><span> 合并各个分组变量，例如，</span><code>aes(group = interaction(school_id，student_id))</code><span>。</span></li><li><span>我们在</span><code>ggplot()</code><span>中设置分组（group），它会将统计变换应用于所有图层：在 </span><code>geom_line()</code><span>中设置分组则可解决这一问题。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 在ggplot() 设置分组</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">age</span>,<span class="cm-variable">height</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">Subject</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"lm"</span>,<span class="cm-variable">se</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 不在ggplot() 设置分组（我们想要的）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">age</span>,<span class="cm-variable">height</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">Subject</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_smooth</span>(<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"lm"</span>,<span class="cm-variable">se</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 029.png" referrerpolicy="no-referrer" alt="第3章 029"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 030.png" referrerpolicy="no-referrer" alt="第3章 030"></td></tr></tbody></table></figure><ul><li><span>如果图像中含有 x 轴上的离散型变量，而你却想绘制连接 所有分组的线条那么你可以采取绘制交互作用图、轮廓图以及平行坐标图时所用的策略。这里以绘制各个测量时期(Occasion)身高(height)的箱线图为例：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">Occasion</span>,<span class="cm-variable">height</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 031.png" alt="第3章 031" style="zoom:67%;" /></p><ul><li><span>图中只有一个离散型变量 occasion，所以我们对每一个不同的 x 取值均作出一幅箱线图。现在我们需要绘制每个男孩的身高变化曲线，简单添加 </span><code>geom_line()</code><span>没有什么效果，因为绘制的曲线会局限于每个测量节点内，而不是连接各个对象：</span><strong><span>即分组只能在同一个occasion内连接，而不能去连接同一个人（subject）</span></strong></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 默认在每一个x轴变量内连接</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">Occasion</span>,<span class="cm-variable">height</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_boxplot</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"#3366FF"</span>,<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将默认的分组改为Subject，即画出每个人的成长轨迹</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">Oxboys</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">Occasion</span>,<span class="cm-variable">height</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_boxplot</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">Subject</span>),<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"skyblue"</span>,<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 032.png" referrerpolicy="no-referrer" alt="第3章 032"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 033.png" referrerpolicy="no-referrer" alt="第3章 033"></td></tr></tbody></table></figure><ul><li><span>折线图和路径图遵循</span><strong><span>差一原则</span></strong><span>：若观测点比线段数目多一，第一条线段将使用第一个观测值的图形属性，第二条线段将使用第二个观测值的图形属性，依次类推。这也意味着，最后一个观测值的图形属性不会被用到：（</span><strong><span>aes(group = 1)：确保ggplot()知道数据属于同一分组</span></strong><span>）</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">1</span>,<span class="cm-number">3</span>,<span class="cm-number">5</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用factor可以将颜色离散化</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">factor</span>(<span class="cm-variable">col</span>))) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">5</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">col</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 034.png" referrerpolicy="no-referrer" alt="第3章 034"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 035.png" referrerpolicy="no-referrer" alt="第3章 035"></td></tr></tbody></table></figure><ul><li><span>线段平稳地从一种图形属性变换到另一种图形属性。这种方式对连续型变量很有效，如大小和颜色，但并不适用于渐变的线条类型，而且尚未应用于 ggplot2 。如果你需要实现这种效果，可以通过</span><strong><span>线性插值法</span></strong><span>实现：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">xgrid</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">with</span>(<span class="cm-variable">df</span>,<span class="cm-variable">seq</span>(<span class="cm-variable">min</span>(<span class="cm-variable">x</span>),<span class="cm-variable">max</span>(<span class="cm-variable">x</span>),<span class="cm-variable">length</span> <span class="cm-operator">=</span> <span class="cm-number">50</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">interp</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">xgrid</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">approx</span>(<span class="cm-variable">df</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">x</span>,<span class="cm-variable">df</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">y</span>,<span class="cm-variable">xout</span> <span class="cm-operator">=</span> <span class="cm-variable">xgrid</span>)<span class="cm-operator cm-dollar">$</span><span class="cm-variable">y</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">approx</span>(<span class="cm-variable">df</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">x</span>,<span class="cm-variable">df</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">y</span>,<span class="cm-variable">xout</span> <span class="cm-operator">=</span> <span class="cm-variable">xgrid</span>)<span class="cm-operator cm-dollar">$</span><span class="cm-variable">y</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">interp</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">col</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_line</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">df</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">5</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 036.png" alt="第3章 036" style="zoom:67%;" /></p><ul><li><span>对其他群组几何对象如对多边图而言，只有当所有个体的图形属性都相同时，该图形属性才会被使用，否则将使用默认值。这适用于 fill 参数，因为它是整体对象的一个性质：考虑给多边形边界上的点填充不同颜色没有任何意义。</span></li><li><span>当映射对象是离散型变量时，它将默认地把群组几何对象分解成更小的块这对条形图和面积图的绘制非常有效，因为将每小块堆积起来就可得到和原来未分组前一样形状的图形，如下图所示。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">class</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">class</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">drv</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 037.png" referrerpolicy="no-referrer" alt="第3章 037"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 038.png" referrerpolicy="no-referrer" alt="第3章 038"></td></tr></tbody></table></figure><ul><li><span>如果你想用同样的方法把填充属性映射到连续型变量上，这将没有效果。默认分组只是基于 class，因此每一条块会获得多重颜色。因为一个条块只能够显示一种颜色，它会使用默认的灰色。为了展示多重颜色，需要对每一 class 设定多重条块，我们可以设定分组来实现此效果：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">class</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">class</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 039.png" referrerpolicy="no-referrer" alt="第3章 039"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 040.png" referrerpolicy="no-referrer" alt="第3章 040"></td></tr></tbody></table></figure><ul><li><p><span>练习题：</span></p><ul><li><span>在不将cy1设置为因子的前提下，为 cyl 的每个取值绘制 hwy 的箱线图。你还需要额外设置什么图形属性?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 直接画箱线图(图1)</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cyl</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 设为因子(图2)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">cyl</span>),<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 答案一(图3)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cyl</span>,<span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">cyl</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 或(图4)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">cyl</span>,<span class="cm-variable">hwy</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">cyl</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 041.png" referrerpolicy="no-referrer" alt="第3章 041"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 042.png" referrerpolicy="no-referrer" alt="第3章 042"></td></tr><tr><td><strong><span>图3</span></strong></td><td><strong><span>图4</span></strong></td></tr><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 043.png" referrerpolicy="no-referrer" alt="第3章 043"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 044.png" referrerpolicy="no-referrer" alt="第3章 044"></td></tr></tbody></table></figure><ul><li><span>调整下图，绘制displ里每个整数取值的箱线图：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">subset</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">as.integer</span>(<span class="cm-variable">displ</span>) <span class="cm-operator">==</span> <span class="cm-variable">displ</span>),</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">aes</span>(<span class="cm-variable">displ</span>,<span class="cm-variable">cty</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">displ</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 045.png" alt="第3章 045" style="zoom:67%;" /></p><ul><li><span>将连续型和离散型颜色变量映射到线条上时，离散型变量对应的代码中需要设置 aes(group=1)，为什么?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">10</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">10</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">col</span> <span class="cm-arg-is">=</span> <span class="cm-variable">seq</span>(<span class="cm-number">1</span>,<span class="cm-number">100</span>,<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 使用factor(x)将x离散化</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">x</span>),<span class="cm-variable">y</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">factor</span>(<span class="cm-variable">col</span>)),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># group = 1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">x</span>),<span class="cm-variable">y</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">factor</span>(<span class="cm-variable">col</span>)),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># group = 2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">x</span>),<span class="cm-variable">y</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-number">2</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_line</span>() <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">factor</span>(<span class="cm-variable">col</span>)),<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 364px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 046.png" referrerpolicy="no-referrer" alt="第3章 046"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 047.png" referrerpolicy="no-referrer" alt="第3章 047"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 048.png" referrerpolicy="no-referrer" alt="第3章 048"></td></tr></tbody></table></figure><ul><li><span>下列图像中分别共有多少个条形?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">dplyr</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># mpg按hwy排序后，再加入名为id的递增序列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mpg2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">mpg</span> <span class="cm-operator cm-variable-2">%&gt;%</span> <span class="cm-variable">arrange</span>(<span class="cm-variable">hwy</span>) <span class="cm-operator cm-variable-2">%&gt;%</span> <span class="cm-variable">mutate</span>(<span class="cm-variable">id</span> <span class="cm-operator">=</span> <span class="cm-variable">seq_along</span>(<span class="cm-variable">hwy</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mpg2</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">drv</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">hwy</span>,<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">id</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_bar</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 049.png" referrerpolicy="no-referrer" alt="第3章 049"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 050.png" referrerpolicy="no-referrer" alt="第3章 050"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 051.png" referrerpolicy="no-referrer" alt="第3章 051"></td></tr></tbody></table></figure><ul><li><span>安装并加载babynames程序包，它包含了美国境内婴儿姓名的普遍程度数据运行以下代码并对图像作出调整，你认为所得图像存在什么问题?</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"babynames"</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">babynames</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">hadley</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">dplyr</span><span class="cm-operator">::</span><span class="cm-variable">filter</span>(<span class="cm-variable">babynames</span>,<span class="cm-variable">name</span> <span class="cm-operator">==</span> <span class="cm-string">"Hadley"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">hadley</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">year</span>,<span class="cm-variable">n</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_point</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 052.png" alt="第3章 052" style="zoom:67%;" /></p></li></ul><h3 id='曲面图'><span>曲面图</span></h3><ul><li><span>ggplot2 暂不支持真正的三维曲面图，但内置了在二维平面上展现三维曲面的常见工具:等高线图、着色瓦片 (coloured tiles)以及气泡图。这些图形工作原理相近，只是第三维变量映射的图形属性有所不同。</span></li><li><code>geom_contour()</code><span>：绘制等高线图。</span></li><li><code>geom_raster()</code><span>则是当所有</span><strong><span>瓦片</span></strong><span> (tile)大小相同时 </span><code>geom_tile()</code><span>的精简版。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">faithfuld</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">eruptions</span>,<span class="cm-variable">waiting</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_contour</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">z</span> <span class="cm-operator">=</span> <span class="cm-variable">density</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">..level..</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">faithfuld</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">eruptions</span>,<span class="cm-variable">waiting</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_raster</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">density</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#气泡图适用于观测点较少的情况</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">small</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">faithfuld</span>[<span class="cm-variable">seq</span>(<span class="cm-number">1</span>,<span class="cm-variable">nrow</span>(<span class="cm-variable">faithfuld</span>),<span class="cm-variable">by</span> <span class="cm-operator">=</span> <span class="cm-number">10</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">small</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">eruptions</span>,<span class="cm-variable">waiting</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">density</span>),<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">/</span><span class="cm-number">3</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 缩放点的面积</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_size_area</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 053.png" referrerpolicy="no-referrer" alt="第3章 053"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 054.png" referrerpolicy="no-referrer" alt="第3章 054"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 055.png" referrerpolicy="no-referrer" alt="第3章 055"></td></tr></tbody></table></figure><h3 id='绘制地图'><span>绘制地图</span></h3><ul><li><span>我们共有四类需要可视化的地图数据：矢量边界、点状元数据、区域元数据和光栅图。</span></li></ul><h4 id='矢量边界'><span>矢量边界</span></h4><ul><li><p><strong><span>矢量边界</span></strong><span>包含以下四类变量：</span></p><ul><li><span>lat (latitude，纬度)和 long(longitude，经度)：表示边界点的坐标。</span></li><li><span>group：每个毗邻区域的独特标记。</span></li><li><span>id：记录一个地区的名称。</span></li></ul></li><li><p><code>ggplot2::map_data()</code><span>：提取已有数据包的数据。</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 提取地图包的数据，并挑出部分列</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mi_counties</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot2</span><span class="cm-operator">::</span><span class="cm-variable">map_data</span>(<span class="cm-string">"county"</span>,<span class="cm-string">"michigan"</span>) <span class="cm-operator cm-variable-2">%&gt;%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">select</span>(<span class="cm-variable">lon</span> <span class="cm-operator">=</span> <span class="cm-variable">long</span>,<span class="cm-variable">lat</span>,<span class="cm-variable">group</span>,<span class="cm-variable">id</span> <span class="cm-operator">=</span> <span class="cm-variable">subregion</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mi_counties</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">lon</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">lat</span> <span class="cm-variable">group</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">id</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">83.88675</span> <span class="cm-number">44.85686</span> &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp;<span class="cm-variable">alcona</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-operator">-</span><span class="cm-number">83.36536</span> <span class="cm-number">44.86832</span> &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp;<span class="cm-variable">alcona</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">.......</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ul><li><span>使用</span><code>geom_ploygon()</code><span>可视化边界数据。</span><code>coord_quickmap()</code><span>可以对地图比例尺是否合适作出简易的判断。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mi_counties</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">lon</span>,<span class="cm-variable">lat</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_polygon</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># coord_quickmap()是一种快速近似，可以保留直线。</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">coord_quickmap</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mi_counties</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">lon</span>,<span class="cm-variable">lat</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_polygon</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>),<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-atom">NA</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">coord_quickmap</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 056.png" referrerpolicy="no-referrer" alt="第3章 056"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 057.png" referrerpolicy="no-referrer" alt="第3章 057"></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-variable">c</span>(<span class="cm-string">"sf"</span>,<span class="cm-string">"devtools"</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">devtools</span><span class="cm-operator">::</span><span class="cm-variable">install_github</span>(<span class="cm-string">"tidyverse/ggplot2"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">devtools</span><span class="cm-operator">::</span><span class="cm-variable">install_github</span>(<span class="cm-string">"ropensci/USAboundaries"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">devtools</span><span class="cm-operator">::</span><span class="cm-variable">install_github</span>(<span class="cm-string">"ropensci/USAboundariesData"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">c18df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">USAboundaries</span><span class="cm-operator">::</span><span class="cm-variable">us_states</span>(<span class="cm-variable">as.Date</span>(<span class="cm-string">"1820-01-01"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_sf</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">c18df</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"grey50"</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-atom">NA</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><h4 id='点状元数据'><span>点状元数据</span></h4><ul><li><strong><span>点状元数据</span></strong><span>使用其他变量连接各个位点(由经纬度定义)，比如下述代码提取密歇根州中最大的城市数据 (2006 年数据)</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">maps</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mi_cities</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">maps</span><span class="cm-operator">::</span><span class="cm-variable">us.cities</span> <span class="cm-operator cm-variable-2">%&gt;%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 将数据格式转为tbl格式，便于处理</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tbl_df</span>() <span class="cm-operator cm-variable-2">%&gt;%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">filter</span>(<span class="cm-variable">country.etc</span> <span class="cm-operator">==</span> <span class="cm-string">"MI"</span>) <span class="cm-operator cm-variable-2">%&gt;%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 负号表示不选择该列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">select</span>(<span class="cm-operator">-</span><span class="cm-variable">country.etc</span>,<span class="cm-variable">lon</span> <span class="cm-operator">=</span> <span class="cm-variable">long</span>) <span class="cm-operator cm-variable-2">%&gt;%</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">arrange</span>(<span class="cm-variable">desc</span>(<span class="cm-variable">pop</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mi_cities</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 234px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">name</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">pop</span> &nbsp; <span class="cm-variable">lat</span> &nbsp; <span class="cm-variable">lon</span> <span class="cm-variable">capital</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">chr</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">dbl</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">dbl</span><span class="cm-operator">&gt;</span> &nbsp; <span class="cm-operator">&lt;</span><span class="cm-variable">int</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">1</span> <span class="cm-variable">Detroit</span> <span class="cm-variable">MI</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">871789</span> &nbsp;<span class="cm-number">42.4</span> <span class="cm-operator">-</span><span class="cm-number">83.1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span> <span class="cm-keyword">.......</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></pre><ul><li><span>我们可以使用散点图展示这些数据，但需要一定解释说明才能让图像清晰有效。因此，我们通常需要在点状元数据上绘制另一图层。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mi_cities</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">lon</span>,<span class="cm-variable">lat</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">pop</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_size_area</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">coord_quickmap</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">mi_cities</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">lon</span>,<span class="cm-variable">lat</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_polygon</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>),<span class="cm-variable">mi_counties</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-atom">NA</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"grey50"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">pop</span>),<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_size_area</span>() <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">coord_quickmap</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 058.png" referrerpolicy="no-referrer" alt="第3章 058"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 059.png" referrerpolicy="no-referrer" alt="第3章 059"></td></tr></tbody></table></figure><h4 id='光栅图'><span>光栅图</span></h4><ul><li><span>如果你不需要在矢量边界图中进行解释说明，而只是绘制一幅传统地图，这就称为光栅图。绘制栅图最简单的办法是使用 ggmap 包，它会从一系列包括OSM 和谷歌地图的在线地图资源中提取数据。</span></li><li><strong><span>原书第62页</span></strong><span>。</span></li></ul><h4 id='区域元数据'><span>区域元数据</span></h4><ul><li><strong><span>原书第64页</span></strong><span>。</span></li></ul><h3 id='不确定性关系'><span>不确定性关系</span></h3><ul><li><span>不论是从模型所得或是从对分布的假设而得，如果我们已经知道了一些关于数据中不确定性的信息，那么展示这些信息十分重要。ggplot2 中，共有四类几何对象可以用于这项任务，具体使用哪个取决于x的值是</span><strong><span>离散型</span></strong><span>还是</span><strong><span>连续型</span></strong><span>的以及我们是否想要展示区间内的</span><strong><span>中间值</span></strong><span>，或是仅仅展示</span><strong><span>区间</span></strong><span>。</span></li></ul><figure><table><thead><tr><th><span>需求</span></th><th><span>函数</span></th></tr></thead><tbody><tr><td><span>x为离散型，仅展示区间</span></td><td><span>geom_errorbar()、geom_linerange()</span></td></tr><tr><td><span>x为离散型，展示中间值和区间</span></td><td><span>geom_croossbar()、geom_pointrange()</span></td></tr><tr><td><span>x为连续型，仅展示区间</span></td><td><span>geom_ribbon()</span></td></tr><tr><td><span>x为离散型，展示中间值和区间</span></td><td><span>geom_smooth(stat = &quot;identity&quot;)</span></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 中间值和区间</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">y</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-number">18</span>,<span class="cm-number">11</span>,<span class="cm-number">16</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">3</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span>,<span class="cm-variable">se</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">1.2</span>,<span class="cm-number">0.5</span>,<span class="cm-number">1.0</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">df</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>,<span class="cm-variable">y</span>,<span class="cm-variable">ymin</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span> <span class="cm-operator">-</span> <span class="cm-variable">se</span>,<span class="cm-variable">ymax</span> <span class="cm-operator">=</span> <span class="cm-variable">y</span> <span class="cm-operator">+</span> <span class="cm-variable">se</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_crossbar</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_pointrange</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">stat</span> <span class="cm-operator">=</span> <span class="cm-string">"identity"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 060.png" referrerpolicy="no-referrer" alt="第3章 060"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 061.png" referrerpolicy="no-referrer" alt="第3章 061"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 063.png" referrerpolicy="no-referrer" alt="第3章 063"></td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 区间</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_errorbar</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_linerange</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">base</span> <span class="cm-operator">+</span> <span class="cm-variable">geom_ribbon</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th><th><span>图3</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 064.png" referrerpolicy="no-referrer" alt="第3章 064"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 065.png" referrerpolicy="no-referrer" alt="第3章 065"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 066.png" referrerpolicy="no-referrer" alt="第3章 066"></td></tr></tbody></table></figure><ul><li><span>由于标准误的计算方式很多，所以具体如何计算将由你自己决定。</span></li></ul><h3 id='含权数据'><span>含权数据</span></h3><ul><li><span>在处理整合后的数据(aggregated data)时，数据集的每一行可能代表了多个观测值，此时我们需要以某种方式把权重变量考虑进去。</span></li><li><span>这里以 2000 年美国人口普查中西部各州的统计数据 midwest 为例。数据集中主要包含的是比例型数据(例如白种人比例，贫困线以下人口比例，有大学学历的人口比例)和每个郡的基本信息(面积、人口总数、人口密度)。</span></li><li><span>权重变量的不同将极大地影响图形内容以及观察结论。有两种可以用于表现权重的可调图形属性。</span></li><li><span>首先，对于点和线这类简单的几何对象，我们可以根据点的数量来调整图形属性 </span><strong><span>size</span></strong><span> 来改变点的大小，代码如下所示：</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 未加权</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percwhite</span>,<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">geom_point</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 以人口数量未权重</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percwhite</span>,<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">poptotal</span><span class="cm-operator">/</span><span class="cm-number">1</span><span class="cm-variable">e6</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 设置符号的大小和提示文本</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_size_area</span>(<span class="cm-string">"每百万人口"</span>,<span class="cm-variable">breaks</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-number">0.5</span>,<span class="cm-number">1</span>,<span class="cm-number">2</span>,<span class="cm-number">4</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 067.png" referrerpolicy="no-referrer" alt="第3章 067"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 068.png" referrerpolicy="no-referrer" alt="第3章 068"></td></tr></tbody></table></figure><ul><li><span>对于更复杂的、涉及到统计变换的情况，我们通过修改 </span><strong><span>weight</span></strong><span> 图形属性来体现权重。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 未加权</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percwhite</span>,<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>() <span class="cm-operator">+</span> <span class="cm-variable">geom_smooth</span>(<span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"lm"</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 以人口数量未权重</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percwhite</span>,<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-variable">poptotal</span><span class="cm-operator">/</span><span class="cm-number">1</span><span class="cm-variable">e6</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_smooth</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">weight</span> <span class="cm-operator">=</span> <span class="cm-variable">poptotal</span>)<span class="cm-variable">.method</span> <span class="cm-operator">=</span> <span class="cm-string">"lm"</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 不显示提示文本</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_size_area</span>(<span class="cm-variable">guide</span> <span class="cm-operator">=</span> <span class="cm-string">"none"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 234px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 069.png" referrerpolicy="no-referrer" alt="第3章 069"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 070.png" referrerpolicy="no-referrer" alt="第3章 070"></td></tr></tbody></table></figure><ul><li><span>在我们将总人口作为权重去调整直方图或密度图时，我们的视角从</span><strong><span>对郡数量分布</span></strong><span>的考察转向了</span><strong><span>对人口数量</span></strong><span>分布的考察。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>(<span class="cm-variable">binwidth</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">midwest</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">percbelowpoverty</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>(<span class="cm-variable">aes</span>(<span class="cm-variable">weight</span> <span class="cm-operator">=</span> <span class="cm-variable">poptotal</span>),<span class="cm-variable">binwidth</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ylab</span>(<span class="cm-string">"Pouplation(1000s)"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><figure><table><thead><tr><th><span>图1</span></th><th><span>图2</span></th></tr></thead><tbody><tr><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 071.png" referrerpolicy="no-referrer" alt="第3章 071"></td><td><img src="img\021_ggplot2数据分析与图形艺术\第3章\第3章 072.png" referrerpolicy="no-referrer" alt="第3章 072"></td></tr></tbody></table></figure><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><span>参考资源：</span></p><ul><li><code>ggplot2数据分析与图形艺术 第二版</code></li></ul></div></div>
</body>
</html>