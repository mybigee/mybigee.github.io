<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<script src="https://note.ilulj.top/script/script.js"></script>
<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; tab-size: 4; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
  --mermaid-theme: night;
}

[lang='mermaid'] .label {
  color: #333;
}

/* CSS Document */

/** code highlight */

.cm-s-inner .cm-variable,
.cm-s-inner .cm-operator,
.cm-s-inner .cm-property {
    color: #b8bfc6;
}

.cm-s-inner .cm-keyword {
    color: #C88FD0;
}

.cm-s-inner .cm-tag {
    color: #7DF46A;
}

.cm-s-inner .cm-attribute {
    color: #7575E4;
}

.CodeMirror div.CodeMirror-cursor {
    border-left: 1px solid #b8bfc6;
    z-index: 3;
}

.cm-s-inner .cm-string {
    color: #D26B6B;
}

.cm-s-inner .cm-comment,
.cm-s-inner.cm-comment {
    color: #DA924A;
}

.cm-s-inner .cm-header,
.cm-s-inner .cm-def,
.cm-s-inner.cm-header,
.cm-s-inner.cm-def {
    color: #8d8df0;
}

.cm-s-inner .cm-quote,
.cm-s-inner.cm-quote {
    color: #57ac57;
}

.cm-s-inner .cm-hr {
    color: #d8d5d5;
}

.cm-s-inner .cm-link {
    color: #d3d3ef;
}

.cm-s-inner .cm-negative {
    color: #d95050;
}

.cm-s-inner .cm-positive {
    color: #50e650;
}

.cm-s-inner .cm-string-2 {
    color: #f50;
}

.cm-s-inner .cm-meta,
.cm-s-inner .cm-qualifier {
    color: #b7b3b3;
}

.cm-s-inner .cm-builtin {
    color: #f3b3f8;
}

.cm-s-inner .cm-bracket {
    color: #997;
}

.cm-s-inner .cm-atom,
.cm-s-inner.cm-atom {
    color: #84B6CB;
}

.cm-s-inner .cm-number {
    color: #64AB8F;
}

.cm-s-inner .cm-variable {
    color: #b8bfc6;
}

.cm-s-inner .cm-variable-2 {
    color: #9FBAD5;
}

.cm-s-inner .cm-variable-3 {
    color: #1cc685;
}

.CodeMirror-selectedtext,
.CodeMirror-selected {
    background: #4a89dc;
    color: #fff !important;
    text-shadow: none;
}

.CodeMirror-gutters {
    border-right: none;
}

/* CSS Document */

/** markdown source **/
.cm-s-typora-default .cm-header, 
.cm-s-typora-default .cm-property
{
    color: #cebcca;
}

.CodeMirror.cm-s-typora-default div.CodeMirror-cursor{
    border-left: 3px solid #b8bfc6;
}

.cm-s-typora-default .cm-comment {
    color: #9FB1FF;
}

.cm-s-typora-default .cm-string {
    color: #A7A7D9
}

.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number {
    color: #848695;
    font-style: italic;
}

.cm-s-typora-default .cm-link {
    color: #95B94B;
}

.cm-s-typora-default .CodeMirror-activeline-background {
    background: rgba(51, 51, 51, 0.72);
}

.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code {
	color: #8aa1e1;
}@import "";
@import "";
@import "";

:root {
    --bg-color:  #363B40;
    --side-bar-bg-color: #2E3033;
    --text-color: #b8bfc6;

    --select-text-bg-color:#4a89dc;

    --item-hover-bg-color: #0a0d16;
    --control-text-color: #b7b7b7;
    --control-text-hover-color: #eee;
    --window-border: 1px solid #555;

    --active-file-bg-color: rgb(34, 34, 34);
    --active-file-border-color: #8d8df0;

    --primary-color: #a3d5fe;

    --active-file-text-color: white;
    --item-hover-bg-color: #70717d;
    --item-hover-text-color: white;
    --primary-color: #6dc1e7;

    --rawblock-edit-panel-bd: #333;

    --search-select-bg-color: #428bca;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

html,
body {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
    background: #363B40;
    background: var(--bg-color);
    fill: currentColor;
    line-height: 1.625rem;
}

#write {
    max-width: 914px;
}


@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

html,
body,
button,
input,
select,
textarea,
div.code-tooltip-content {
    color: #b8bfc6;
    border-color: transparent;
}

div.code-tooltip,
.md-hover-tip .md-arrow:after {
    background: #333;
}

.native-window #md-notification {
    border: 1px solid #70717d;
}

.popover.bottom > .arrow:after {
    border-bottom-color: #333;
}

html,
body,
button,
input,
select,
textarea {
    font-family: "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
}

hr {
    height: 2px;
    border: 0;
    margin: 24px 0 !important;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: "Lucida Grande", "Corbel", sans-serif;
    font-weight: normal;
    clear: both;
    -ms-word-wrap: break-word;
    word-wrap: break-word;
    margin: 0;
    padding: 0;
    color: #DEDEDE
}

h1 {
    font-size: 2.5rem;
    /* 36px */
    line-height: 2.75rem;
    /* 40px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1.5px;
}

h2 {
    font-size: 1.63rem;
    /* 24px */
    line-height: 1.875rem;
    /* 30px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h3 {
    font-size: 1.17rem;
    /* 18px */
    line-height: 1.5rem;
    /* 24px */
    margin-bottom: 1.5rem;
    /* 24px */
    letter-spacing: -1px;
    font-weight: bold;
}

h4 {
    font-size: 1.12rem;
    /* 16px */
    line-height: 1.375rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    color: white;
}

h5 {
    font-size: 0.97rem;
    /* 16px */
    line-height: 1.25rem;
    /* 22px */
    margin-bottom: 1.5rem;
    /* 24px */
    font-weight: bold;
}

h6 {
    font-size: 0.93rem;
    /* 16px */
    line-height: 1rem;
    /* 16px */
    margin-bottom: 0.75rem;
    color: white;
}

@media (min-width: 980px) {
    h3.md-focus:before,
    h4.md-focus:before,
    h5.md-focus:before,
    h6.md-focus:before {
        color: #ddd;
        border: 1px solid #ddd;
        border-radius: 3px;
        position: absolute;
        left: -1.642857143rem;
        top: .357142857rem;
        float: left;
        font-size: 9px;
        padding-left: 2px;
        padding-right: 2px;
        vertical-align: bottom;
        font-weight: normal;
        line-height: normal;
    }

    h3.md-focus:before {
        content: 'h3';
    }

    h4.md-focus:before {
        content: 'h4';
    }

    h5.md-focus:before {
        content: 'h5';
        top: 0px;
    }

    h6.md-focus:before {
        content: 'h6';
        top: 0px;
    }
}

a {
    text-decoration: none;
    outline: 0;
}

a:hover {
    outline: 0;
}

a:focus {
    outline: thin dotted;
}

sup.md-footnote {
    background-color: #555;
    color: #ddd;
}

p {
    -ms-word-wrap: break-word;
    word-wrap: break-word;
}

p,
ul,
dd,
ol,
hr,
address,
pre,
table,
iframe,
.wp-caption,
.wp-audio-shortcode,
.wp-video-shortcode {
    margin-top: 0;
    margin-bottom: 1.5rem;
    /* 24px */
}

audio:not([controls]) {
    display: none;
}

[hidden] {
    display: none;
}

::-moz-selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

*.in-text-selection,
::selection {
    background: #4a89dc;
    color: #fff;
    text-shadow: none;
}

ul,
ol {
    padding: 0 0 0 1.875rem;
    /* 30px */
}

ul {
    list-style: square;
}

ol {
    list-style: decimal;
}

ul ul,
ol ol,
ul ol,
ol ul {
    margin: 0;
}

b,
th,
dt,
strong {
    font-weight: bold;
}

i,
em,
dfn,
cite {
    font-style: italic;
}

blockquote {
    padding-left: 1.875rem;
    margin: 0 0 1.875rem 1.875rem;
    border-left: solid 2px #474d54;
    padding-left: 30px;
    margin-top: 35px;
}

pre,
code,
kbd,
tt,
var {
    font-size: 0.875em;
    font-family: Monaco, Consolas, "Andale Mono", "DejaVu Sans Mono", monospace;
}

code,
tt,
var {
    background: rgba(0, 0, 0, 0.05);
}

kbd {
    padding: 2px 4px;
    font-size: 90%;
    color: #fff;
    background-color: #333;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 rgba(0,0,0,.25);
}

pre.md-fences {
    padding: 10px 10px 10px 30px;
    margin-bottom: 20px;
    background: #333;
}

.CodeMirror-gutters {
    background: #333;
    border-right: 1px solid transparent;
}

.enable-diagrams pre.md-fences[lang="sequence"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="flow"] .code-tooltip,
.enable-diagrams pre.md-fences[lang="mermaid"] .code-tooltip {
    bottom: -2.2em;
    right: 4px;
}

code,
kbd,
tt,
var {
    padding: 2px 5px;
}

table {
    max-width: 100%;
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
}

th,
td {
    padding: 5px 10px;
    vertical-align: top;
}

a {
    -webkit-transition: all .2s ease-in-out;
    transition: all .2s ease-in-out;
}

hr {
    background: #474d54;
    /* variable */
}

h1 {
    margin-top: 2em;
}

a {
    color: #e0e0e0;
    text-decoration: underline;
}

a:hover {
    color: #fff;
}

.md-inline-math script {
    color: #81b1db;
}

b,
th,
dt,
strong {
    color: #DEDEDE;
    /* variable */
}

mark {
    background: #D3D40E;
}

blockquote {
    color: #9DA2A6;
}

table a {
    color: #DEDEDE;
    /* variable */
}

th,
td {
    border: solid 1px #474d54;
    /* variable */
}

.task-list {
    padding-left: 0;
}

.md-task-list-item {
    padding-left: 1.25rem;
}

.md-task-list-item > input {
    top: auto;
}

.md-task-list-item > input:before {
    content: "";
    display: inline-block;
    width: 0.875rem;
    height: 0.875rem;
    vertical-align: middle;
    text-align: center;
    border: 1px solid #b8bfc6;
    background-color: #363B40;
    margin-top: -0.4rem;
}

.md-task-list-item > input:checked:before,
.md-task-list-item > input[checked]:before {
    content: '\221A';
    /*◘*/
    font-size: 0.625rem;
    line-height: 0.625rem;
    color: #DEDEDE;
}

/** quick open **/
.auto-suggest-container {
    border: 0px;
    background-color: #525C65;
}

#typora-quick-open {
    background-color: #525C65;
}

#typora-quick-open input{
    background-color: #525C65;
    border: 0;
    border-bottom: 1px solid grey;
}

.typora-quick-open-item {
    background-color: inherit;
    color: inherit;
}

.typora-quick-open-item.active,
.typora-quick-open-item:hover {
    background-color: #4D8BDB;
    color: white;
}

.typora-quick-open-item:hover {
    background-color: rgba(77, 139, 219, 0.8);
}

.typora-search-spinner > div {
  background-color: #fff;
}

#write pre.md-meta-block {
    border-bottom: 1px dashed #ccc;
    background: transparent;
    padding-bottom: 0.6em;
    line-height: 1.6em;
}

.btn,
.btn .btn-default {
    background: transparent;
    color: #b8bfc6;
}

.ty-table-edit {
    border-top: 1px solid gray;
    background-color: #363B40;
}

.popover-title {
    background: transparent;
}

.md-image>.md-meta {
    color: #BBBBBB;
    background: transparent;
}

.md-expand.md-image>.md-meta {
    color: #DDD;
}

#write>h3:before,
#write>h4:before,
#write>h5:before,
#write>h6:before {
    border: none;
    border-radius: 0px;
    color: #888;
    text-decoration: underline;
    left: -1.4rem;
    top: 0.2rem;
}

#write>h3.md-focus:before {
    top: 2px;
}

#write>h4.md-focus:before {
    top: 2px;
}

.md-toc-item {
    color: #A8C2DC;
}

#write div.md-toc-tooltip {
    background-color: #363B40;
}

.dropdown-menu .btn:hover,
.dropdown-menu .btn:focus,
.md-toc .btn:hover,
.md-toc .btn:focus {
    color: white;
    background: black;
}

#toc-dropmenu {
    background: rgba(50, 54, 59, 0.93);
    border: 1px solid rgba(253, 253, 253, 0.15);
}

#toc-dropmenu .divider {
    background-color: #9b9b9b;
}

.outline-expander:before {
    top: 2px;
}

#typora-sidebar {
    box-shadow: none;
    border-right: 1px dashed;
    border-right: none;
}

.sidebar-tabs {
    border-bottom:0;
}

#typora-sidebar:hover .outline-title-wrapper {
    border-left: 1px dashed;
}

.outline-title-wrapper .btn {
    color: inherit;
}

.outline-item:hover {
    border-color: #363B40;
    background-color: #363B40;
    color: white;
}

h1.md-focus .md-attr,
h2.md-focus .md-attr,
h3.md-focus .md-attr,
h4.md-focus .md-attr,
h5.md-focus .md-attr,
h6.md-focus .md-attr,
.md-header-span .md-attr {
    color: #8C8E92;
    display: inline;
}

.md-comment {
    color: #5a95e3;
    opacity: 0.8;
}

.md-inline-math svg {
    color: #b8bfc6;
}

#math-inline-preview .md-arrow:after {
    background: black;
}

.modal-content {
    background: var(--bg-color);
    border: 0;
}

.modal-title {
    font-size: 1.5em;
}

.modal-content input {
    background-color: rgba(26, 21, 21, 0.51);
    color: white;
}

.modal-content .input-group-addon {
    color: white;
}

.modal-backdrop {
    background-color: rgba(174, 174, 174, 0.7);
}

.modal-content .btn-primary {
    border-color: var(--primary-color);
}

.md-table-resize-popover {
    background-color: #333;
}

.form-inline .input-group .input-group-addon {
    color: white;
}

#md-searchpanel {
    border-bottom: 1px dashed grey;
}

/** UI for electron */

.context-menu,
#spell-check-panel,
#footer-word-count-info {
    background-color: #42464A;
}

.context-menu.dropdown-menu .divider,
.dropdown-menu .divider {
    background-color: #777777;
    opacity: 1;
}

footer {
    color: inherit;
}

@media (max-width: 1000px) {
    footer {
        border-top: none;
    }
    footer:hover {
        color: inherit;
    }
}

#file-info-file-path .file-info-field-value:hover {
    background-color: #555;
    color: #dedede;
}

.megamenu-content,
.megamenu-opened header {
    background: var(--bg-color);
}

.megamenu-menu-panel h2,
.megamenu-menu-panel h1,
.long-btn {
    color: inherit;
}

.megamenu-menu-panel input[type='text'] {
    background: inherit;
    border: 0;
    border-bottom: 1px solid;
}

#recent-file-panel-action-btn {
    background: inherit;
    border: 1px grey solid;
}

.megamenu-menu-panel .dropdown-menu > li > a {
    color: inherit;
    background-color: #2F353A;
    text-decoration: none;
}

.megamenu-menu-panel table td:nth-child(1) {
    color: inherit;
    font-weight: bold;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(1) {
    color: white;
}

.modal-footer .btn-default, 
.modal-footer .btn-primary,
.modal-footer .btn-default:not(:hover) {
    border: 1px solid;
    border-color: transparent;
}

.btn-primary {
    color: white;
}

.btn-default:hover, .btn-default:focus, .btn-default.focus, .btn-default:active, .btn-default.active, .open > .dropdown-toggle.btn-default {
    color: white;
    border: 1px solid #ddd;
    background-color: inherit;
}

.modal-header {
    border-bottom: 0;
}

.modal-footer {
    border-top: 0;
}

#recent-file-panel tbody tr:nth-child(2n-1) {
    background-color: transparent !important;
}

.megamenu-menu-panel tbody tr:hover td:nth-child(2) {
    color: inherit;
}

.megamenu-menu-panel .btn {
    border: 1px solid #eee;
    background: transparent;
}

.mouse-hover .toolbar-icon.btn:hover,
#w-full.mouse-hover,
#w-pin.mouse-hover {
    background-color: inherit;
}

.typora-node::-webkit-scrollbar {
    width: 5px;
}

.typora-node::-webkit-scrollbar-thumb:vertical {
    background: rgba(250, 250, 250, 0.3);
}

.typora-node::-webkit-scrollbar-thumb:vertical:active {
    background: rgba(250, 250, 250, 0.5);
}

#w-unpin {
    background-color: #4182c4;
}

#top-titlebar, #top-titlebar * {
    color: var(--item-hover-text-color);
}

.typora-sourceview-on #toggle-sourceview-btn,
#footer-word-count:hover,
.ty-show-word-count #footer-word-count {
    background: #333333;
}

#toggle-sourceview-btn:hover {
    color: #eee;
    background: #333333;
}

/** focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) * {
    color: #686868 !important;
}

.on-focus-mode .md-end-block:not(.md-focus) img,
.on-focus-mode .md-task-list-item:not(.md-focus-container)>input {
    opacity: #686868 !important;
}

.on-focus-mode li[cid]:not(.md-focus-container){
    color: #686868;
}

.on-focus-mode .md-fences.md-focus .CodeMirror-code>*:not(.CodeMirror-activeline) *,
.on-focus-mode .CodeMirror.cm-s-inner:not(.CodeMirror-focused) * {
    color: #686868 !important;
}

.on-focus-mode .md-focus,
.on-focus-mode .md-focus-container {
    color: #fff;
}

.on-focus-mode #typora-source .CodeMirror-code>*:not(.CodeMirror-activeline) * {
    color: #686868 !important;
}


/*diagrams*/
#write .md-focus .md-diagram-panel {
    border: 1px solid #ddd;
    margin-left: -1px;
    width: calc(100% + 2px);
}

/*diagrams*/
#write .md-focus.md-fences-with-lineno .md-diagram-panel {
    margin-left: auto;
}

.md-diagram-panel-error {
    color: #f1908e;
}

.active-tab-files #info-panel-tab-file,
.active-tab-files #info-panel-tab-file:hover,
.active-tab-outline #info-panel-tab-outline,
.active-tab-outline #info-panel-tab-outline:hover {
    color: #eee;
}

.sidebar-footer-item:hover,
.footer-item:hover {
    background: inherit;
    color: white;
}

.ty-side-sort-btn.active,
.ty-side-sort-btn:hover,
.selected-folder-menu-item a:after {
    color: white;
}

#sidebar-files-menu {
    border:solid 1px;
    box-shadow: 4px 4px 20px rgba(0, 0, 0, 0.79);
    background-color: var(--bg-color);
}

.file-list-item {
    border-bottom:none;
}

.file-list-item-summary {
    opacity: 1;
}

.file-list-item.active:first-child {
    border-top: none;
}

.file-node-background {
    height: 32px;
}

.file-library-node.active>.file-node-content,
.file-list-item.active {
    color: white;
    color: var(--active-file-text-color);
}

.file-library-node.active>.file-node-background{
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}
.file-list-item.active {
    background-color: rgb(34, 34, 34);
    background-color: var(--active-file-bg-color);
}

#ty-tooltip {
    background-color: black;
    color: #eee;
}

.md-task-list-item>input {
    margin-left: -1.3em;
    margin-top: 0.3rem;
    -webkit-appearance: none;
}

.md-mathjax-midline {
    background-color: #57616b;
    border-bottom: none;
}

footer.ty-footer {
    border-color: #656565;
}

.ty-preferences .btn-default {
    background: transparent;
}
.ty-preferences .btn-default:hover {
    background: #57616b;
}

.ty-preferences select {
    border: 1px solid #989698;
    height: 21px;
}

.ty-preferences .nav-group-item.active,
.export-item.active,
.export-items-list-control,
.export-detail {
    background: var(--item-hover-bg-color);
}

.ty-preferences input[type="search"] {
    border-color: #333;
    background: #333;
    line-height: 22px;
    border-radius: 6px;
    color: white;
}

.ty-preferences input[type="search"]:focus {
    box-shadow: none;
}

[data-is-directory="true"] .file-node-content {
    margin-bottom: 0;
}

.file-node-title {
    line-height: 22px;
}

.html-for-mac .file-node-open-state, .html-for-mac .file-node-icon {
    line-height: 26px;
}

::-webkit-scrollbar-thumb {
    background: rgba(230, 230, 230, 0.30);
}

::-webkit-scrollbar-thumb:active {
    background: rgba(230, 230, 230, 0.50);
}

#typora-sidebar:hover div.sidebar-content-content::-webkit-scrollbar-thumb:horizontal {
    background: rgba(230, 230, 230, 0.30);
}

.nav-group-item:active {
    background-color: #474d54 !important;
}

.md-search-hit {
    background: rgba(199, 140, 60, 0.81);
    color: #eee;
}

.md-search-hit * {
    color: #eee;
}

#md-searchpanel input {
    color: white;
}

.modal-backdrop.in {
    opacity: 1;
    backdrop-filter: blur(1px);
}

.clear-btn-icon {
    top: 8px;
}


</style><title>004_生信人应该这样学R语言</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='生信人应该这样学r语言'><span>生信人应该这样学R语言</span></h1><ul><li><span>B站UP主：</span><a href='https://space.bilibili.com/338686099'><span>生信技能树-jimmy</span></a><span> </span></li><li><span>视频链接：</span><a href='https://www.bilibili.com/video/BV1cs411j75B/'><span>生信人应该这样学R语言</span></a><span> </span></li><li><a href='http://biotrainee.com/jmzeng/markdown/basic-plot-R.html'><span>R语言基础</span></a><span> </span></li><li><a href='http://biotrainee.com/jmzeng/markdown/ggplot-in-R.html'><span>ggplot2练习</span></a><span> </span></li></ul><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" href="#生信人应该这样学r语言">生信人应该这样学R语言</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n12"><a class="md-toc-inner" href="#一介绍r语言">一、介绍R语言</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n18"><a class="md-toc-inner" href="#二r语言基础变量">二、R语言基础变量</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n21"><a class="md-toc-inner" href="#三外部数据的导入导出">三、外部数据的导入导出</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n27"><a class="md-toc-inner" href="#四中级变量操作">四、中级变量操作</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n38"><a class="md-toc-inner" href="#五热图">五、热图</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n47"><a class="md-toc-inner" href="#六选取差异明显的基因的表达矩阵绘制热图">六、选取差异明显的基因的表达矩阵绘制热图</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n48"><a class="md-toc-inner" href="#七id转换">七、ID转换</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n57"><a class="md-toc-inner" href="#八任意癌症表达量分组的生存分析">八、任意癌症表达量分组的生存分析</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n72"><a class="md-toc-inner" href="#九任意癌症表达量和临床相关联">九、任意癌症表达量和临床相关联</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n89"><a class="md-toc-inner" href="#十表达矩阵的样本相关性">十、表达矩阵的样本相关性</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n98"><a class="md-toc-inner" href="#十一芯片表达矩阵下游分析">十一、芯片表达矩阵下游分析</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n103"><a class="md-toc-inner" href="#十二rna-seq表达矩阵差异分析">十二、RNA-seq表达矩阵差异分析</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n105"><a class="md-toc-inner" href="#十三r语言小作业">十三、R语言小作业</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n177"><a class="md-toc-inner" href="#十四r语言学习资源">十四、R语言学习资源</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n187"><a class="md-toc-inner" href="#十五高级数据处理技巧">十五、高级数据处理技巧</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n200"><a class="md-toc-inner" href="#十六绘图">十六、绘图</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n210"><a class="md-toc-inner" href="#十七生信人的20个r语言习题">十七、生信人的20个R语言习题</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n348"><a class="md-toc-inner" href="#十八r语言可视化">十八、R语言可视化</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n352"><a class="md-toc-inner" href="#十九shiny编写网页">十九、shiny编写网页</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n353"><a class="md-toc-inner" href="#二十r语言操作图片">二十、R语言操作图片</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n354"><a class="md-toc-inner" href="#二一r语言爬虫">二一、R语言爬虫</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n360"><a class="md-toc-inner" href="#二二r语言id转换">二二、R语言ID转换</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n364"><a class="md-toc-inner" href="#二三多个差异分析结果直接量量取交集并集">二三、多个差异分析结果直接量量取交集并集</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n370"><a class="md-toc-inner" href="#二四wgcna">二四、WGCNA</a></span><span role="listitem" class="md-toc-item md-toc-h2" data-ref="n376"><a class="md-toc-inner" href="#二五rna-seq分析">二五、RNA-seq分析</a></span></p></div><h2 id='一介绍r语言'><span>一、介绍R语言</span></h2><ul><li><a href='http://www.bio-info-trainee.com/3727.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3727.html</a></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># CRAN</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">options</span>()<span class="cm-operator cm-dollar">$</span><span class="cm-variable">repos</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">CRAN</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">"https://mirrors.sjtug.sjtu.edu.cn/cran/"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">attr</span>(,<span class="cm-string">"RStudio"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-variable">TRUE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 设置软件下载的CRAN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># options("repos" = c(CRAN="https://mirrors.tuna.tsinghua.edu.cn/CRAN/"))</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取本地的软件包下载文件夹</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">.libPaths</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"D:/Program Files/R/R-4.2.2/library"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 删除当前工作环境的全部变量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rm</span>(<span class="cm-builtin">list</span> <span class="cm-operator">=</span> <span class="cm-variable">ls</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><h2 id='二r语言基础变量'><span>二、R语言基础变量</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存变量</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">a</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">save</span>(<span class="cm-variable">a</span>,<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-string">"D:/a.RData"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rm</span>(<span class="cm-variable">a</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">load</span>(<span class="cm-string">"D:/a.RData"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">a</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">1</span> <span class="cm-number">2</span> <span class="cm-number">3</span> <span class="cm-number">4</span> <span class="cm-number">5</span> <span class="cm-number">6</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 找出数据框指定字符所在的行</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">x</span> <span class="cm-arg-is">=</span> <span class="cm-variable">sample</span>(<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">2</span>,<span class="cm-number">10</span>,<span class="cm-variable">replace</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">y</span> <span class="cm-arg-is">=</span> <span class="cm-variable">letters</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">10</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> )</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 返回下标</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">grep</span>(<span class="cm-number">1</span>,<span class="cm-variable">data</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] &nbsp;<span class="cm-number">1</span> &nbsp;<span class="cm-number">6</span> &nbsp;<span class="cm-number">8</span> <span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 返回布尔值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">grep</span>(<span class="cm-number">2</span>,<span class="cm-variable">data</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">2</span> <span class="cm-number">3</span> <span class="cm-number">4</span> <span class="cm-number">5</span> <span class="cm-number">7</span> <span class="cm-number">9</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><h2 id='三外部数据的导入导出'><span>三、外部数据的导入导出</span></h2><ul><li><span>读取数据的函数，如</span><strong><span>read.table()</span></strong><span>在写文件的路径时可以按</span><strong><span>tab键</span></strong><span>，此时会弹出文件夹里的文件供选择。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 读取表格数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># comment.char：指定注释的符号（会忽略注释的行）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">file1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/003test.csv"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 会忽略 &amp; 开头的行</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">a</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">file1</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">comment.char</span> <span class="cm-operator">=</span> <span class="cm-string">"&amp;"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 130px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\001.png" alt="001" style="zoom:67%;" /></p><h2 id='四中级变量操作'><span>四、中级变量操作</span></h2><ul><li><strong><span>rowMeans()</span></strong><span>：行的均值</span></li><li><strong><span>rowSums()</span></strong><span>：行的总和</span></li><li><strong><span>colMeans()</span></strong><span>：列均值</span></li><li><strong><span>colSums()</span></strong><span>：列求和</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">10</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-number">11</span><span class="cm-operator">:</span><span class="cm-number">20</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 行的平均值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rowMeans</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] &nbsp;<span class="cm-number">6</span> &nbsp;<span class="cm-number">7</span> &nbsp;<span class="cm-number">8</span> &nbsp;<span class="cm-number">9</span> <span class="cm-number">10</span> <span class="cm-number">11</span> <span class="cm-number">12</span> <span class="cm-number">13</span> <span class="cm-number">14</span> <span class="cm-number">15</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 或</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">apply</span>(<span class="cm-variable">data</span>, <span class="cm-number">1</span>, <span class="cm-variable">mean</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] &nbsp;<span class="cm-number">6</span> &nbsp;<span class="cm-number">7</span> &nbsp;<span class="cm-number">8</span> &nbsp;<span class="cm-number">9</span> <span class="cm-number">10</span> <span class="cm-number">11</span> <span class="cm-number">12</span> <span class="cm-number">13</span> <span class="cm-number">14</span> <span class="cm-number">15</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 每一行的和</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rowSums</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] <span class="cm-number">12</span> <span class="cm-number">14</span> <span class="cm-number">16</span> <span class="cm-number">18</span> <span class="cm-number">20</span> <span class="cm-number">22</span> <span class="cm-number">24</span> <span class="cm-number">26</span> <span class="cm-number">28</span> <span class="cm-number">30</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 或 </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">apply</span>(<span class="cm-variable">data</span>,<span class="cm-number">1</span>,<span class="cm-variable">sum</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] <span class="cm-number">12</span> <span class="cm-number">14</span> <span class="cm-number">16</span> <span class="cm-number">18</span> <span class="cm-number">20</span> <span class="cm-number">22</span> <span class="cm-number">24</span> <span class="cm-number">26</span> <span class="cm-number">28</span> <span class="cm-number">30</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 列均值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colMeans</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">x</span> &nbsp; &nbsp;<span class="cm-variable">y</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">5.5</span> <span class="cm-number">15.5</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 列求和</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colSums</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">x</span> &nbsp; <span class="cm-variable">y</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">55</span> <span class="cm-number">155</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 572px;"></div><div class="CodeMirror-gutters" style="display: none; height: 572px;"></div></div></div></pre><h2 id='五热图'><span>五、热图</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制热图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">pheatmap</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">a1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">matrix</span>(<span class="cm-variable">rnorm</span>(<span class="cm-number">100</span>),<span class="cm-variable">nc</span> <span class="cm-operator">=</span> <span class="cm-number">20</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># pheatmap(a1)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">a2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">matrix</span>(<span class="cm-variable">rnorm</span>(<span class="cm-number">100</span>) <span class="cm-operator">+</span> <span class="cm-number">2</span>,<span class="cm-variable">nc</span> <span class="cm-operator">=</span> <span class="cm-number">20</span>,)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># pheatmap(a2)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pheatmap</span>(<span class="cm-variable">cbind</span>(<span class="cm-variable">a1</span>,<span class="cm-variable">a2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># cluster_cols = F：不在列上进行聚类（默认会），</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 这样可以从左到右排列数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pheatmap</span>(<span class="cm-variable">cbind</span>(<span class="cm-variable">a1</span>,<span class="cm-variable">a2</span>),<span class="cm-variable">cluster_cols</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 添加列名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">b</span> <span class="cm-operator">=</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">cbind</span>(<span class="cm-variable">a1</span>,<span class="cm-variable">a2</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">names</span>(<span class="cm-variable">b</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-variable">paste0</span>(<span class="cm-string">"a1"</span>,<span class="cm-string">"_"</span>,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">20</span>),<span class="cm-variable">paste0</span>(<span class="cm-string">"a2"</span>,<span class="cm-string">"_"</span>,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">20</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pheatmap</span>(<span class="cm-variable">b</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\002.png" referrerpolicy="no-referrer" alt="002"></th><th><img src="img\004_生信人应该这样学R语言\003.png" referrerpolicy="no-referrer" alt="003"></th></tr></thead><tbody><tr><td><img src="img\004_生信人应该这样学R语言\004.png" referrerpolicy="no-referrer" alt="004"></td><td>&nbsp;</td></tr></tbody></table></figure><h2 id='六选取差异明显的基因的表达矩阵绘制热图'><span>六、选取差异明显的基因的表达矩阵绘制热图</span></h2><h2 id='七id转换'><span>七、ID转换</span></h2><ul><li><p><span>通过</span><strong><code>.</code></strong><span>分割字符串：</span><strong><span>stringr::str_split()</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">stringr</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"123.456"</span>,<span class="cm-string">"abc.efg"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">a</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">str_split</span>(<span class="cm-variable">data</span>,<span class="cm-string">"[.]"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">b</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">str_split</span>(<span class="cm-variable">data</span>,<span class="cm-string">"[.]"</span>,<span class="cm-variable">simplify</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">a</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"list"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">b</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"matrix"</span> <span class="cm-string">"array"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取点好之前的部分(第一列)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">b</span>[,<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"123"</span> <span class="cm-string">"abc"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre></li><li><p><span>读取</span><strong><span>readsCounts.xlsx</span></strong><span>文件的第一列（基因ID），进行ID转换：</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 读取readsCounts.xlsx文件的第一列（基因ID），进行ID转换</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">openxlsx</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/readsCounts.xlsx"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># colNames = T：存在表头，类似于header=T</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 只读取第一列cols = 1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneID</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.xlsx</span>(<span class="cm-variable">f</span>,<span class="cm-variable">sheet</span> <span class="cm-operator">=</span> <span class="cm-string">"Sheet1"</span>,<span class="cm-variable">colNames</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">cols</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">geneID</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"ensembl_id"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 读取ID转换的包</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">org.Hs.eg.db</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 转为数据框的格式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g2s</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">org.Hs.egSYMBOL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g2e</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">org.Hs.egENSEMBL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">g2s</span>,<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">gene_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; <span class="cm-variable">A1BG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp;<span class="cm-variable">A2M</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">g2e</span>,<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">gene_id</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ensembl_id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> <span class="cm-variable">ENSG00000121410</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> <span class="cm-variable">ENSG00000175899</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">g2s</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"gene_id"</span> <span class="cm-string">"symbol"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">g2e</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"gene_id"</span> &nbsp; &nbsp;<span class="cm-string">"ensembl_id"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 根据ensembl_id合并数据框</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">eids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">geneID</span>,<span class="cm-variable">g2e</span>,<span class="cm-variable">by</span> <span class="cm-operator">=</span> <span class="cm-string">"ensembl_id"</span>,<span class="cm-variable">all.x</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 根据gene_id合并数据框</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">eids</span>,<span class="cm-variable">g2s</span>,<span class="cm-variable">by</span> <span class="cm-operator">=</span> <span class="cm-string">"gene_id"</span>,<span class="cm-variable">all.x</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">genes</span>,<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">gene_id</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ensembl_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> <span class="cm-variable">ENSG00000121410</span> &nbsp; <span class="cm-variable">A1BG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">10</span> <span class="cm-variable">ENSG00000156006</span> &nbsp; <span class="cm-variable">NAT2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">tail</span>(<span class="cm-variable">genes</span>,<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">gene_id</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ensembl_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">58244</span> &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-atom">NA</span><span class="cm-operator">&gt;</span> <span class="cm-variable">ENSG00000274372</span> &nbsp; <span class="cm-operator">&lt;</span><span class="cm-atom">NA</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">58245</span> &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-atom">NA</span><span class="cm-operator">&gt;</span> <span class="cm-variable">ENSG00000279368</span> &nbsp; <span class="cm-operator">&lt;</span><span class="cm-atom">NA</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 排序</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">genes</span>[<span class="cm-variable">order</span>(<span class="cm-variable">genes</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 最初的geneID一共有57992行，而genes有58245行</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">geneID</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">57992</span> &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">genes</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">58245</span> &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 原因是一个ensembl_id对应到了两个gene_id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># ensembl_id出现多于一次的基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">x</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">table</span>(<span class="cm-variable">genes</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>)[<span class="cm-variable">table</span>(<span class="cm-variable">genes</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">x</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000004866</span> <span class="cm-variable">ENSG00000063587</span> <span class="cm-variable">ENSG00000067601</span> <span class="cm-variable">ENSG00000086200</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">2</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">x</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">225</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 去掉重复的行（将该行删除）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">genes</span>[<span class="cm-operator">!</span><span class="cm-variable">duplicated</span>(<span class="cm-variable">genes</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">genes</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">57992</span> &nbsp; &nbsp; <span class="cm-number">3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 根据原geneID的顺序排列</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">genes</span>[<span class="cm-variable">match</span>(<span class="cm-variable">geneID</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>,<span class="cm-variable">genes</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">ensembl_id</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存为csv</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">write.csv</span>(<span class="cm-variable">genes</span>,<span class="cm-string">"d:/genes.csv"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1534px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1534px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\005.png" referrerpolicy="no-referrer" alt="005"></p><h2 id='八任意癌症表达量分组的生存分析'><span>八、任意癌症表达量分组的生存分析</span></h2><ul><li><a href='http://www.oncolnc.org/'><span>OncoLnc</span></a><span> </span></li><li><span>搜索</span><strong><span>ARHGAP18</span></strong><span>基因，任选一个样本，分组（高表达和低表达）都为50，点击</span><strong><span>click here</span></strong><span>可以下载表达矩阵。得到文件</span><strong><span>LGG_93663_50_50.csv</span></strong><span> </span></li></ul><p><img src="img\004_生信人应该这样学R语言\006.png" alt="006" style="zoom: 33%;" /></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 生存分析</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/LGG_93663_50_50.csv"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">f</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">","</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"Patient"</span> &nbsp; &nbsp;<span class="cm-string">"Days"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"Status"</span> &nbsp; &nbsp; <span class="cm-string">"Expression"</span> <span class="cm-string">"Group"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">d</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># install.packages("ggstatsplot")</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggstatsplot</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggbetweenstats</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">Group</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">Expression</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggbetweenstats</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">Status</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">Expression</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># install.packages(c("survival","survminer"))</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">survival</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">survminer</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">table</span>(<span class="cm-variable">d</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Status</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Alive</span> &nbsp;<span class="cm-variable">Dead</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">385</span> &nbsp; <span class="cm-number">125</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">d</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Status</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">d</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Status</span> <span class="cm-operator">==</span> <span class="cm-string">"Dead"</span>,<span class="cm-number">1</span>,<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sfit</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">survfit</span>(<span class="cm-variable">Surv</span>(<span class="cm-variable">Days</span>,<span class="cm-variable">Status</span>)<span class="cm-operator">~</span><span class="cm-variable">Group</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sfit</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Call</span><span class="cm-operator">:</span> <span class="cm-variable">survfit</span>(<span class="cm-variable">formula</span> <span class="cm-operator">=</span> <span class="cm-variable">Surv</span>(<span class="cm-variable">Days</span>, <span class="cm-variable">Status</span>) <span class="cm-operator">~</span> <span class="cm-variable">Group</span>, <span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">n</span> <span class="cm-variable">events</span> <span class="cm-variable">median</span> <span class="cm-number">0.95L</span><span class="cm-variable">CL</span> <span class="cm-number">0.95</span><span class="cm-variable">UCL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Group</span><span class="cm-operator">=</span><span class="cm-variable">High</span> <span class="cm-number">255</span> &nbsp; &nbsp; <span class="cm-number">80</span> &nbsp; <span class="cm-number">1886</span> &nbsp; &nbsp;<span class="cm-number">1481</span> &nbsp; &nbsp;<span class="cm-number">2379</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Group</span><span class="cm-operator">=</span><span class="cm-variable">Low</span> &nbsp;<span class="cm-number">255</span> &nbsp; &nbsp; <span class="cm-number">45</span> &nbsp; <span class="cm-number">3571</span> &nbsp; &nbsp;<span class="cm-number">2875</span> &nbsp; &nbsp;<span class="cm-number">4445</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">summary</span>(<span class="cm-variable">sfit</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Call</span><span class="cm-operator">:</span> <span class="cm-variable">survfit</span>(<span class="cm-variable">formula</span> <span class="cm-operator">=</span> <span class="cm-variable">Surv</span>(<span class="cm-variable">Days</span>, <span class="cm-variable">Status</span>) <span class="cm-operator">~</span> <span class="cm-variable">Group</span>, <span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Group</span><span class="cm-operator">=</span><span class="cm-variable">High</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">time</span> <span class="cm-variable">n.risk</span> <span class="cm-variable">n.event</span> <span class="cm-variable">survival</span> <span class="cm-variable">std.err</span> <span class="cm-variable">lower</span> <span class="cm-number">95</span><span class="cm-operator cm-variable-2">% CI upper 95%</span> <span class="cm-variable">CI</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp;<span class="cm-number">246</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp;<span class="cm-number">0.996</span> <span class="cm-number">0.00406</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.9880</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-number">113</span> &nbsp; &nbsp;<span class="cm-number">226</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp;<span class="cm-number">0.992</span> <span class="cm-number">0.00597</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.9799</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.000</span> <span class="cm-keyword">.......</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Group</span><span class="cm-operator">=</span><span class="cm-variable">Low</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-variable">time</span> <span class="cm-variable">n.risk</span> <span class="cm-variable">n.event</span> <span class="cm-variable">survival</span> <span class="cm-variable">std.err</span> <span class="cm-variable">lower</span> <span class="cm-number">95</span><span class="cm-operator cm-variable-2">% CI upper 95%</span> <span class="cm-variable">CI</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">23</span> &nbsp; &nbsp;<span class="cm-number">244</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; <span class="cm-number">0.9959</span> <span class="cm-number">0.00409</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.9879</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">37</span> &nbsp; &nbsp;<span class="cm-number">243</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; <span class="cm-number">0.9918</span> <span class="cm-number">0.00577</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0.9806</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.000</span> <span class="cm-keyword">.......</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsurvplot</span>(<span class="cm-variable">sfit</span>,<span class="cm-variable">conf.int</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">pval</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsave</span>(<span class="cm-string">"d:/survival.png"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Saving</span> <span class="cm-number">2.56</span> <span class="cm-variable">x</span> <span class="cm-number">2.66</span> <span class="cm-keyword">in</span> <span class="cm-variable">image</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsurvplot</span>(<span class="cm-variable">sfit</span>,<span class="cm-variable">palette</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"#E7B800"</span>,<span class="cm-string">"#2E9FDF"</span>),<span class="cm-variable">risk.table</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">pval</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">conf.int</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">xlab</span> <span class="cm-operator">=</span> <span class="cm-string">"Time in months"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">ggtheme</span> <span class="cm-operator">=</span> <span class="cm-variable">theme_light</span>(),<span class="cm-variable">ncenter.plot</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsave</span>(<span class="cm-string">"d:/survival2.png"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Saving</span> <span class="cm-number">2.56</span> <span class="cm-variable">x</span> <span class="cm-number">2.66</span> <span class="cm-keyword">in</span> <span class="cm-variable">image</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1092px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1092px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\007.png" referrerpolicy="no-referrer" alt="007"></th><th><img src="img\004_生信人应该这样学R语言\008.png" referrerpolicy="no-referrer" alt="008"></th></tr></thead><tbody><tr><td><img src="img\004_生信人应该这样学R语言\009.png" alt="009" style="zoom: 50%;" /></td><td><img src="img\004_生信人应该这样学R语言\010.png" referrerpolicy="no-referrer" alt="010"></td></tr></tbody></table></figure><h2 id='九任意癌症表达量和临床相关联'><span>九、任意癌症表达量和临床相关联</span></h2><ul><li><span>寻找临床信息，上一节只找到了生活史的信息。</span></li><li><a href='http://www.cbioportal.org/'><span>cBioPortal</span></a><span> </span></li><li><span>在最左边选择</span><strong><span>Ovary/Fallopian Tube</span></strong><span>下的</span><strong><span>Ovarian Serous Cystadenocarcinoma (TCGA, Nature 2011)</span></strong><span>，点击</span><strong><span>Query By Gene</span></strong><span>，在下面输入上一节的基因 </span><strong><span>ARHGAP18</span></strong><span>，提交。</span></li><li><span>使用网页（非代码）：</span></li></ul><p><img src="img\004_生信人应该这样学R语言\011.png" alt="011" style="zoom: 40%;" /></p><ul><li><span>下载数据：</span><strong><span>plot.txt</span></strong></li></ul><p><img src="img\004_生信人应该这样学R语言\012.png" alt="012" style="zoom:50%;" /></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rm</span>(<span class="cm-builtin">list</span> <span class="cm-operator">=</span> <span class="cm-variable">ls</span>())</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/plot.txt"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">f</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">data</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"id"</span>,<span class="cm-string">"stage"</span>,<span class="cm-string">"gene"</span>,<span class="cm-string">"mut"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggstatsplot</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggbetweenstats</span>(<span class="cm-variable">data</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">stage</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">gene</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsave</span>(<span class="cm-string">"d:/plot.png"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 方差分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">res.aov</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">aov</span>(<span class="cm-variable">gene</span> <span class="cm-operator">~</span> <span class="cm-variable">stage</span>,<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">summary</span>(<span class="cm-variable">res.aov</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Df</span> <span class="cm-variable">Sum</span> <span class="cm-variable">Sq</span> <span class="cm-variable">Mean</span> <span class="cm-variable">Sq</span> <span class="cm-variable">F</span> <span class="cm-variable">value</span> <span class="cm-variable">Pr</span>(<span class="cm-operator">&gt;</span><span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stage</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">6</span> &nbsp; <span class="cm-number">6.46</span> &nbsp;<span class="cm-number">1.0771</span> &nbsp; <span class="cm-number">1.157</span> &nbsp;<span class="cm-number">0.329</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Residuals</span> &nbsp; <span class="cm-number">308</span> <span class="cm-number">286.79</span> &nbsp;<span class="cm-number">0.9311</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">TukeyHSD</span>(<span class="cm-variable">res.aov</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">Tukey</span> <span class="cm-variable">multiple</span> <span class="cm-variable">comparisons</span> <span class="cm-variable">of</span> <span class="cm-variable">means</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-number">95</span><span class="cm-operator cm-variable-2">%</span> <span class="cm-variable">family</span><span class="cm-operator">-</span><span class="cm-variable">wise</span> <span class="cm-variable">confidence</span> <span class="cm-variable">level</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Fit</span><span class="cm-operator">:</span> <span class="cm-variable">aov</span>(<span class="cm-variable">formula</span> <span class="cm-operator">=</span> <span class="cm-variable">gene</span> <span class="cm-operator">~</span> <span class="cm-variable">stage</span>, <span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator cm-dollar">$</span><span class="cm-variable">stage</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">diff</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">lwr</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">upr</span> &nbsp; &nbsp; <span class="cm-variable">p</span> <span class="cm-variable">adj</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">IIB</span><span class="cm-operator">-</span><span class="cm-variable">IIA</span> &nbsp; &nbsp;<span class="cm-number">1.64615000</span> <span class="cm-operator">-</span><span class="cm-number">0.8340726</span> <span class="cm-number">4.1263726</span> <span class="cm-number">0.4360655</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">IIC</span><span class="cm-operator">-</span><span class="cm-variable">IIA</span> &nbsp; &nbsp;<span class="cm-number">0.65663750</span> <span class="cm-operator">-</span><span class="cm-number">1.6074856</span> <span class="cm-number">2.9207606</span> <span class="cm-number">0.9779411</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">.........</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 624px;"></div><div class="CodeMirror-gutters" style="display: none; height: 624px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\013.png" alt="013" style="zoom: 33%;" /></p><h2 id='十表达矩阵的样本相关性'><span>十、表达矩阵的样本相关性</span></h2><ul><li><span>由于最开始的表达矩阵里可能含有大量的0，会导致各个变量（样本）之间的相关性变大，此时应该对数据进行过滤。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 下载bioconductor中的数据包</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># BiocManager::install("airway")</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">airway</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span>(<span class="cm-string">"airway"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">airway</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">class</span><span class="cm-operator">:</span> <span class="cm-variable">RangedSummarizedExperiment</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dim</span><span class="cm-operator">:</span> <span class="cm-number">64102</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">metadata</span>(<span class="cm-number">1</span>)<span class="cm-operator">:</span> <span class="cm-string">''</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">assays</span>(<span class="cm-number">1</span>)<span class="cm-operator">:</span> <span class="cm-variable">counts</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rownames</span>(<span class="cm-number">64102</span>)<span class="cm-operator">:</span> <span class="cm-variable">ENSG00000000003</span> <span class="cm-variable">ENSG00000000005</span> <span class="cm-keyword">...</span> <span class="cm-variable">LRG_98</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">LRG_99</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rowData</span> <span class="cm-variable">names</span>(<span class="cm-number">0</span>)<span class="cm-operator">:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-number">8</span>)<span class="cm-operator">:</span> <span class="cm-variable">SRR1039508</span> <span class="cm-variable">SRR1039509</span> <span class="cm-keyword">...</span> <span class="cm-variable">SRR1039520</span> <span class="cm-variable">SRR1039521</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colData</span> <span class="cm-variable">names</span>(<span class="cm-number">9</span>)<span class="cm-operator">:</span> <span class="cm-variable">SampleName</span> <span class="cm-variable">cell</span> <span class="cm-keyword">...</span> <span class="cm-variable">Sample</span> <span class="cm-variable">BioSample</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># airway为表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># assay() 从SummarizedExperiment对象中提取数据矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">assay</span>(<span class="cm-variable">airway</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">SRR1039508</span> <span class="cm-variable">SRR1039509</span> <span class="cm-variable">SRR1039512</span> <span class="cm-variable">SRR1039513</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000003</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">679</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">448</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">873</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">408</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000005</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000419</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">467</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">515</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">621</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">365</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000457</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">260</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">211</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">263</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">164</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000460</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">60</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">55</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">40</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">35</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000938</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">SRR1039516</span> <span class="cm-variable">SRR1039517</span> <span class="cm-variable">SRR1039520</span> <span class="cm-variable">SRR1039521</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000003</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1138</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1047</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">770</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">572</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000005</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000419</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">587</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">799</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">417</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">508</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000457</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">245</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">331</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">233</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">229</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000460</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">78</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">63</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">76</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000000938</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">64102</span> &nbsp; &nbsp; <span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 样本之间的相关性（行为基因，列为样本）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取检索列数据 colData(airway)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colData</span>(<span class="cm-variable">airway</span>)[,<span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">t</span>(<span class="cm-variable">g</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">SRR1039508</span> <span class="cm-variable">SRR1039509</span> <span class="cm-variable">SRR1039512</span> <span class="cm-variable">SRR1039513</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group_list</span> <span class="cm-string">"untrt"</span> &nbsp; &nbsp;<span class="cm-string">"trt"</span> &nbsp; &nbsp; &nbsp;<span class="cm-string">"untrt"</span> &nbsp; &nbsp;<span class="cm-string">"trt"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">SRR1039516</span> <span class="cm-variable">SRR1039517</span> <span class="cm-variable">SRR1039520</span> <span class="cm-variable">SRR1039521</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group_list</span> <span class="cm-string">"untrt"</span> &nbsp; &nbsp;<span class="cm-string">"trt"</span> &nbsp; &nbsp; &nbsp;<span class="cm-string">"untrt"</span> &nbsp; &nbsp;<span class="cm-string">"trt"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">group_list</span> <span class="cm-operator">=</span> <span class="cm-variable">g</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">g</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 绘制热图（添加注释分组）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pheatmap</span><span class="cm-operator">::</span><span class="cm-variable">pheatmap</span>(<span class="cm-variable">cor</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">annotation_col</span> <span class="cm-operator">=</span> <span class="cm-variable">g</span>,<span class="cm-variable">filename</span> <span class="cm-operator">=</span> <span class="cm-string">"d:/1.png"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 以上数据需要进行筛选</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 删除存在5个以上小于0的行（基因）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>, <span class="cm-number">1</span>, <span class="cm-keyword">function</span>(<span class="cm-variable">x</span>) <span class="cm-variable">sum</span>(<span class="cm-variable">x</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">5</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">19481</span> &nbsp; &nbsp; <span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 进行标准化，因为可能存在0，因此+1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># cpm() 进行归一化</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">log</span>(<span class="cm-variable">edgeR</span><span class="cm-operator">::</span><span class="cm-variable">cpm</span>(<span class="cm-variable">experSet</span>)<span class="cm-operator">+</span><span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 取出前500个变化最大的基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">names</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>, <span class="cm-number">1</span>, <span class="cm-variable">mad</span>),<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>))[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">500</span>],]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">500</span> &nbsp; <span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 计算样本(列)之间的相关系数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">M</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">cor</span>(<span class="cm-variable">log2</span>(<span class="cm-variable">experSet</span><span class="cm-operator">+</span><span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pheatmap</span><span class="cm-operator">::</span><span class="cm-variable">pheatmap</span>(<span class="cm-variable">M</span>,<span class="cm-variable">annotation_col</span> <span class="cm-operator">=</span> <span class="cm-variable">g</span>,<span class="cm-variable">filename</span> <span class="cm-operator">=</span> <span class="cm-string">"d:/2.png"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1612px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1612px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\014.png" referrerpolicy="no-referrer" alt="014"></th><th><img src="img\004_生信人应该这样学R语言\015.png" referrerpolicy="no-referrer" alt="015"></th></tr></thead><tbody></tbody></table></figure><h2 id='十一芯片表达矩阵下游分析'><span>十一、芯片表达矩阵下游分析</span></h2><ul><li><span>使用limma包分析芯片数据</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 芯片的表达矩阵</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 不输出加载包过程的信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">suppressPackageStartupMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">CLL</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span>(<span class="cm-string">"sCLLex"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sCLLex</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ExpressionSet</span> (<span class="cm-variable">storageMode</span><span class="cm-operator">:</span> <span class="cm-variable">lockedEnvironment</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">assayData</span><span class="cm-operator">:</span> <span class="cm-number">12625</span> <span class="cm-variable">features</span>, <span class="cm-number">22</span> <span class="cm-variable">samples</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">element</span> <span class="cm-variable">names</span><span class="cm-operator">:</span> <span class="cm-variable">exprs</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">protocolData</span><span class="cm-operator">:</span> <span class="cm-variable">none</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenoData</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">sampleNames</span><span class="cm-operator">:</span> <span class="cm-variable">CLL11.CEL</span> <span class="cm-variable">CLL12.CEL</span> <span class="cm-keyword">...</span> <span class="cm-variable">CLL9.CEL</span> (<span class="cm-number">22</span> <span class="cm-variable">total</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">varLabels</span><span class="cm-operator">:</span> <span class="cm-variable">SampleID</span> <span class="cm-variable">Disease</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">varMetadata</span><span class="cm-operator">:</span> <span class="cm-variable">labelDescription</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">featureData</span><span class="cm-operator">:</span> <span class="cm-variable">none</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experimentData</span><span class="cm-operator">:</span> <span class="cm-variable">use</span> <span class="cm-string">'experimentData(object)'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Annotation</span><span class="cm-operator">:</span> <span class="cm-variable">hgu95av2</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 提取ExpressionSet对象的基因表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">12625</span> &nbsp; &nbsp;<span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取样本名（列）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">samples</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sampleNames</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取样本的信息（列）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pdata</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pData</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">pdata</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">SampleID</span> &nbsp;<span class="cm-variable">Disease</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL11.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL11</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL12.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL12</span> &nbsp; <span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL13.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL13</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取样本的分组信息（第2列）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">pdata</span>[,<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 抑制警告信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">suppressMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">limma</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 设计矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 每一行为一个样本，同时1表示属于该组，0表示不属于</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">design</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">model.matrix</span>(<span class="cm-operator">~</span><span class="cm-number">0</span><span class="cm-operator">+</span><span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">factor</span>(<span class="cm-variable">group</span>)<span class="cm-variable">progres.</span> <span class="cm-variable">factor</span>(<span class="cm-variable">group</span>)<span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">levels</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">progres.</span> <span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL11.CEL</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL12.CEL</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL13.CEL</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL14.CEL</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 比较矩阵：哪个与哪个之间进行比较</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">contrast.matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">makeContrasts</span>(<span class="cm-variable">paste</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">group</span>),<span class="cm-variable">collapse</span> <span class="cm-operator">=</span> <span class="cm-string">"-"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">contrast.matrix</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Contrasts</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Levels</span> &nbsp; &nbsp; <span class="cm-variable">progres.</span><span class="cm-operator">-</span><span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">progres.</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">stable</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 差异分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 构建线性模型并对其进行拟合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lmFit</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 统计数据分析中用于比较和检查数据组之间差异的函数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">contrasts.fit</span>(<span class="cm-variable">fit1</span>,<span class="cm-variable">contrast.matrix</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 进行贝叶斯检验</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit3</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">eBayes</span>(<span class="cm-variable">fit2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 提取出全部的差异表达基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">tempOutput</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">topTable</span>(<span class="cm-variable">fit3</span>,<span class="cm-variable">coef</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">n</span> <span class="cm-operator">=</span> <span class="cm-atom">Inf</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">nrDEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">na.omit</span>(<span class="cm-variable">tempOutput</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">logFC</span> &nbsp;<span class="cm-variable">AveExpr</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">P.Value</span> &nbsp;<span class="cm-variable">adj.P.Val</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">B</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">39400</span>_<span class="cm-variable">at</span> <span class="cm-operator">-</span><span class="cm-number">1.0284628</span> <span class="cm-number">5.620700</span> <span class="cm-operator">-</span><span class="cm-number">5.835799</span> <span class="cm-number">8.340576e-06</span> <span class="cm-number">0.03344118</span> <span class="cm-number">3.233915</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">36131</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-number">0.9888221</span> <span class="cm-number">9.954273</span> &nbsp;<span class="cm-number">5.771526</span> <span class="cm-number">9.667514e-06</span> <span class="cm-number">0.03344118</span> <span class="cm-number">3.116707</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">33791</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-number">1.8301554</span> <span class="cm-number">6.950685</span> &nbsp;<span class="cm-number">5.736161</span> <span class="cm-number">1.048765e-05</span> <span class="cm-number">0.03344118</span> <span class="cm-number">3.051940</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1303</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">1.3835699</span> <span class="cm-number">4.463438</span> <span class="cm-operator">-</span><span class="cm-number">5.731733</span> <span class="cm-number">1.059523e-05</span> <span class="cm-number">0.03344118</span> <span class="cm-number">3.043816</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">36122</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-number">0.7801404</span> <span class="cm-number">7.259612</span> &nbsp;<span class="cm-number">5.141064</span> <span class="cm-number">4.205709e-05</span> <span class="cm-number">0.10619415</span> <span class="cm-number">1.934581</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">36939</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-number">2.5471980</span> <span class="cm-number">6.915045</span> &nbsp;<span class="cm-number">5.038301</span> <span class="cm-number">5.362353e-05</span> <span class="cm-number">0.11283285</span> <span class="cm-number">1.736846</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1976px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1976px;"></div></div></div></pre><h2 id='十二rna-seq表达矩阵差异分析'><span>十二、RNA-seq表达矩阵差异分析</span></h2><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">airway</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span>(<span class="cm-string">"airway"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">assay</span>(<span class="cm-variable">airway</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colData</span>(<span class="cm-variable">airway</span>)[,<span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 数据需要进行筛选</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>, <span class="cm-number">1</span>, <span class="cm-keyword">function</span>(<span class="cm-variable">x</span>) <span class="cm-variable">sum</span>(<span class="cm-variable">x</span> <span class="cm-operator">&gt;</span> <span class="cm-number">1</span>) <span class="cm-operator">&gt;</span> <span class="cm-number">5</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 差异分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 方法1；DESeq2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">DESeq2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colData</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">row.names</span> <span class="cm-operator">=</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">grpup</span> <span class="cm-operator">=</span> <span class="cm-variable">g</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">colData</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">grpup</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SRR1039508</span> <span class="cm-variable">untrt</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SRR1039509</span> &nbsp; <span class="cm-variable">trt</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SRR1039512</span> <span class="cm-variable">untrt</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 构造DESeqDataSet对象</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dds</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">DESeqDataSetFromMatrix</span>(<span class="cm-variable">countData</span> <span class="cm-operator">=</span> <span class="cm-variable">experSet</span>,<span class="cm-variable">colData</span> <span class="cm-operator">=</span> <span class="cm-variable">colData</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">design</span> <span class="cm-operator">=</span> <span class="cm-operator">~</span> <span class="cm-variable">grpup</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 差异分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dds</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">DESeq</span>(<span class="cm-variable">dds</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">estimating</span> <span class="cm-variable">size</span> <span class="cm-variable">factors</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">estimating</span> <span class="cm-variable">dispersions</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gene</span><span class="cm-operator">-</span><span class="cm-variable">wise</span> <span class="cm-variable">dispersion</span> <span class="cm-variable">estimates</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">mean</span><span class="cm-operator">-</span><span class="cm-variable">dispersion</span> <span class="cm-variable">relationship</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">final</span> <span class="cm-variable">dispersion</span> <span class="cm-variable">estimates</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fitting</span> <span class="cm-variable">model</span> <span class="cm-variable">and</span> <span class="cm-variable">testing</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 提取结果</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">res</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">results</span>(<span class="cm-variable">dds</span>,<span class="cm-variable">contrast</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"grpup"</span>,<span class="cm-string">"trt"</span>,<span class="cm-string">"untrt"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">resOrdered</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">res</span>[<span class="cm-variable">order</span>(<span class="cm-variable">res</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">padj</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">resOrdered</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">log2</span> <span class="cm-variable">fold</span> <span class="cm-variable">change</span> (<span class="cm-variable">MLE</span>)<span class="cm-operator">:</span> <span class="cm-variable">grpup</span> <span class="cm-variable">trt</span> <span class="cm-variable">vs</span> <span class="cm-variable">untrt</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Wald</span> <span class="cm-variable">test</span> <span class="cm-variable">p</span><span class="cm-operator">-</span><span class="cm-variable">value</span><span class="cm-operator">:</span> <span class="cm-variable">grpup</span> <span class="cm-variable">trt</span> <span class="cm-variable">vs</span> <span class="cm-variable">untrt</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DataFrame</span> <span class="cm-variable">with</span> <span class="cm-number">6</span> <span class="cm-variable">rows</span> <span class="cm-variable">and</span> <span class="cm-number">6</span> <span class="cm-variable">columns</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">baseMean</span> <span class="cm-variable">log2FoldChange</span> &nbsp; &nbsp; <span class="cm-variable">lfcSE</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">stat</span> &nbsp; &nbsp; &nbsp; <span class="cm-variable">pvalue</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">padj</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span> <span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span> &nbsp; &nbsp;<span class="cm-operator">&lt;</span><span class="cm-variable">numeric</span><span class="cm-operator">&gt;</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000152583</span> &nbsp; <span class="cm-number">996.972</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">4.60142</span> <span class="cm-number">0.2116447</span> &nbsp; <span class="cm-number">21.7413</span> <span class="cm-number">8.35583e-105</span> <span class="cm-number">1.43545e-100</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000148175</span> <span class="cm-number">11190.810</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.45047</span> <span class="cm-number">0.0826057</span> &nbsp; <span class="cm-number">17.5589</span> &nbsp;<span class="cm-number">5.08500e-69</span> &nbsp;<span class="cm-number">4.36776e-65</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000179094</span> &nbsp; <span class="cm-number">776.285</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">3.18278</span> <span class="cm-number">0.2013570</span> &nbsp; <span class="cm-number">15.8066</span> &nbsp;<span class="cm-number">2.80013e-56</span> &nbsp;<span class="cm-number">1.60345e-52</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000134686</span> &nbsp;<span class="cm-number">2737.360</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1.38614</span> <span class="cm-number">0.0897854</span> &nbsp; <span class="cm-number">15.4384</span> &nbsp;<span class="cm-number">9.03299e-54</span> &nbsp;<span class="cm-number">3.87944e-50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000125148</span> &nbsp;<span class="cm-number">3655.103</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2.20251</span> <span class="cm-number">0.1464518</span> &nbsp; <span class="cm-number">15.0391</span> &nbsp;<span class="cm-number">4.06992e-51</span> &nbsp;<span class="cm-number">1.39834e-47</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000120129</span> &nbsp;<span class="cm-number">3407.726</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">2.94796</span> <span class="cm-number">0.2016156</span> &nbsp; <span class="cm-number">14.6217</span> &nbsp;<span class="cm-number">2.04286e-48</span> &nbsp;<span class="cm-number">5.84905e-45</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">DEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">resOrdered</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">DESeq2_DEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">na.omit</span>(<span class="cm-variable">DEG</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">nrDEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">DESeq2_DEG</span>[,<span class="cm-variable">c</span>(<span class="cm-number">2</span>,<span class="cm-number">6</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">nrDEG</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"log2FC"</span>,<span class="cm-string">"pvalue"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">log2FC</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">pvalue</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000152583</span> <span class="cm-number">4.601423</span> <span class="cm-number">1.435447e-100</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000148175</span> <span class="cm-number">1.450466</span> &nbsp;<span class="cm-number">4.367765e-65</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000179094</span> <span class="cm-number">3.182778</span> &nbsp;<span class="cm-number">1.603448e-52</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000134686</span> <span class="cm-number">1.386142</span> &nbsp;<span class="cm-number">3.879444e-50</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000125148</span> <span class="cm-number">2.202505</span> &nbsp;<span class="cm-number">1.398343e-47</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ENSG00000120129</span> <span class="cm-number">2.947959</span> &nbsp;<span class="cm-number">5.849048e-45</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1430px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1430px;"></div></div></div></pre><h2 id='十三r语言小作业'><span>十三、R语言小作业</span></h2><ul><li><a href='http://www.bio-info-trainee.com/3750.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3750.html</a></li></ul><ol start='' ><li><span>ID转换：根据R包</span><code>org.Hs.eg.db</code><span>找到下面ensembl 基因ID 对应的基因名(symbol)</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 读取ID转换的包</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">org.Hs.eg.db</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g2symble</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">org.Hs.egSYMBOL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g2ensembl</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">org.Hs.egENSEMBL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-keyword">if</span>(<span class="cm-variable">F</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">head</span>(<span class="cm-variable">g2symble</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">head</span>(<span class="cm-variable">g2ensembl</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"ENSG00000000003.13"</span>,<span class="cm-string">"ENSG00000000005.5"</span>,<span class="cm-string">"ENSG00000000419.11"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"ENSG00000000457.12"</span>,<span class="cm-string">"ENSG00000000460.15"</span>,<span class="cm-string">"ENSG00000000938.11"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">stringr</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取基因ID</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneID</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">unlist</span>(<span class="cm-variable">str_split</span>(<span class="cm-variable">genes</span>,<span class="cm-string">"</span><span class="cm-string-2">\\</span><span class="cm-string">."</span>))[<span class="cm-variable">seq</span>(<span class="cm-number">1</span>,<span class="cm-number">12</span>,<span class="cm-number">2</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneID</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"ENSG00000000003"</span> <span class="cm-string">"ENSG00000000005"</span> <span class="cm-string">"ENSG00000000419"</span> <span class="cm-string">"ENSG00000000457"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">5</span>] <span class="cm-string">"ENSG00000000460"</span> <span class="cm-string">"ENSG00000000938"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneID</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">ensembl_id</span> <span class="cm-operator">=</span> <span class="cm-variable">geneID</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ensIDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">geneID</span>,<span class="cm-variable">g2ensembl</span>,<span class="cm-variable">by</span><span class="cm-operator">=</span><span class="cm-string">"ensembl_id"</span>,<span class="cm-variable">all.x</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ensIDs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">ensembl_id</span> <span class="cm-variable">gene_id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-variable">ENSG00000000003</span> &nbsp; &nbsp;<span class="cm-number">7105</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> <span class="cm-variable">ENSG00000000005</span> &nbsp; <span class="cm-number">64102</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-variable">ENSG00000000419</span> &nbsp; &nbsp;<span class="cm-number">8813</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> <span class="cm-variable">ENSG00000000457</span> &nbsp; <span class="cm-number">57147</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> <span class="cm-variable">ENSG00000000460</span> &nbsp; <span class="cm-number">55732</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> <span class="cm-variable">ENSG00000000938</span> &nbsp; &nbsp;<span class="cm-number">2268</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneIDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">ensIDs</span>,<span class="cm-variable">g2symble</span>,<span class="cm-variable">by</span><span class="cm-operator">=</span><span class="cm-string">"gene_id"</span>,<span class="cm-variable">all.x</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">geneIDs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">gene_id</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">ensembl_id</span> &nbsp; <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;<span class="cm-number">2268</span> <span class="cm-variable">ENSG00000000938</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">FGR</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-number">55732</span> <span class="cm-variable">ENSG00000000460</span> <span class="cm-variable">C1orf112</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; <span class="cm-number">57147</span> <span class="cm-variable">ENSG00000000457</span> &nbsp; &nbsp;<span class="cm-variable">SCYL3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; <span class="cm-number">64102</span> <span class="cm-variable">ENSG00000000005</span> &nbsp; &nbsp; <span class="cm-variable">TNMD</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;<span class="cm-number">7105</span> <span class="cm-variable">ENSG00000000003</span> &nbsp; <span class="cm-variable">TSPAN6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; &nbsp;<span class="cm-number">8813</span> <span class="cm-variable">ENSG00000000419</span> &nbsp; &nbsp; <span class="cm-variable">DPM1</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 910px;"></div><div class="CodeMirror-gutters" style="display: none; height: 910px;"></div></div></div></pre><ol start='2' ><li><span>探针名字：根据R包</span><code>hgu133a.db</code><span>找到下面探针对应的基因名(symbol)</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 第二题</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">hgu133a.db</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">IDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">hgu133aSYMBOL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">IDs</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">probe_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-number">1007</span>_<span class="cm-variable">s_at</span> &nbsp; <span class="cm-variable">DDR1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-number">1053</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">RFC2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp;<span class="cm-number">117</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">HSPA6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp;<span class="cm-number">121</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">PAX8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> <span class="cm-number">1255</span>_<span class="cm-variable">g_at</span> <span class="cm-variable">GUCA1A</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-number">1294</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">UBA7</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">probes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"1053_at"</span>,<span class="cm-string">"117_at"</span>,<span class="cm-string">"121_at"</span>,<span class="cm-string">"1255_g_at"</span>,<span class="cm-string">"1316_at"</span>,<span class="cm-string">"1320_at"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"1405_i_at"</span>,<span class="cm-string">"1431_at"</span>,<span class="cm-string">"1438_at"</span>,<span class="cm-string">"1487_at"</span>,<span class="cm-string">"1494_f_at"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"1598_g_at"</span>,<span class="cm-string">"160020_at"</span>,<span class="cm-string">"1729_at"</span>,<span class="cm-string">"177_at"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">probes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">probe_id</span> <span class="cm-operator">=</span> <span class="cm-variable">probes</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">probes</span>,<span class="cm-variable">IDs</span>,<span class="cm-variable">by</span> <span class="cm-operator">=</span> <span class="cm-string">"probe_id"</span>,<span class="cm-variable">all.x</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">probe_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp;<span class="cm-number">1053</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">RFC2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; <span class="cm-number">117</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">HSPA6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; <span class="cm-number">121</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">PAX8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp;<span class="cm-number">1255</span>_<span class="cm-variable">g_at</span> <span class="cm-variable">GUCA1A</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; &nbsp;<span class="cm-number">1316</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">THRA</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; &nbsp;<span class="cm-number">1320</span>_<span class="cm-variable">at</span> <span class="cm-variable">PTPN21</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7</span> &nbsp;<span class="cm-number">1405</span>_<span class="cm-variable">i_at</span> &nbsp; <span class="cm-variable">CCL5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8</span> &nbsp; &nbsp;<span class="cm-number">1431</span>_<span class="cm-variable">at</span> <span class="cm-variable">CYP2E1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">9</span> &nbsp; &nbsp;<span class="cm-number">1438</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">EPHB3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">10</span> &nbsp; <span class="cm-number">1487</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">ESRRA</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">11</span> <span class="cm-number">1494</span>_<span class="cm-variable">f_at</span> <span class="cm-variable">CYP2A6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">12</span> <span class="cm-number">1598</span>_<span class="cm-variable">g_at</span> &nbsp; <span class="cm-variable">GAS6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">13</span> <span class="cm-number">160020</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">MMP14</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">14</span> &nbsp; <span class="cm-number">1729</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">TRADD</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">15</span> &nbsp; &nbsp;<span class="cm-number">177</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">PLD1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 或 找出对应的下标</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># match(probes$probe_id,IDs$probe_id)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 910px;"></div><div class="CodeMirror-gutters" style="display: none; height: 910px;"></div></div></div></pre><ol start='3' ><li><span>找到R包</span><code>CLL</code><span>内置的数据集的表达矩阵里面的TP53基因的表达量，并且绘制在 </span><code>progres.-stable</code><span>分组的boxplot图</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 第三题</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">suppressPackageStartupMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">CLL</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span>(<span class="cm-string">"sCLLex"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># sCLLex</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL11.CEL</span> <span class="cm-variable">CLL12.CEL</span> <span class="cm-variable">CLL13.CEL</span> <span class="cm-variable">CLL14.CEL</span> <span class="cm-variable">CLL15.CEL</span> <span class="cm-variable">CLL16.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">5.743132</span> &nbsp;<span class="cm-number">6.219412</span> &nbsp;<span class="cm-number">5.523328</span> &nbsp;<span class="cm-number">5.340477</span> &nbsp;<span class="cm-number">5.229904</span> &nbsp;<span class="cm-number">4.920686</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">2.285143</span> &nbsp;<span class="cm-number">2.291229</span> &nbsp;<span class="cm-number">2.287986</span> &nbsp;<span class="cm-number">2.295313</span> &nbsp;<span class="cm-number">2.662170</span> &nbsp;<span class="cm-number">2.278040</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> &nbsp;<span class="cm-number">3.309294</span> &nbsp;<span class="cm-number">3.318466</span> &nbsp;<span class="cm-number">3.354423</span> &nbsp;<span class="cm-number">3.327130</span> &nbsp;<span class="cm-number">3.365113</span> &nbsp;<span class="cm-number">3.568353</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL17.CEL</span> <span class="cm-variable">CLL18.CEL</span> <span class="cm-variable">CLL19.CEL</span> <span class="cm-variable">CLL20.CEL</span> <span class="cm-variable">CLL21.CEL</span> <span class="cm-variable">CLL22.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">5.325348</span> &nbsp;<span class="cm-number">4.826131</span> &nbsp;<span class="cm-number">5.212387</span> &nbsp;<span class="cm-number">5.285830</span> &nbsp;<span class="cm-number">5.581859</span> &nbsp;<span class="cm-number">6.251678</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">2.350796</span> &nbsp;<span class="cm-number">2.325163</span> &nbsp;<span class="cm-number">2.432635</span> &nbsp;<span class="cm-number">2.256547</span> &nbsp;<span class="cm-number">2.348389</span> &nbsp;<span class="cm-number">2.263849</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> &nbsp;<span class="cm-number">3.502440</span> &nbsp;<span class="cm-number">3.394410</span> &nbsp;<span class="cm-number">3.617099</span> &nbsp;<span class="cm-number">3.279726</span> &nbsp;<span class="cm-number">3.391734</span> &nbsp;<span class="cm-number">3.306811</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL23.CEL</span> <span class="cm-variable">CLL24.CEL</span> <span class="cm-variable">CLL2.CEL</span> <span class="cm-variable">CLL3.CEL</span> <span class="cm-variable">CLL4.CEL</span> <span class="cm-variable">CLL5.CEL</span> <span class="cm-variable">CLL6.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">5.480752</span> &nbsp;<span class="cm-number">5.216033</span> <span class="cm-number">5.966942</span> <span class="cm-number">5.397508</span> <span class="cm-number">5.281720</span> <span class="cm-number">5.414718</span> <span class="cm-number">5.460626</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">2.264434</span> &nbsp;<span class="cm-number">2.344079</span> <span class="cm-number">2.350073</span> <span class="cm-number">2.406846</span> <span class="cm-number">2.341961</span> <span class="cm-number">2.372928</span> <span class="cm-number">2.356978</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> &nbsp;<span class="cm-number">3.341444</span> &nbsp;<span class="cm-number">3.798335</span> <span class="cm-number">3.427736</span> <span class="cm-number">3.453564</span> <span class="cm-number">3.412944</span> <span class="cm-number">3.411922</span> <span class="cm-number">3.396466</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL7.CEL</span> <span class="cm-variable">CLL8.CEL</span> <span class="cm-variable">CLL9.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-number">5.897821</span> <span class="cm-number">5.253883</span> <span class="cm-number">5.214155</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-number">2.222276</span> <span class="cm-number">2.254772</span> <span class="cm-number">2.358544</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> <span class="cm-number">3.247276</span> <span class="cm-number">3.255148</span> <span class="cm-number">3.365746</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 探针的分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pdata</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pData</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">pdata</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">SampleID</span> &nbsp;<span class="cm-variable">Disease</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL11.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL11</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL12.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL12</span> &nbsp; <span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL13.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL13</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 找到探针对应的基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">hgu95av2.db</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">g2symbl</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">hgu95av2SYMBOL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">g2symbl</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">probe_id</span> &nbsp;<span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">MAPK3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-variable">TIE1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> <span class="cm-variable">CYP2C19</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">g2symbl</span>[<span class="cm-variable">g2symbl</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span> <span class="cm-operator">==</span> <span class="cm-string">"TP53"</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">probe_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">987</span> &nbsp; &nbsp;<span class="cm-number">1939</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1019</span> <span class="cm-number">1974</span>_<span class="cm-variable">s_at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1459</span> &nbsp;<span class="cm-number">31618</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">cbind</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">pid</span> <span class="cm-operator">=</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experTP53</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">genes</span>,<span class="cm-variable">experSet</span>,<span class="cm-variable">by.x</span> <span class="cm-operator">=</span> <span class="cm-string">"probe_id"</span>,<span class="cm-variable">by.y</span> <span class="cm-operator">=</span> <span class="cm-string">"pid"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">eTP53</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.matrix</span>(<span class="cm-variable">experTP53</span>[<span class="cm-operator">-</span><span class="cm-variable">c</span>(<span class="cm-number">1</span>,<span class="cm-number">2</span>)])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 将字符串矩阵转为数值型矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">mode</span>(<span class="cm-variable">eTP53</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"numeric"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">apply</span>(<span class="cm-variable">eTP53</span>, <span class="cm-number">1</span>, <span class="cm-keyword">function</span>(<span class="cm-variable">x</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">boxplot</span>(<span class="cm-variable">x</span><span class="cm-operator">~</span><span class="cm-variable">pdata</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Disease</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> })</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1326px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1326px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\016.png" referrerpolicy="no-referrer" alt="016"></th><th><img src="img\004_生信人应该这样学R语言\017.png" referrerpolicy="no-referrer" alt="017"></th><th><img src="img\004_生信人应该这样学R语言\018.png" referrerpolicy="no-referrer" alt="018"></th></tr></thead><tbody></tbody></table></figure><ol start='4' ><li><span>找到BRCA1基因在TCGA数据库的乳腺癌数据集(</span><a href='http://www.cbioportal.org/study?id=brca_tcga_pan_can_atlas_2018'><span>Breast Invasive Carcinoma (TCGA, PanCancer Atlas)</span></a><span>)的表达情况。</span></li></ol><ul><li><span>打开</span><a href='http://www.cbioportal.org/' target='_blank' class='url'>http://www.cbioportal.org/</a><span>，在左边找到</span><strong><span>Breast</span></strong><span>，之后右边找到</span><strong><span>Breast Invasive Carcinoma (TCGA, PanCancer Atlas)</span></strong><span>，输入</span><strong><span>BRCA1</span></strong><span>搜索，在</span><strong><span>plot</span></strong><span>中的左边选择</span><strong><span>Clinical Attribute</span></strong><span>，</span><strong><span>Subtype</span></strong><span>，再下载数据。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/plot作业.txt"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">f</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">data</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"id"</span>,<span class="cm-string">"subtype"</span>,<span class="cm-string">"expression"</span>,<span class="cm-string">"mut"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggstatsplot</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggbetweenstats</span>(<span class="cm-variable">data</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">subtype</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">expression</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Error</span> <span class="cm-keyword">in</span> <span class="cm-variable-3">`select()`</span><span class="cm-operator">:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">!</span> <span class="cm-variable">Names</span> <span class="cm-variable">must</span> <span class="cm-variable">be</span> <span class="cm-variable">unique.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">✖ <span class="cm-variable">These</span> <span class="cm-variable">names</span> <span class="cm-variable">are</span> <span class="cm-variable">duplicated</span><span class="cm-operator">:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-operator">*</span> <span class="cm-string">"expression"</span> <span class="cm-variable">at</span> <span class="cm-variable">locations</span> <span class="cm-number">2</span> <span class="cm-variable">and</span> <span class="cm-number">11</span><span class="cm-variable">.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Run</span> <span class="cm-variable-3">`rlang::last_trace()`</span> <span class="cm-variable">to</span> <span class="cm-variable">see</span> <span class="cm-variable">where</span> <span class="cm-variable">the</span> <span class="cm-variable">error</span> <span class="cm-variable">occurred.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ggsave</span>(<span class="cm-string">"d:/plot.png"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Saving</span> <span class="cm-number">3.24</span> <span class="cm-variable">x</span> <span class="cm-number">2.55</span> <span class="cm-keyword">in</span> <span class="cm-variable">image</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 364px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\019 .png" alt="019 " style="zoom: 33%;" /></p><ol start='5' ><li><span>找到TP53基因在TCGA数据库的乳腺癌数据集的表达量分组看其是否影响生存</span></li></ol><ul><li><span>打开</span><a href='http://www.oncolnc.org/' target='_blank' class='url'>http://www.oncolnc.org/</a><span>，选择BRCA数据，分组为各50%，此时可以看到不显著（p=0.14），因此将数据下载到本地，对每个亚型进行分析，看每个亚型的显著性。</span></li><li><span>亚型使用上一题（第4题的数据），生存分析使用前面生存分析的代码。（函数的图形输出存在问题，如果单独一个一个输出则不存在问题。）</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/BRCA_7157_50_50.csv"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">f</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">","</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">data1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"Patient"</span> &nbsp; &nbsp;<span class="cm-string">"Days"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"Status"</span> &nbsp; &nbsp; <span class="cm-string">"Expression"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">5</span>] <span class="cm-string">"Group"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data1</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">Patient</span> <span class="cm-variable">Days</span> <span class="cm-variable">Status</span> <span class="cm-variable">Expression</span> <span class="cm-variable">Group</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">AR</span><span class="cm-operator">-</span><span class="cm-variable">A24H</span> <span class="cm-number">4894</span> &nbsp;<span class="cm-variable">Alive</span> &nbsp; &nbsp; <span class="cm-number">193.89</span> &nbsp; <span class="cm-variable">Low</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">A2</span><span class="cm-operator">-</span><span class="cm-variable">A0YE</span> &nbsp;<span class="cm-number">554</span> &nbsp;<span class="cm-variable">Alive</span> &nbsp; &nbsp; <span class="cm-number">198.99</span> &nbsp; <span class="cm-variable">Low</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">AN</span><span class="cm-operator">-</span><span class="cm-variable">A0FL</span> &nbsp;<span class="cm-number">231</span> &nbsp;<span class="cm-variable">Alive</span> &nbsp; &nbsp; <span class="cm-number">205.44</span> &nbsp; <span class="cm-variable">Low</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 亚型数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/plot作业.txt"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">read.table</span>(<span class="cm-variable">f</span>,<span class="cm-variable">sep</span> <span class="cm-operator">=</span> <span class="cm-string">"</span><span class="cm-string-2">\t</span><span class="cm-string">"</span>,<span class="cm-variable">header</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data2</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">data2</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">"Patient"</span>,<span class="cm-string">"subtype"</span>,<span class="cm-string">"expression"</span>,<span class="cm-string">"mut"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data2</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Patient</span> &nbsp; &nbsp;<span class="cm-variable">subtype</span> <span class="cm-variable">expression</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">mut</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">A1</span><span class="cm-operator">-</span><span class="cm-variable">A0SK</span><span class="cm-operator">-</span><span class="cm-number">01</span> <span class="cm-variable">BRCA_Basal</span> &nbsp; <span class="cm-number">1119.130</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">A1</span><span class="cm-operator">-</span><span class="cm-variable">A0SO</span><span class="cm-operator">-</span><span class="cm-number">01</span> <span class="cm-variable">BRCA_Basal</span> &nbsp; <span class="cm-number">1346.630</span> <span class="cm-variable">BRCA1</span><span class="cm-operator">:</span> <span class="cm-variable">X27_splice</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-variable">TCGA</span><span class="cm-operator">-</span><span class="cm-variable">A1</span><span class="cm-operator">-</span><span class="cm-variable">A0SP</span><span class="cm-operator">-</span><span class="cm-number">01</span> <span class="cm-variable">BRCA_Basal</span> &nbsp; &nbsp;<span class="cm-number">733.309</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">-</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 将亚型数据的最后3个字符删除 TCGA-A1-A0SK-01 -&gt; TCGA-A1-A0SK</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data2</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Patient</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">substring</span>(<span class="cm-variable">data2</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Patient</span>,<span class="cm-number">1</span>,<span class="cm-number">12</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 亚型合并</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">merge</span>(<span class="cm-variable">data1</span>,<span class="cm-variable">data2</span>,<span class="cm-variable">by</span> <span class="cm-operator">=</span> <span class="cm-string">"Patient"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 亚型种类</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">unique</span>(<span class="cm-variable">data</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">subtype</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"BRCA_LumA"</span> &nbsp; <span class="cm-string">"BRCA_Her2"</span> &nbsp; <span class="cm-string">"BRCA_LumB"</span> &nbsp; <span class="cm-string">"BRCA_Basal"</span> &nbsp;<span class="cm-string">"BRCA_Normal"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 生存分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">subtype_survival</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-keyword">function</span>(<span class="cm-variable">data</span>,<span class="cm-variable">t</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">d</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-variable">data</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">subtype</span> <span class="cm-operator">==</span> <span class="cm-variable">t</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">library</span>(<span class="cm-variable">survival</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">library</span>(<span class="cm-variable">survminer</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">d</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Status</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">d</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">Status</span> <span class="cm-operator">==</span> <span class="cm-string">"Dead"</span>,<span class="cm-number">1</span>,<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">sfit</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">survfit</span>(<span class="cm-variable">Surv</span>(<span class="cm-variable">Days</span>,<span class="cm-variable">Status</span>)<span class="cm-operator">~</span><span class="cm-variable">Group</span>,<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">d</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">ggsurvplot</span>(<span class="cm-variable">sfit</span>,<span class="cm-variable">conf.int</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">pval</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">ggsave</span>(<span class="cm-variable">paste0</span>(<span class="cm-string">"d://"</span>,<span class="cm-variable">t</span>,<span class="cm-string">".png"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-keyword">for</span>(<span class="cm-variable">t</span> <span class="cm-keyword">in</span> <span class="cm-variable">unique</span>(<span class="cm-variable">data</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">subtype</span>)){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">subtype_survival</span>(<span class="cm-variable">data</span>,<span class="cm-variable">t</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1092px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1092px;"></div></div></div></pre><ol start='6' ><li><p><span>下载数据集GSE17215的表达矩阵并且提取下面的基因画热图</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.7495px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ACTR3B ANLN BAG1 BCL2 BIRC5 BLVRA CCNB1 CCNE1 CDC20 CDC6 CDCA1 CDH3 CENPF CEP55 CXXC5 EGFR ERBB2 ESR1 EXO1 FGFR4 FOXA1 FOXC1 GPR160 GRB7 KIF2C KNTC2 KRT14 KRT17 KRT5 MAPT MDM2 MELK MIA MKI67 MLPH MMP11 MYBL2 MYC NAT1 ORC6L PGR PHGDH PTTG1 RRM2 SFRP1 SLC39A6 TMEM45B TYMS UBE2C UBE2T</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre></li></ol><ul><li><span>根据基因名拿到探针ID，缩小表达矩阵绘制热图，没有检查到的基因直接忽略即可。</span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 基因列表</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dir</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"作业6genes.txt"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">genes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">scan</span>(<span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-variable">f</span>),<span class="cm-variable">what</span> <span class="cm-operator">=</span> <span class="cm-string">""</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Read</span> <span class="cm-number">50</span> <span class="cm-variable">items</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 下载数据 GSE17215</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">GEOquery</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到dir，不下载注释文件和平台文件</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">gset</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">getGEO</span>(<span class="cm-string">"GSE17215"</span>,<span class="cm-variable">destdir</span> <span class="cm-operator">=</span> <span class="cm-variable">dir</span>,<span class="cm-variable">AnnotGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">getGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Found</span> <span class="cm-number">1</span> <span class="cm-variable">file</span>(<span class="cm-variable">s</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSE17215_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Using</span> <span class="cm-variable">locally</span> <span class="cm-variable">cached</span> <span class="cm-variable">version</span><span class="cm-operator">:</span> <span class="cm-variable">D</span><span class="cm-operator">:/</span>桌面文件<span class="cm-operator">/</span>文档<span class="cm-operator">/</span><span class="cm-variable">B</span>站生信视频<span class="cm-operator">/</span>代码<span class="cm-operator">/</span><span class="cm-number">004</span>_生信人应该这样学<span class="cm-variable">R</span>语言<span class="cm-operator">//</span><span class="cm-variable">GSE17215_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到本地</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">save</span>(<span class="cm-variable">gset</span>,<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-string">"GSE17215"</span>,<span class="cm-string">"_set.Rdata"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"list"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">gset</span>[[<span class="cm-number">1</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">22277</span> &nbsp; &nbsp; <span class="cm-number">6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM431121</span> <span class="cm-variable">GSM431122</span> &nbsp;<span class="cm-variable">GSM431123</span> &nbsp;<span class="cm-variable">GSM431124</span> &nbsp;<span class="cm-variable">GSM431125</span> &nbsp;<span class="cm-variable">GSM431126</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1007</span>_<span class="cm-variable">s_at</span> <span class="cm-number">481.59980</span> <span class="cm-number">596.79062</span> <span class="cm-number">2721.83475</span> <span class="cm-number">2566.31563</span> <span class="cm-number">2737.76320</span> <span class="cm-number">2629.25380</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1053</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-number">306.82972</span> <span class="cm-number">224.97956</span> &nbsp;<span class="cm-number">246.73288</span> &nbsp;<span class="cm-number">251.85537</span> &nbsp;<span class="cm-number">245.55677</span> &nbsp;<span class="cm-number">196.34917</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">117</span>_<span class="cm-variable">at</span> &nbsp; &nbsp; <span class="cm-number">30.32576</span> &nbsp;<span class="cm-number">27.28749</span> &nbsp; <span class="cm-number">40.12724</span> &nbsp; <span class="cm-number">40.04009</span> &nbsp; <span class="cm-number">48.14327</span> &nbsp; <span class="cm-number">37.57184</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 根据探针名获取基因的表达数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">hgu133a.db</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">IDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">hgu133aSYMBOL</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">IDs</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">probe_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> <span class="cm-number">1007</span>_<span class="cm-variable">s_at</span> &nbsp; <span class="cm-variable">DDR1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-number">1053</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">RFC2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp;<span class="cm-number">117</span>_<span class="cm-variable">at</span> &nbsp;<span class="cm-variable">HSPA6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取探针存在的数据</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">median</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">apply</span>(<span class="cm-variable">data</span>,<span class="cm-number">1</span>,<span class="cm-variable">median</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">IDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">IDs</span>[<span class="cm-variable">order</span>(<span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>,<span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">median</span>,<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">IDs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">IDs</span>[<span class="cm-operator">!</span><span class="cm-variable">duplicated</span>(<span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">data</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">IDs</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">12643</span> &nbsp; &nbsp; <span class="cm-number">6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM431121</span> <span class="cm-variable">GSM431122</span> <span class="cm-variable">GSM431123</span> <span class="cm-variable">GSM431124</span> <span class="cm-variable">GSM431125</span> <span class="cm-variable">GSM431126</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ZZZ3</span> &nbsp; <span class="cm-number">370.1447</span> &nbsp;<span class="cm-number">464.4501</span> &nbsp;<span class="cm-number">335.6289</span> &nbsp;<span class="cm-number">311.3865</span> &nbsp;<span class="cm-number">314.7970</span> &nbsp;<span class="cm-number">328.9541</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ZZEF1</span> &nbsp;<span class="cm-number">177.7949</span> &nbsp;<span class="cm-number">137.7390</span> &nbsp;<span class="cm-number">177.7949</span> &nbsp;<span class="cm-number">177.7949</span> &nbsp;<span class="cm-number">177.7949</span> &nbsp;<span class="cm-number">200.0675</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ZYX</span> &nbsp; &nbsp;<span class="cm-number">436.5056</span> &nbsp;<span class="cm-number">387.6072</span> &nbsp;<span class="cm-number">328.1560</span> &nbsp;<span class="cm-number">356.5430</span> &nbsp;<span class="cm-number">345.0436</span> &nbsp;<span class="cm-number">411.0501</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 找出基因列表中的基因的表达量</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">gs</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">genes</span>[<span class="cm-variable">genes</span> <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">data</span>)]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data</span>[<span class="cm-variable">gs</span>,])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM431121</span> &nbsp;<span class="cm-variable">GSM431122</span> <span class="cm-variable">GSM431123</span> <span class="cm-variable">GSM431124</span> <span class="cm-variable">GSM431125</span> &nbsp;<span class="cm-variable">GSM431126</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ACTR3B</span> &nbsp; <span class="cm-number">58.43318</span> &nbsp; <span class="cm-number">60.43871</span> &nbsp;<span class="cm-number">26.74878</span> &nbsp;<span class="cm-number">32.21635</span> &nbsp;<span class="cm-number">27.25648</span> &nbsp; <span class="cm-number">27.77857</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BAG1</span> &nbsp; &nbsp;<span class="cm-number">618.59556</span> &nbsp;<span class="cm-number">520.74185</span> <span class="cm-number">635.54973</span> <span class="cm-number">676.96582</span> <span class="cm-number">707.26231</span> &nbsp;<span class="cm-number">687.45477</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BCL2</span> &nbsp; &nbsp; <span class="cm-number">34.50058</span> &nbsp; <span class="cm-number">32.07779</span> &nbsp;<span class="cm-number">38.06001</span> &nbsp;<span class="cm-number">35.39904</span> &nbsp;<span class="cm-number">41.46653</span> &nbsp; <span class="cm-number">36.93124</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BIRC5</span> &nbsp; <span class="cm-number">132.65111</span> &nbsp;<span class="cm-number">812.73428</span> &nbsp;<span class="cm-number">40.36263</span> &nbsp;<span class="cm-number">44.48125</span> &nbsp;<span class="cm-number">39.71248</span> &nbsp; <span class="cm-number">37.38573</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BLVRA</span> &nbsp;<span class="cm-number">1929.39505</span> <span class="cm-number">2090.91921</span> <span class="cm-number">882.22809</span> <span class="cm-number">917.38422</span> <span class="cm-number">902.86123</span> <span class="cm-number">1056.76550</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CCNB1</span> &nbsp; <span class="cm-number">532.22206</span> <span class="cm-number">1574.74381</span> <span class="cm-number">305.45009</span> <span class="cm-number">382.58342</span> <span class="cm-number">302.87798</span> &nbsp;<span class="cm-number">282.26841</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">log2</span>(<span class="cm-variable">data</span>[<span class="cm-variable">gs</span>,])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 绘制热图，行进行标准化</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pheatmap</span><span class="cm-operator">::</span><span class="cm-variable">pheatmap</span>(<span class="cm-variable">data</span>,<span class="cm-variable">scale</span> <span class="cm-operator">=</span> <span class="cm-string">"row"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1664px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1664px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\020.png" alt="020" style="zoom: 50%;" /></p><ol start='7' ><li><span>下载数据集GSE24673的表达矩阵计算样本的相关性并且绘制热图，需要标记上样本分组信息</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dir</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 下载数据 GSE17215</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">GEOquery</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到dir，不下载注释文件和平台文件</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">gset</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">getGEO</span>(<span class="cm-string">"GSE24673"</span>,<span class="cm-variable">destdir</span> <span class="cm-operator">=</span> <span class="cm-variable">dir</span>,<span class="cm-variable">AnnotGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">getGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Found</span> <span class="cm-number">1</span> <span class="cm-variable">file</span>(<span class="cm-variable">s</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSE24673_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Using</span> <span class="cm-variable">locally</span> <span class="cm-variable">cached</span> <span class="cm-variable">version</span><span class="cm-operator">:</span> <span class="cm-variable">D</span><span class="cm-operator">:/</span>桌面文件<span class="cm-operator">/</span>文档<span class="cm-operator">/</span><span class="cm-variable">B</span>站生信视频<span class="cm-operator">/</span>代码<span class="cm-operator">/</span><span class="cm-number">004</span>_生信人应该这样学<span class="cm-variable">R</span>语言<span class="cm-operator">//</span><span class="cm-variable">GSE24673_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到本地</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">save</span>(<span class="cm-variable">gset</span>,<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-string">"GSE24673"</span>,<span class="cm-string">"_set.Rdata"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"list"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">exper</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">gset</span>[[<span class="cm-number">1</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">exper</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">28869</span> &nbsp; &nbsp;<span class="cm-number">11</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM607938</span> <span class="cm-variable">GSM607939</span> <span class="cm-variable">GSM607940</span> <span class="cm-variable">GSM607941</span> <span class="cm-variable">GSM607942</span> <span class="cm-variable">GSM607943</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896736</span> &nbsp; &nbsp; <span class="cm-number">6.231</span> &nbsp; &nbsp; <span class="cm-number">6.353</span> &nbsp; &nbsp; <span class="cm-number">6.702</span> &nbsp; &nbsp; <span class="cm-number">6.663</span> &nbsp; &nbsp; <span class="cm-number">7.000</span> &nbsp; &nbsp; <span class="cm-number">7.329</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896738</span> &nbsp; &nbsp; <span class="cm-number">6.607</span> &nbsp; &nbsp; <span class="cm-number">6.895</span> &nbsp; &nbsp; <span class="cm-number">6.856</span> &nbsp; &nbsp; <span class="cm-number">8.136</span> &nbsp; &nbsp; <span class="cm-number">8.048</span> &nbsp; &nbsp; <span class="cm-number">8.365</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896740</span> &nbsp; &nbsp; <span class="cm-number">7.191</span> &nbsp; &nbsp; <span class="cm-number">7.123</span> &nbsp; &nbsp; <span class="cm-number">7.196</span> &nbsp; &nbsp; <span class="cm-number">7.845</span> &nbsp; &nbsp; <span class="cm-number">7.756</span> &nbsp; &nbsp; <span class="cm-number">8.139</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM607944</span> <span class="cm-variable">GSM607945</span> <span class="cm-variable">GSM607946</span> <span class="cm-variable">GSM607947</span> <span class="cm-variable">GSM607948</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896736</span> &nbsp; &nbsp; <span class="cm-number">7.025</span> &nbsp; &nbsp; <span class="cm-number">6.111</span> &nbsp; &nbsp; <span class="cm-number">6.537</span> &nbsp; &nbsp; <span class="cm-number">6.143</span> &nbsp; &nbsp; <span class="cm-number">6.851</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896738</span> &nbsp; &nbsp; <span class="cm-number">5.517</span> &nbsp; &nbsp; <span class="cm-number">5.535</span> &nbsp; &nbsp; <span class="cm-number">5.591</span> &nbsp; &nbsp; <span class="cm-number">4.983</span> &nbsp; &nbsp; <span class="cm-number">5.728</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7896740</span> &nbsp; &nbsp; <span class="cm-number">6.123</span> &nbsp; &nbsp; <span class="cm-number">6.131</span> &nbsp; &nbsp; <span class="cm-number">6.071</span> &nbsp; &nbsp; <span class="cm-number">5.478</span> &nbsp; &nbsp; <span class="cm-number">6.330</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pdata</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pData</span>(<span class="cm-variable">exper</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">names</span>(<span class="cm-variable">pdata</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] <span class="cm-string">"title"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"geo_accession"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">3</span>] <span class="cm-string">"status"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"submission_date"</span> &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">......</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">m</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">cor</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">g</span> <span class="cm-operator">=</span> <span class="cm-variable">pdata</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">source_name_ch1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">group</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pheatmap</span><span class="cm-operator">::</span><span class="cm-variable">pheatmap</span>(<span class="cm-variable">m</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pheatmap</span><span class="cm-operator">::</span><span class="cm-variable">pheatmap</span>(<span class="cm-variable">m</span>,<span class="cm-variable">annotation_col</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1040px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1040px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\021.png" referrerpolicy="no-referrer" alt="021"></th><th><img src="img\004_生信人应该这样学R语言\022.png" referrerpolicy="no-referrer" alt="022"></th></tr></thead><tbody></tbody></table></figure><ol start='8' ><li><span>找到 GPL6244 platform of Affymetrix Human Gene 1.0 ST Array 对应的R的bioconductor注释包，并且安装它！</span></li></ol><ul><li><span>找GPL6244 对应的包名</span><a href='http://www.bio-info-trainee.com/3752.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3752.html</a><span>、</span><a href='http://www.bio-info-trainee.com/1399.html' target='_blank' class='url'>http://www.bio-info-trainee.com/1399.html</a></li><li><span>注释包都需要在后面添加</span><strong><code>.db</code></strong></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"hugene10sttranscriptcluster.db"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre><ol start='9' ><li><span>下载数据集GSE42872的表达矩阵，并且分别挑选出所有样本的(平均表达量/sd/mad/)最大的探针，并且找到它们对应的基因。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dir</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/"</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 下载数据 GSE42872</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">GEOquery</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到dir，不下载注释文件和平台文件</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">gset</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">getGEO</span>(<span class="cm-string">"GSE42872"</span>,<span class="cm-variable">destdir</span> <span class="cm-operator">=</span> <span class="cm-variable">dir</span>,<span class="cm-variable">AnnotGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">getGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Found</span> <span class="cm-number">1</span> <span class="cm-variable">file</span>(<span class="cm-variable">s</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSE42872_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Using</span> <span class="cm-variable">locally</span> <span class="cm-variable">cached</span> <span class="cm-variable">version</span><span class="cm-operator">:</span> <span class="cm-variable">D</span><span class="cm-operator">:/</span>桌面文件<span class="cm-operator">/</span>文档<span class="cm-operator">/</span><span class="cm-variable">B</span>站生信视频<span class="cm-operator">/</span>代码<span class="cm-operator">/</span><span class="cm-number">004</span>_生信人应该这样学<span class="cm-variable">R</span>语言<span class="cm-operator">//</span><span class="cm-variable">GSE42872_series_matrix.txt.gz</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 保存到本地</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">save</span>(<span class="cm-variable">gset</span>,<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-string">"GSE42872"</span>,<span class="cm-string">"_set.Rdata"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"list"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">exper</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">gset</span>[[<span class="cm-number">1</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">exper</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">33297</span> &nbsp; &nbsp; <span class="cm-number">6</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">data</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">GSM1052615</span> <span class="cm-variable">GSM1052616</span> <span class="cm-variable">GSM1052617</span> <span class="cm-variable">GSM1052618</span> <span class="cm-variable">GSM1052619</span> <span class="cm-variable">GSM1052620</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7892501</span> &nbsp; &nbsp;<span class="cm-number">7.24559</span> &nbsp; &nbsp;<span class="cm-number">6.80686</span> &nbsp; &nbsp;<span class="cm-number">7.73301</span> &nbsp; &nbsp;<span class="cm-number">6.18961</span> &nbsp; &nbsp;<span class="cm-number">7.05335</span> &nbsp; &nbsp;<span class="cm-number">7.20371</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7892502</span> &nbsp; &nbsp;<span class="cm-number">6.82711</span> &nbsp; &nbsp;<span class="cm-number">6.70157</span> &nbsp; &nbsp;<span class="cm-number">7.02471</span> &nbsp; &nbsp;<span class="cm-number">6.20493</span> &nbsp; &nbsp;<span class="cm-number">6.76554</span> &nbsp; &nbsp;<span class="cm-number">6.24252</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7892503</span> &nbsp; &nbsp;<span class="cm-number">4.39977</span> &nbsp; &nbsp;<span class="cm-number">4.50781</span> &nbsp; &nbsp;<span class="cm-number">4.88250</span> &nbsp; &nbsp;<span class="cm-number">4.36295</span> &nbsp; &nbsp;<span class="cm-number">4.18137</span> &nbsp; &nbsp;<span class="cm-number">4.73492</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 平均表达量/sd/mad/ 最大的基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">data</span>, <span class="cm-number">1</span>, <span class="cm-variable">mean</span>),<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">7978905</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">14.53288</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">data</span>, <span class="cm-number">1</span>, <span class="cm-variable">sd</span>),<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">8133876</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3.166429</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">data</span>, <span class="cm-number">1</span>, <span class="cm-variable">mad</span>),<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-number">8133876</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4.268561</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 910px;"></div><div class="CodeMirror-gutters" style="display: none; height: 910px;"></div></div></div></pre><ol start='10' ><li><span>下载数据集GSE42872的表达矩阵，并且根据分组使用limma做差异分析，得到差异结果矩阵</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">GEOquery</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dir</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"D:/桌面文件/文档/B站生信视频/代码/004_生信人应该这样学R语言/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-string">"GSE42872"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">f</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-variable">p</span>,<span class="cm-string">"_set.Rdata"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">file.exists</span>(<span class="cm-variable">f</span>)){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-comment"># 下载数据 GSE42872</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-comment"># 保存到dir，不下载注释文件和平台文件</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">gset</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">getGEO</span>(<span class="cm-variable">p</span>,<span class="cm-variable">destdir</span> <span class="cm-operator">=</span> <span class="cm-variable">dir</span>,<span class="cm-variable">AnnotGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">getGPL</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-comment"># 保存到本地</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; <span class="cm-variable">save</span>(<span class="cm-variable">gset</span>,<span class="cm-variable">file</span> <span class="cm-operator">=</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">dir</span>,<span class="cm-variable">p</span>,<span class="cm-string">"_set.Rdata"</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">load</span>(<span class="cm-variable">f</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">class</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"list"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">gset</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 获取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">exper</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">gset</span>[[<span class="cm-number">1</span>]]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">exper</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pdata</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pData</span>(<span class="cm-variable">exper</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sapply</span>(<span class="cm-variable">strsplit</span>(<span class="cm-variable">pdata</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">title</span>,<span class="cm-string">"</span> <span class="cm-string">"</span>), <span class="cm-string">"["</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 抑制警告信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">suppressMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">limma</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 设计矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 每一行为一个样本，同时1表示属于该组，0表示不属于</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">design</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">model.matrix</span>(<span class="cm-operator">~</span><span class="cm-number">0</span><span class="cm-operator">+</span><span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">factor</span>(<span class="cm-variable">group</span>)<span class="cm-variable">Control</span> <span class="cm-variable">factor</span>(<span class="cm-variable">group</span>)<span class="cm-variable">Vemurafenib</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">levels</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Control</span> <span class="cm-variable">Vemurafenib</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSM1052615</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSM1052616</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSM1052617</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GSM1052618</span> &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 比较矩阵：哪个与哪个之间进行比较</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">contrast.matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">makeContrasts</span>(<span class="cm-variable">paste</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">group</span>),<span class="cm-variable">collapse</span> <span class="cm-operator">=</span> <span class="cm-string">"-"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">+</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">contrast.matrix</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">Contrasts</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Levels</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Control</span><span class="cm-operator">-</span><span class="cm-variable">Vemurafenib</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">Control</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">Vemurafenib</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 差异分析</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 构建线性模型并对其进行拟合</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lmFit</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 统计数据分析中用于比较和检查数据组之间差异的函数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">contrasts.fit</span>(<span class="cm-variable">fit1</span>,<span class="cm-variable">contrast.matrix</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 进行贝叶斯检验</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">fit3</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">eBayes</span>(<span class="cm-variable">fit2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 提取出全部的差异表达基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">tempOutput</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">topTable</span>(<span class="cm-variable">fit3</span>,<span class="cm-variable">coef</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>,<span class="cm-variable">n</span> <span class="cm-operator">=</span> <span class="cm-atom">Inf</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">nrDEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">na.omit</span>(<span class="cm-variable">tempOutput</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">logFC</span> &nbsp; <span class="cm-variable">AveExpr</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">P.Value</span> &nbsp; &nbsp;<span class="cm-variable">adj.P.Val</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">B</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8133876</span> <span class="cm-operator">-</span><span class="cm-number">5.780170</span> &nbsp;<span class="cm-number">7.370282</span> <span class="cm-operator">-</span><span class="cm-number">82.94833</span> <span class="cm-number">3.495205e-12</span> <span class="cm-number">1.163798e-07</span> <span class="cm-number">16.32898</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7965335</span> &nbsp;<span class="cm-number">4.212683</span> &nbsp;<span class="cm-number">9.106625</span> &nbsp;<span class="cm-number">68.40113</span> <span class="cm-number">1.437468e-11</span> <span class="cm-number">2.393169e-07</span> <span class="cm-number">15.71739</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7972259</span> <span class="cm-operator">-</span><span class="cm-number">5.633027</span> &nbsp;<span class="cm-number">8.763220</span> <span class="cm-operator">-</span><span class="cm-number">57.61985</span> <span class="cm-number">5.053466e-11</span> <span class="cm-number">4.431880e-07</span> <span class="cm-number">15.04752</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">7972217</span> &nbsp;<span class="cm-number">3.801663</span> &nbsp;<span class="cm-number">9.726468</span> &nbsp;<span class="cm-number">57.21112</span> <span class="cm-number">5.324059e-11</span> <span class="cm-number">4.431880e-07</span> <span class="cm-number">15.01709</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8129573</span> <span class="cm-operator">-</span><span class="cm-number">3.263063</span> <span class="cm-number">10.171635</span> <span class="cm-operator">-</span><span class="cm-number">50.51733</span> <span class="cm-number">1.324638e-10</span> <span class="cm-number">8.821294e-07</span> <span class="cm-number">14.45166</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">8015806</span> &nbsp;<span class="cm-number">3.843247</span> &nbsp;<span class="cm-number">9.667077</span> &nbsp;<span class="cm-number">45.87910</span> <span class="cm-number">2.681063e-10</span> <span class="cm-number">1.487856e-06</span> <span class="cm-number">13.97123</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1820px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1820px;"></div></div></div></pre><h2 id='十四r语言学习资源'><span>十四、R语言学习资源</span></h2><ul><li><span>统计学基础：</span><a href='https://mp.weixin.qq.com/s/OtB2h6f00U2SRZLzveJKfQ' target='_blank' class='url'>https://mp.weixin.qq.com/s/OtB2h6f00U2SRZLzveJKfQ</a></li><li><span>可视化基础：</span><a href='http://www.sthda.com/english/wiki/data-visualization' target='_blank' class='url'>http://www.sthda.com/english/wiki/data-visualization</a></li><li><span>bioconductor基础：</span><a href='https://bioconductor.github.io/BiocWorkshops/index.html' target='_blank' class='url'>https://bioconductor.github.io/BiocWorkshops/index.html</a></li><li><span>安装包：</span><a href='https://github.com/jmzeng1314/biotrainee' target='_blank' class='url'>https://github.com/jmzeng1314/biotrainee</a></li></ul><h2 id='十五高级数据处理技巧'><span>十五、高级数据处理技巧</span></h2><ul><li><span>管道符：</span><strong><span>%&gt;%</span></strong></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 管道符</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">library</span>(<span class="cm-variable">dplyr</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">c</span>(<span class="cm-string">"AA"</span>,<span class="cm-string">"BB"</span>) <span class="cm-operator cm-variable-2">%&gt;%</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">collapse</span> <span class="cm-operator">=</span> <span class="cm-string">"-"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"AA-BB"</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ul><li><p><span>apply系列函数</span></p></li><li><p><span>生信人的20个R语言习题：</span><a href='http://www.bio-info-trainee.com/3409.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3409.html</a></p></li><li><p><span>包的学习：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99304px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">vignette</span>(<span class="cm-string">"stringr"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 26px;"></div><div class="CodeMirror-gutters" style="display: none; height: 26px;"></div></div></div></pre></li></ul><h2 id='十六绘图'><span>十六、绘图</span></h2><ul><li><span>ggpubr：</span><a href='https://rdrr.io/cran/ggpubr/man/' target='_blank' class='url'>https://rdrr.io/cran/ggpubr/man/</a></li><li><a href='https://rpkgs.datanovia.com/ggpubr/index.html' target='_blank' class='url'>https://rpkgs.datanovia.com/ggpubr/index.html</a></li><li><a href='http://biotrainee.com/jmzeng/markdown/ggplot-in-R.html' target='_blank' class='url'>http://biotrainee.com/jmzeng/markdown/ggplot-in-R.html</a></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"ggpubr"</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">ggpubr</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">sex</span> <span class="cm-arg-is">=</span> <span class="cm-variable">factor</span>(<span class="cm-variable">sample</span>(<span class="cm-variable">c</span>(<span class="cm-string">"M"</span>,<span class="cm-string">"F"</span>),<span class="cm-number">100</span>,<span class="cm-variable">replace</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">height</span> <span class="cm-arg-is">=</span> <span class="cm-variable">rnorm</span>(<span class="cm-number">100</span>,<span class="cm-number">100</span>,<span class="cm-number">100</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggboxplot</span>(<span class="cm-variable">data</span>,<span class="cm-string">"sex"</span>,<span class="cm-string">"height"</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"sex"</span>,<span class="cm-variable">palette</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"#FF0000"</span>,<span class="cm-string">"#00FF00"</span>),<span class="cm-variable">add</span> <span class="cm-operator">=</span> <span class="cm-string">"jitter"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\023.png" alt="023" style="zoom:50%;" /></p><h2 id='十七生信人的20个r语言习题'><span>十七、生信人的20个R语言习题</span></h2><ul><li><span>生信人的20个R语言习题：</span><a href='http://www.bio-info-trainee.com/3409.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3409.html</a></li><li><span>答案：</span><a href='http://www.bio-info-trainee.com/3415.html' target='_blank' class='url'>http://www.bio-info-trainee.com/3415.html</a></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 查看 ggplot2 包中的所有可见对象</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ls</span>(<span class="cm-string">"package:ggplot2"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><ol start='' ><li><span>安装一些R包：</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"ALL"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"ALL"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"CLL"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"CLL"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"pasilla"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"pasilla"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"airway"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"airway"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"limma"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"limma"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"DESeq2"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"DESeq2"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"clusterProfiler"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"clusterProfiler"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"reshape2"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"reshape2"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"ggplot2"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"ggplot2"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 234px;"></div><div class="CodeMirror-gutters" style="display: none; height: 234px;"></div></div></div></pre><ol start='2' ><li><span>了解ExpressionSet对象，比如</span><code>CLL</code><span>包里面就有</span><code>data(sCLLex)</code><span> ，找到它包含的元素，提取其表达矩阵(使用exprs函数)，查看其大小。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">suppressPackageStartupMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">CLL</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span>(<span class="cm-string">"sCLLex"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sCLLex</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 提取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>[,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">5</span>],<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">samples</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sampleNames</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 样本名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">samples</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pdata</span><span class="cm-operator">=</span><span class="cm-variable">pData</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 样本的其他信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">pdata</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">pdata</span>[<span class="cm-number">2</span>]) <span class="cm-comment"># 分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">suppressPackageStartupMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">CLL</span>))</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">data</span>(<span class="cm-string">"sCLLex"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">sCLLex</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ExpressionSet</span> (<span class="cm-variable">storageMode</span><span class="cm-operator">:</span> <span class="cm-variable">lockedEnvironment</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">assayData</span><span class="cm-operator">:</span> <span class="cm-number">12625</span> <span class="cm-variable">features</span>, <span class="cm-number">22</span> <span class="cm-variable">samples</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">element</span> <span class="cm-variable">names</span><span class="cm-operator">:</span> <span class="cm-variable">exprs</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">protocolData</span><span class="cm-operator">:</span> <span class="cm-variable">none</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">phenoData</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">sampleNames</span><span class="cm-operator">:</span> <span class="cm-variable">CLL11.CEL</span> <span class="cm-variable">CLL12.CEL</span> <span class="cm-keyword">...</span> <span class="cm-variable">CLL9.CEL</span> (<span class="cm-number">22</span> <span class="cm-variable">total</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">varLabels</span><span class="cm-operator">:</span> <span class="cm-variable">SampleID</span> <span class="cm-variable">Disease</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">varMetadata</span><span class="cm-operator">:</span> <span class="cm-variable">labelDescription</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">featureData</span><span class="cm-operator">:</span> <span class="cm-variable">none</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experimentData</span><span class="cm-operator">:</span> <span class="cm-variable">use</span> <span class="cm-string">'experimentData(object)'</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Annotation</span><span class="cm-operator">:</span> <span class="cm-variable">hgu95av2</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">exprs</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 提取表达矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>[,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">5</span>],<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL11.CEL</span> <span class="cm-variable">CLL12.CEL</span> <span class="cm-variable">CLL13.CEL</span> <span class="cm-variable">CLL14.CEL</span> <span class="cm-variable">CLL15.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">5.743132</span> &nbsp;<span class="cm-number">6.219412</span> &nbsp;<span class="cm-number">5.523328</span> &nbsp;<span class="cm-number">5.340477</span> &nbsp;<span class="cm-number">5.229904</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-number">2.285143</span> &nbsp;<span class="cm-number">2.291229</span> &nbsp;<span class="cm-number">2.287986</span> &nbsp;<span class="cm-number">2.295313</span> &nbsp;<span class="cm-number">2.662170</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> &nbsp;<span class="cm-number">3.309294</span> &nbsp;<span class="cm-number">3.318466</span> &nbsp;<span class="cm-number">3.354423</span> &nbsp;<span class="cm-number">3.327130</span> &nbsp;<span class="cm-number">3.365113</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">samples</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">sampleNames</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 样本名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">samples</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-string">"CLL11.CEL"</span> <span class="cm-string">"CLL12.CEL"</span> <span class="cm-string">"CLL13.CEL"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">pdata</span><span class="cm-operator">=</span><span class="cm-variable">pData</span>(<span class="cm-variable">sCLLex</span>) <span class="cm-comment"># 样本的其他信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">pdata</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">SampleID</span> &nbsp;<span class="cm-variable">Disease</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL11.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL11</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL12.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL12</span> &nbsp; <span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLL13.CEL</span> &nbsp; &nbsp;<span class="cm-variable">CLL13</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">pdata</span>[<span class="cm-number">2</span>]) <span class="cm-comment"># 分组信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">12625</span> &nbsp; &nbsp;<span class="cm-number">22</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 832px;"></div><div class="CodeMirror-gutters" style="display: none; height: 832px;"></div></div></div></pre><ol start='4' ><li><span>安装并了解 </span><code>hgu95av2.db</code><span> 包，看看 </span><code>ls(&quot;package:hgu95av2.db&quot;)</code><span> 后 显示的那些变量</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"hgu95av2.db"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"hgu95av2.db"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ls</span>(<span class="cm-string">"package:hgu95av2.db"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] <span class="cm-string">"hgu95av2"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2.db"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2_dbconn"</span> &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">4</span>] <span class="cm-string">"hgu95av2_dbfile"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2_dbInfo"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2_dbschema"</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">7</span>] <span class="cm-string">"hgu95av2ACCNUM"</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2ALIAS2PROBE"</span> &nbsp; <span class="cm-string">"hgu95av2CHR"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">10</span>] <span class="cm-string">"hgu95av2CHRLENGTHS"</span> &nbsp; &nbsp;<span class="cm-string">"hgu95av2CHRLOC"</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2CHRLOCEND"</span> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">13</span>] <span class="cm-string">"hgu95av2ENSEMBL"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2ENSEMBL2PROBE"</span> <span class="cm-string">"hgu95av2ENTREZID"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">16</span>] <span class="cm-string">"hgu95av2ENZYME"</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2ENZYME2PROBE"</span> &nbsp;<span class="cm-string">"hgu95av2GENENAME"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">19</span>] <span class="cm-string">"hgu95av2GO"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2GO2ALLPROBES"</span> &nbsp;<span class="cm-string">"hgu95av2GO2PROBE"</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">22</span>] <span class="cm-string">"hgu95av2MAP"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2MAPCOUNTS"</span> &nbsp; &nbsp; <span class="cm-string">"hgu95av2OMIM"</span> &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">25</span>] <span class="cm-string">"hgu95av2ORGANISM"</span> &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2ORGPKG"</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2PATH"</span> &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">28</span>] <span class="cm-string">"hgu95av2PATH2PROBE"</span> &nbsp; &nbsp;<span class="cm-string">"hgu95av2PFAM"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2PMID"</span> &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">31</span>] <span class="cm-string">"hgu95av2PMID2PROBE"</span> &nbsp; &nbsp;<span class="cm-string">"hgu95av2PROSITE"</span> &nbsp; &nbsp; &nbsp; <span class="cm-string">"hgu95av2REFSEQ"</span> &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">34</span>] <span class="cm-string">"hgu95av2SYMBOL"</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">"hgu95av2UNIPROT"</span> &nbsp; &nbsp; &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 364px;"></div><div class="CodeMirror-gutters" style="display: none; height: 364px;"></div></div></div></pre><ol start='5' ><li><span>理解 </span><code>head(toTable(hgu95av2SYMBOL))</code><span> 的用法，找到 TP53 基因对应的探针ID</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">hgu95av2SYMBOL</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">ids</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># TP53基因的探针</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ids</span>[<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span> <span class="cm-operator">==</span> <span class="cm-string">"TP53"</span>,]</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">toTable</span>(<span class="cm-variable">hgu95av2SYMBOL</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">ids</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">probe_id</span> &nbsp;<span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-number">1000</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">MAPK3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; <span class="cm-number">1001</span>_<span class="cm-variable">at</span> &nbsp; &nbsp;<span class="cm-variable">TIE1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-number">1002</span>_<span class="cm-variable">f_at</span> <span class="cm-variable">CYP2C19</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">4</span> <span class="cm-number">1003</span>_<span class="cm-variable">s_at</span> &nbsp; <span class="cm-variable">CXCR5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">5</span> &nbsp; <span class="cm-number">1004</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">CXCR5</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6</span> &nbsp; <span class="cm-number">1005</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">DUSP1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># TP53基因的探针</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ids</span>[<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span> <span class="cm-operator">==</span> <span class="cm-string">"TP53"</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;<span class="cm-variable">probe_id</span> <span class="cm-variable">symbol</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">987</span> &nbsp; &nbsp;<span class="cm-number">1939</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1019</span> <span class="cm-number">1974</span>_<span class="cm-variable">s_at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1459</span> &nbsp;<span class="cm-number">31618</span>_<span class="cm-variable">at</span> &nbsp; <span class="cm-variable">TP53</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><ol start='6' ><li><span>理解探针与基因的对应关系，总共多少个基因，基因最多对应多少个探针，是哪些基因，是不是因为这些基因很长，所以在其上面设计多个探针呢？</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 基因总数</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">length</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 探针数最多的10个基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">table</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>)),<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 各长度探针的基因数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">table</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">table</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>)))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 基因总数</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">length</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">8776</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 探针数最多的10个基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">table</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>)),<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ACTB</span> &nbsp; <span class="cm-variable">CD44</span> &nbsp;<span class="cm-variable">ERBB3</span> &nbsp;<span class="cm-variable">GAPDH</span> &nbsp;<span class="cm-variable">RBPMS</span> &nbsp;<span class="cm-variable">TERF1</span> <span class="cm-variable">INPP4A</span> &nbsp; &nbsp;<span class="cm-variable">MYB</span> <span class="cm-variable">PTGER3</span> &nbsp;<span class="cm-variable">STAT1</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">8</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">8</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">8</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 各长度探针的基因数</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">table</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">table</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">1</span> &nbsp; &nbsp;<span class="cm-number">2</span> &nbsp; &nbsp;<span class="cm-number">3</span> &nbsp; &nbsp;<span class="cm-number">4</span> &nbsp; &nbsp;<span class="cm-number">5</span> &nbsp; &nbsp;<span class="cm-number">6</span> &nbsp; &nbsp;<span class="cm-number">7</span> &nbsp; &nbsp;<span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">6725</span> <span class="cm-number">1444</span> &nbsp;<span class="cm-number">451</span> &nbsp;<span class="cm-number">103</span> &nbsp; <span class="cm-number">27</span> &nbsp; <span class="cm-number">16</span> &nbsp; &nbsp;<span class="cm-number">6</span> &nbsp; &nbsp;<span class="cm-number">4</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><ol start='7' ><li><span>第二步提取到的表达矩阵是12625个探针在22个样本的表达量矩阵，找到那些不在 </span><code>hgu95av2.db</code><span> 包收录的对应着SYMBOL的探针。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 不在 hgu95av2.db 包基因探针</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">no.contain</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-operator">!</span><span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">no.contain</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">942</span> &nbsp;<span class="cm-number">22</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ol start='8' ><li><span>过滤表达矩阵，删除那1165个没有对应基因名字的探针。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 删除探针不存在的数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">11683</span> &nbsp; &nbsp;<span class="cm-number">22</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ol start='9' ><li><span>整合表达矩阵，多个探针对应一个基因的情况下，只保留在所有样本里面平均表达量最大的那个探针。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将ids进行排序</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-variable">match</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 每个基因最大表达量的行名（探针名）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">temp</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">by</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>,<span class="cm-keyword">function</span>(<span class="cm-variable">x</span>) <span class="cm-variable">rownames</span>(<span class="cm-variable">x</span>)[<span class="cm-variable">which.max</span>(<span class="cm-variable">rowMeans</span>(<span class="cm-variable">x</span>))])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">probes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">temp</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">probes</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 将ids进行排序</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-variable">match</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 每个基因最大表达量的行名（探针名）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">temp</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">by</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>,<span class="cm-keyword">function</span>(<span class="cm-variable">x</span>) <span class="cm-variable">rownames</span>(<span class="cm-variable">x</span>)[<span class="cm-variable">which.max</span>(<span class="cm-variable">rowMeans</span>(<span class="cm-variable">x</span>))])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">probes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">temp</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">11683</span> &nbsp; &nbsp;<span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">experSet</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-variable-2">%in%</span> <span class="cm-variable">probes</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">dim</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">1</span>] <span class="cm-number">8776</span> &nbsp; <span class="cm-number">22</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 260px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><ol start='10' ><li><span>把过滤后的表达矩阵更改行名为基因的symbol，因为这个时候探针和基因是一对一关系了。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将探针名替换为symbol名</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-variable">match</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>),<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>[,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">5</span>],<span class="cm-number">3</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 78px;"></div><div class="CodeMirror-gutters" style="display: none; height: 78px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-comment"># 将探针名替换为symbol名</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-variable">match</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">experSet</span>),<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>),<span class="cm-number">2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">experSet</span>[,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">5</span>],<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">CLL11.CEL</span> <span class="cm-variable">CLL12.CEL</span> <span class="cm-variable">CLL13.CEL</span> <span class="cm-variable">CLL14.CEL</span> <span class="cm-variable">CLL15.CEL</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">MAPK3</span> &nbsp; &nbsp;<span class="cm-number">5.743132</span> &nbsp;<span class="cm-number">6.219412</span> &nbsp;<span class="cm-number">5.523328</span> &nbsp;<span class="cm-number">5.340477</span> &nbsp;<span class="cm-number">5.229904</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TIE1</span> &nbsp; &nbsp; <span class="cm-number">2.285143</span> &nbsp;<span class="cm-number">2.291229</span> &nbsp;<span class="cm-number">2.287986</span> &nbsp;<span class="cm-number">2.295313</span> &nbsp;<span class="cm-number">2.662170</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CYP2C19</span> &nbsp;<span class="cm-number">3.309294</span> &nbsp;<span class="cm-number">3.318466</span> &nbsp;<span class="cm-number">3.354423</span> &nbsp;<span class="cm-number">3.327130</span> &nbsp;<span class="cm-number">3.365113</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-variable">F</span>){</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 只保留中位数最大的探针</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">median</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">apply</span>(<span class="cm-variable">data</span>,<span class="cm-number">1</span>,<span class="cm-variable">median</span>) <span class="cm-comment">#ids新建median这一列，列名为median，同时对dat这个矩阵按行操作，取每一行的中位数，将结果给到median这一列的每一行</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-variable">order</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>,<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">median</span>,<span class="cm-variable">decreasing</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>),]<span class="cm-comment">#对ids$symbol按照ids$median中位数从大到小排列的顺序排序，将对应的行赋值为一个新的ids</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ids</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ids</span>[<span class="cm-operator">!</span><span class="cm-variable">duplicated</span>(<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span>),]<span class="cm-comment">#将symbol这一列取取出重复项，'!'为否，即取出不重复的项，去除重复的gene ，保留每个基因最大表达量结果s</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">dat</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[<span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">probe_id</span>,] <span class="cm-comment">#新的ids取出probe_id这一列，将dat按照取出的这一列中的每一行组成一个新的dat</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">rownames</span>(<span class="cm-variable">data</span>)<span class="cm-operator">=</span><span class="cm-variable">ids</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">symbol</span><span class="cm-comment">#把ids的symbol这一列中的每一行给dat作为dat的行名</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">dat</span>[<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">4</span>] &nbsp;<span class="cm-comment">#保留每个基因ID第一次出现的信息</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">dim</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><ol start='11' ><li><span>对第10步得到的表达矩阵进行探索，先画第一个样本的所有基因的表达量的boxplot,hist,density ， 然后画所有样本的这些图</span></li></ol><ul><li><span>表达矩阵的可视化：</span><a href='http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html' target='_blank' class='url'>http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html</a></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 第一个样本的可视化</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 箱线图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">experSet</span>[,<span class="cm-number">1</span>]),<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_boxplot</span>() <span class="cm-operator">+</span> <span class="cm-variable">theme_bw</span>() <span class="cm-operator">+</span> <span class="cm-variable">coord_flip</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 直方图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">experSet</span>[,<span class="cm-number">1</span>]),<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>() <span class="cm-operator">+</span> <span class="cm-variable">theme_bw</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 密度图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">data.frame</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">experSet</span>[,<span class="cm-number">1</span>]),<span class="cm-variable">aes</span>(<span class="cm-variable">x</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_density</span>() <span class="cm-operator">+</span> <span class="cm-variable">theme_bw</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\024.png" referrerpolicy="no-referrer" alt="024"></th><th><img src="img\004_生信人应该这样学R语言\025.png" referrerpolicy="no-referrer" alt="025"></th><th><img src="img\004_生信人应该这样学R语言\026.png" referrerpolicy="no-referrer" alt="026"></th></tr></thead><tbody></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 所有样本</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">reshape2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 数据重构</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experSet_L</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">melt</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">experSet_L</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">c</span>(<span class="cm-string">'probe'</span>,<span class="cm-string">'sample'</span>,<span class="cm-string">'value'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">experSet_L</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rep</span>(<span class="cm-variable">group</span>,<span class="cm-variable">each</span> <span class="cm-operator">=</span> <span class="cm-variable">nrow</span>(<span class="cm-variable">experSet</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-number">3</span>) </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">probe</span> &nbsp; &nbsp;<span class="cm-variable">sample</span> &nbsp; &nbsp;<span class="cm-variable">value</span> &nbsp; &nbsp;<span class="cm-variable">group</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1</span> &nbsp; <span class="cm-variable">MAPK3</span> <span class="cm-variable">CLL11.CEL</span> <span class="cm-number">5.743132</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">2</span> &nbsp; &nbsp;<span class="cm-variable">TIE1</span> <span class="cm-variable">CLL11.CEL</span> <span class="cm-number">2.285143</span> <span class="cm-variable">progres.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">3</span> <span class="cm-variable">CYP2C19</span> <span class="cm-variable">CLL11.CEL</span> <span class="cm-number">3.309294</span> <span class="cm-variable">progres.</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 箱线图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">sample</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">value</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 小提琴图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">sample</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">value</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_violin</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 直方图：分为200组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">value</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_histogram</span>(<span class="cm-variable">bins</span> <span class="cm-operator">=</span> <span class="cm-number">200</span>) <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">sample</span>,<span class="cm-variable">nrow</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 密度曲线图：分面</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">value</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_density</span>() <span class="cm-operator">+</span> <span class="cm-variable">facet_wrap</span>(<span class="cm-operator">~</span><span class="cm-variable">sample</span>,<span class="cm-variable">nrow</span> <span class="cm-operator">=</span> <span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">value</span>,<span class="cm-variable">col</span><span class="cm-operator">=</span><span class="cm-variable">group</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_density</span>() </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 312px;"></div><div class="CodeMirror-gutters" style="display: none; height: 312px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\027.png" referrerpolicy="no-referrer" alt="027"></th><th><img src="img\004_生信人应该这样学R语言\028.png" referrerpolicy="no-referrer" alt="028"></th></tr></thead><tbody><tr><td><img src="img\004_生信人应该这样学R语言\029.png" referrerpolicy="no-referrer" alt="029"></td><td><img src="img\004_生信人应该这样学R语言\030.png" referrerpolicy="no-referrer" alt="030"></td></tr><tr><td><img src="img\004_生信人应该这样学R语言\031.png" referrerpolicy="no-referrer" alt="031"></td><td>&nbsp;</td></tr></tbody></table></figure><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 修改箱线图的样式</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">ggplot</span>(<span class="cm-variable">experSet_L</span>,<span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">sample</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-variable">value</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>)) <span class="cm-operator">+</span> <span class="cm-variable">geom_boxplot</span>()</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># x变量汇总，使用mean函数，同时使用geom_point()绘制点</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">stat_summary</span>(<span class="cm-variable">fun</span> <span class="cm-operator">=</span> <span class="cm-string">"mean"</span>,<span class="cm-variable">geom</span> <span class="cm-operator">=</span> <span class="cm-string">"point"</span>,<span class="cm-variable">shape</span> <span class="cm-operator">=</span> <span class="cm-number">23</span>,<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">3</span>,<span class="cm-variable">fill</span> <span class="cm-operator">=</span> <span class="cm-string">"red"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 白色背景，字体为20</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">theme_bw</span>(<span class="cm-variable">base_size</span> <span class="cm-operator">=</span> <span class="cm-number">20</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># face = 'bold'：文本加粗</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># angle = 30：选择30度</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># hjust = 1：文本水平方向右对齐</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 取消坐标轴标签</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">p</span> <span class="cm-operator">+</span> <span class="cm-variable">theme</span>(<span class="cm-variable">text</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">face</span> <span class="cm-operator">=</span> <span class="cm-string">'bold'</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">axis.text.x</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">angle</span> <span class="cm-operator">=</span> <span class="cm-number">30</span>,<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">axis.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_blank</span>())</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\032.png" referrerpolicy="no-referrer" alt="032"></p><ol start='12' ><li><span>理解统计学指标mean,median,max,min,sd,var,mad并计算出每个基因在所有样本的这些统计学指标，最后按照mad值排序，取top 50 mad值的基因，得到列表。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_mean</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">mean</span>)),<span class="cm-number">50</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_median</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">median</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_max</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">max</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_min</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">min</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_sd</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">sd</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_var</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">var</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_mad</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">mad</span>)),<span class="cm-number">50</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">g_mad</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">PFN2</span> &nbsp; <span class="cm-variable">TNFSF9</span> <span class="cm-variable">ARHGAP44</span> &nbsp; <span class="cm-variable">P2RY14</span> &nbsp;<span class="cm-variable">THEMIS2</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">LPL</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-number">1.481294</span> <span class="cm-number">1.485155</span> <span class="cm-number">1.488032</span> <span class="cm-number">1.505107</span> <span class="cm-number">1.507287</span> <span class="cm-number">1.532212</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre><ol start='13' ><li><span>根据第12步骤得到top 50 mad值的基因列表来取表达矩阵的子集，并且热图可视化子表达矩阵。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 热图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">pheatmap</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_gene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">names</span>(<span class="cm-variable">tail</span>(<span class="cm-variable">sort</span>(<span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>,<span class="cm-number">1</span>,<span class="cm-variable">mad</span>)),<span class="cm-number">50</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">choose_gene</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 将每个基因进行标准化</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">t</span>(<span class="cm-variable">scale</span>(<span class="cm-variable">t</span>(<span class="cm-variable">choose_matrix</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pheatmap</span>(<span class="cm-variable">choose_matrix</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\033.png" alt="033" style="zoom:50%;" /></p><ol start='14' ><li><span>取不同统计学指标mean,median,max,mean,sd,var,mad的各top50基因列表，使用UpSetR包来看他们之间的overlap情况。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"UpSetR"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"UpSetR"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 全部基因</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">g_all</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">unique</span>(<span class="cm-variable">c</span>(<span class="cm-variable">names</span>(<span class="cm-variable">g_mean</span>),<span class="cm-variable">names</span>(<span class="cm-variable">g_median</span>),<span class="cm-variable">names</span>(<span class="cm-variable">g_max</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-variable">names</span>(<span class="cm-variable">g_min</span>),<span class="cm-variable">names</span>(<span class="cm-variable">g_sd</span>),<span class="cm-variable">names</span>(<span class="cm-variable">g_var</span>),<span class="cm-variable">names</span>(<span class="cm-variable">g_mad</span>) ))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">g_all</span> <span class="cm-operator">=</span> <span class="cm-variable">g_all</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_mean</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_mean</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_median</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_median</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_max</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_max</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_min</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_min</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_sd</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_sd</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_var</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_var</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">g_mad</span> <span class="cm-operator">=</span> <span class="cm-variable">ifelse</span>(<span class="cm-variable">g_all</span> <span class="cm-operator cm-variable-2">%in%</span> &nbsp;<span class="cm-variable">names</span>(<span class="cm-variable">g_mad</span>) ,<span class="cm-number">1</span>,<span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制upset图</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 集合的个数为7</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">upset</span>(<span class="cm-variable">data</span>,<span class="cm-variable">nsets</span> <span class="cm-operator">=</span> <span class="cm-number">7</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 390px;"></div><div class="CodeMirror-gutters" style="display: none; height: 390px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\034.png" alt="034" style="zoom:67%;" /></p><ol start='15' ><li><span>在第二步的基础上面提取</span><code>CLL</code><span>包里面的</span><code>data(sCLLex)</code><span> 数据对象的样本的表型数据。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 表型数据</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pdata</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">pData</span>(<span class="cm-variable">sCLLex</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.character</span>(<span class="cm-variable">pdata</span>[,<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">1</span>] <span class="cm-string">"progres."</span> <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> [<span class="cm-number">7</span>] <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"progres."</span> <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"progres."</span> <span class="cm-string">"stable"</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">13</span>] <span class="cm-string">"progres."</span> <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"stable"</span> &nbsp; <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[<span class="cm-number">19</span>] <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span> <span class="cm-string">"progres."</span> <span class="cm-string">"stable"</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><ol start='16' ><li><span>对所有样本的表达矩阵进行聚类并且绘图，然后添加样本的临床表型数据信息(更改样本名)</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#聚类分析</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">opar</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">par</span>(<span class="cm-variable">no.readonly</span> <span class="cm-operator">=</span> <span class="cm-variable">T</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">paste0</span>(<span class="cm-variable">group</span>,<span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-number">22</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 节点的设置，只显示叶子的点，不显示分支点</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nodePar</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-builtin">list</span>(<span class="cm-variable">lab.cex</span> <span class="cm-operator">=</span> <span class="cm-number">0.6</span>, <span class="cm-variable">pch</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-atom">NA</span>, <span class="cm-number">19</span>),<span class="cm-variable">cex</span> <span class="cm-operator">=</span> <span class="cm-number">0.7</span>, <span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"blue"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 按样本之间的距离进行聚类</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">hc</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">hclust</span>(<span class="cm-variable">dist</span>(<span class="cm-variable">t</span>(<span class="cm-variable">experSet</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">par</span>(<span class="cm-variable">mar</span><span class="cm-operator">=</span><span class="cm-variable">c</span>(<span class="cm-number">3</span>,<span class="cm-number">3</span>,<span class="cm-number">3</span>,<span class="cm-number">5</span>)) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">as.dendrogram</span>(<span class="cm-variable">hc</span>), <span class="cm-variable">nodePar</span> <span class="cm-operator">=</span> <span class="cm-variable">nodePar</span>, &nbsp;<span class="cm-variable">horiz</span> <span class="cm-operator">=</span> <span class="cm-variable">TRUE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">par</span>(<span class="cm-variable">opar</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 260px;"></div><div class="CodeMirror-gutters" style="display: none; height: 260px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\036.png" alt="036" style="zoom:67%;" /></p><ol start='17' ><li><span>对所有样本的表达矩阵进行PCA分析并且绘图，同样要添加表型信息。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span>(<span class="cm-operator">!</span><span class="cm-variable">require</span>(<span class="cm-string">"ggfortify"</span>)) <span class="cm-variable">BiocManager</span><span class="cm-operator">::</span><span class="cm-variable">install</span>(<span class="cm-string">"ggfortify"</span>,<span class="cm-variable">ask</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>,<span class="cm-variable">update</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">t</span>(<span class="cm-variable">experSet</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">group</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">autoplot</span>(<span class="cm-variable">prcomp</span>(<span class="cm-variable">df</span>[,<span class="cm-number">1</span><span class="cm-operator">:</span>(<span class="cm-variable">ncol</span>(<span class="cm-variable">df</span>)<span class="cm-operator">-</span><span class="cm-number">1</span>)]), <span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">df</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">'group'</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\037.png" alt="037" style="zoom:67%;" /></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 画主成分分析图需要加载这两个包</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-string">"FactoMineR"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-string">"factoextra"</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">t</span>(<span class="cm-variable">experSet</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 现在dat最后一列是group，需要重新赋值给一个data.pca,</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 这个矩阵是不含有分组信息的，同时不输出图形</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data.pca</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">PCA</span>(<span class="cm-variable">df</span>, <span class="cm-variable">graph</span> <span class="cm-operator">=</span> <span class="cm-variable">F</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fviz_pca_ind</span>(<span class="cm-variable">data.pca</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">geom.ind</span> <span class="cm-operator">=</span> <span class="cm-string">"point"</span>, <span class="cm-comment"># 使用散点图展示</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">col.ind</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>, <span class="cm-comment"># 设置每个样本的组</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">palette</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">"#00AFBB"</span>, <span class="cm-string">"#E7B800"</span>), <span class="cm-comment"># 自定义分组颜色</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">addEllipses</span> <span class="cm-operator">=</span> <span class="cm-variable">TRUE</span>, <span class="cm-comment"># 添加两个圆圈（组别之间的区分度）</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">legend.title</span> <span class="cm-operator">=</span> <span class="cm-string">"Groups"</span>,<span class="cm-variable">title</span> <span class="cm-operator">=</span> <span class="cm-string">"PCA分析"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 338px;"></div><div class="CodeMirror-gutters" style="display: none; height: 338px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\038.png" alt="038" style="zoom:67%;" /></p><ol start='18' ><li><span>根据表达矩阵及样本分组信息进行批量T检验，得到检验结果表格</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.factor</span>(<span class="cm-variable">group</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">which</span>(<span class="cm-variable">group</span> <span class="cm-operator">==</span> <span class="cm-variable">levels</span>(<span class="cm-variable">group</span>)[<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">group2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">which</span>(<span class="cm-variable">group</span> <span class="cm-operator">==</span> <span class="cm-variable">levels</span>(<span class="cm-variable">group</span>)[<span class="cm-number">2</span>])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[, <span class="cm-variable">group1</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data</span>[, <span class="cm-variable">group2</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 计算p值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pvals</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">apply</span>(<span class="cm-variable">experSet</span>, <span class="cm-number">1</span>, <span class="cm-keyword">function</span>(<span class="cm-variable">x</span>){</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">t.test</span>(<span class="cm-variable">as.numeric</span>(<span class="cm-variable">x</span>)<span class="cm-operator">~</span><span class="cm-variable">group</span>)<span class="cm-operator cm-dollar">$</span><span class="cm-variable">p.value</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">})</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># p值校正</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">p.adj</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">p.adjust</span>(<span class="cm-variable">pvals</span>, <span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"BH"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">avg_1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rowMeans</span>(<span class="cm-variable">data1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">avg_2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">rowMeans</span>(<span class="cm-variable">data2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">log2FC</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">log2</span>(<span class="cm-variable">avg_2</span>) <span class="cm-operator">-</span> <span class="cm-variable">log2</span>(<span class="cm-variable">avg_1</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG_t.test</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">cbind</span>(<span class="cm-variable">avg_1</span>, <span class="cm-variable">avg_2</span>, <span class="cm-variable">log2FC</span>, <span class="cm-variable">pvals</span>, <span class="cm-variable">p.adj</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG_t.test</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">DEG_t.test</span>[<span class="cm-variable">order</span>(<span class="cm-variable">DEG_t.test</span>[,<span class="cm-number">4</span>]),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG_t.test</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.data.frame</span>(<span class="cm-variable">DEG_t.test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">DEG_t.test</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 494px;"></div><div class="CodeMirror-gutters" style="display: none; height: 494px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">avg_1</span> &nbsp; &nbsp;<span class="cm-variable">avg_2</span> &nbsp; &nbsp; <span class="cm-variable">log2FC</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">pvals</span> &nbsp; &nbsp; <span class="cm-variable">p.adj</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SGSM2</span> &nbsp;<span class="cm-number">7.875615</span> <span class="cm-number">8.791753</span> &nbsp;<span class="cm-number">0.1587582</span> <span class="cm-number">1.629755e-05</span> <span class="cm-number">0.1430273</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">PDE8A</span> &nbsp;<span class="cm-number">6.622749</span> <span class="cm-number">7.965007</span> &nbsp;<span class="cm-number">0.2662455</span> <span class="cm-number">4.058944e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DLEU1</span> &nbsp;<span class="cm-number">7.616197</span> <span class="cm-number">5.786041</span> <span class="cm-operator">-</span><span class="cm-number">0.3964941</span> <span class="cm-number">6.965416e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">LDOC1</span> &nbsp;<span class="cm-number">4.456446</span> <span class="cm-number">2.152471</span> <span class="cm-operator">-</span><span class="cm-number">1.0498998</span> <span class="cm-number">8.993339e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">USP6NL</span> <span class="cm-number">5.988866</span> <span class="cm-number">7.058738</span> &nbsp;<span class="cm-number">0.2371274</span> <span class="cm-number">9.648226e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COMMD4</span> <span class="cm-number">4.157971</span> <span class="cm-number">3.407405</span> <span class="cm-operator">-</span><span class="cm-number">0.2872063</span> <span class="cm-number">2.454557e-04</span> <span class="cm-number">0.2644545</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="display: none; height: 182px;"></div></div></div></pre><ol start='19' ><li><span>使用limma包对表达矩阵及样本分组信息进行差异分析，得到差异分析表格，重点看logFC和P值，画个火山图(就是logFC和-log10(P值)的散点图)。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># limma差异分析</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">suppressMessages</span>(<span class="cm-variable">library</span>(<span class="cm-variable">limma</span>)) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">design</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">model.matrix</span>(<span class="cm-operator">~</span><span class="cm-number">0</span><span class="cm-operator">+</span><span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">colnames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">levels</span>(<span class="cm-variable">factor</span>(<span class="cm-variable">group</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rownames</span>(<span class="cm-variable">design</span>) <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">colnames</span>(<span class="cm-variable">experSet</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 比较矩阵</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># "progres.-stable"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">contrast.matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">makeContrasts</span>(<span class="cm-variable">paste0</span>(<span class="cm-variable">unique</span>(<span class="cm-variable">group</span>),<span class="cm-variable">collapse</span> <span class="cm-operator">=</span> <span class="cm-string">"-"</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">levels</span> <span class="cm-operator">=</span> <span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">contrast.matrix</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 即progres.组跟stable进行差异分析比较</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">lmFit</span>(<span class="cm-variable">experSet</span>,<span class="cm-variable">design</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">contrasts.fit</span>(<span class="cm-variable">fit</span>, <span class="cm-variable">contrast.matrix</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fit2</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">eBayes</span>(<span class="cm-variable">fit2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># coef=1：第一个回归参数的值，由于没有截距项，如果有截距项应该coef=2</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tempOutput</span> &nbsp;<span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">topTable</span>(<span class="cm-variable">fit2</span>, <span class="cm-variable">coef</span><span class="cm-operator">=</span><span class="cm-number">1</span>, <span class="cm-variable">n</span><span class="cm-operator">=</span><span class="cm-atom">Inf</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nrDEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">na.omit</span>(<span class="cm-variable">tempOutput</span>) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 520px;"></div><div class="CodeMirror-gutters" style="display: none; height: 520px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">design</span>,<span class="cm-number">3</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">progres.</span> <span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">progres.1</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stable2</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">progres.3</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-number">1</span> &nbsp; &nbsp; &nbsp;<span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">contrast.matrix</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Contrasts</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">Levels</span> &nbsp; &nbsp; <span class="cm-variable">progres.</span><span class="cm-operator">-</span><span class="cm-variable">stable</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">progres.</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">stable</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">-</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">logFC</span> &nbsp;<span class="cm-variable">AveExpr</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">P.Value</span> &nbsp;<span class="cm-variable">adj.P.Val</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">B</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TBC1D2B</span> <span class="cm-operator">-</span><span class="cm-number">1.0284628</span> <span class="cm-number">5.620700</span> <span class="cm-operator">-</span><span class="cm-number">5.837748</span> <span class="cm-number">8.228423e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.352549</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLIC1</span> &nbsp; &nbsp;<span class="cm-number">0.9888221</span> <span class="cm-number">9.954273</span> &nbsp;<span class="cm-number">5.773178</span> <span class="cm-number">9.545919e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.231487</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DLEU1</span> &nbsp; &nbsp;<span class="cm-number">1.8301554</span> <span class="cm-number">6.950685</span> &nbsp;<span class="cm-number">5.741354</span> <span class="cm-number">1.027259e-05</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.171586</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SH3BP2</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">1.3835699</span> <span class="cm-number">4.463438</span> <span class="cm-operator">-</span><span class="cm-number">5.735847</span> <span class="cm-number">1.040396e-05</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.161205</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GPM6A</span> &nbsp; &nbsp;<span class="cm-number">2.5471980</span> <span class="cm-number">6.915045</span> &nbsp;<span class="cm-number">5.043623</span> <span class="cm-number">5.260547e-05</span> <span class="cm-number">0.08915221</span> <span class="cm-number">1.822622</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">YTHDC2</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.5187135</span> <span class="cm-number">7.602354</span> <span class="cm-operator">-</span><span class="cm-number">4.873743</span> <span class="cm-number">7.877050e-05</span> <span class="cm-number">0.08915221</span> <span class="cm-number">1.485155</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 468px;"></div><div class="CodeMirror-gutters" style="display: none; height: 468px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制火山图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">nrDEG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># logFC阈值</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">logFC_cutoff</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">with</span>(<span class="cm-variable">DEG</span>,<span class="cm-variable">mean</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">logFC</span>)) <span class="cm-operator">+</span> <span class="cm-number">2</span><span class="cm-operator">*</span><span class="cm-variable">sd</span>(<span class="cm-variable">abs</span>(<span class="cm-variable">logFC</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">change</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">as.factor</span>(<span class="cm-variable">ifelse</span>(<span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">P.Value</span> <span class="cm-operator">&lt;</span> <span class="cm-number">0.05</span> <span class="cm-operator">&amp;</span> <span class="cm-variable">abs</span>(<span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">logFC</span>) <span class="cm-operator">&gt;</span> <span class="cm-variable">logFC_cutoff</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">ifelse</span>(<span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">logFC</span> <span class="cm-operator">&gt;</span> <span class="cm-variable">logFC_cutoff</span> ,<span class="cm-string">'UP'</span>,<span class="cm-string">'DOWN'</span>),<span class="cm-string">'NOT'</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">this_title</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">paste0</span>(<span class="cm-string">'Cutoff for logFC is '</span>,<span class="cm-variable">round</span>(<span class="cm-variable">logFC_cutoff</span>,<span class="cm-number">3</span>),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">'</span><span class="cm-string-2">\n</span><span class="cm-string">The number of up gene is '</span>,<span class="cm-variable">nrow</span>(<span class="cm-variable">DEG</span>[<span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">change</span> <span class="cm-operator">==</span><span class="cm-string">'UP'</span>,]) ,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-string">'</span><span class="cm-string-2">\n</span><span class="cm-string">The number of down gene is '</span>,<span class="cm-variable">nrow</span>(<span class="cm-variable">DEG</span>[<span class="cm-variable">DEG</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">change</span> <span class="cm-operator">==</span><span class="cm-string">'DOWN'</span>,])</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">DEG</span>,<span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggplot</span>(<span class="cm-variable">data</span> <span class="cm-operator">=</span> <span class="cm-variable">DEG</span>, <span class="cm-variable">aes</span>(<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-variable">logFC</span>, <span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-operator">-</span><span class="cm-variable">log10</span>(<span class="cm-variable">P.Value</span>), <span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-variable">change</span>)) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">geom_point</span>(<span class="cm-variable">alpha</span> <span class="cm-operator">=</span> <span class="cm-number">0.4</span>, <span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">1.75</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">theme_bw</span>(<span class="cm-variable">base_size</span><span class="cm-operator">=</span><span class="cm-number">20</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">xlab</span>(<span class="cm-string">"log2 fold change"</span>) <span class="cm-operator">+</span> <span class="cm-variable">ylab</span>(<span class="cm-string">"-log10 p-value"</span>) <span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ggtitle</span>(<span class="cm-variable">this_title</span>) <span class="cm-operator">+</span> <span class="cm-variable">theme</span>(<span class="cm-variable">plot.title</span> <span class="cm-operator">=</span> <span class="cm-variable">element_text</span>(<span class="cm-variable">size</span> <span class="cm-operator">=</span> <span class="cm-number">15</span>,<span class="cm-variable">hjust</span> <span class="cm-operator">=</span> <span class="cm-number">0.5</span>))<span class="cm-operator">+</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">scale_colour_manual</span>(<span class="cm-variable">values</span> <span class="cm-operator">=</span> <span class="cm-variable">c</span>(<span class="cm-string">'blue'</span>,<span class="cm-string">'black'</span>,<span class="cm-string">'red'</span>)) <span class="cm-comment"># 不同区域的颜色</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 468px;"></div><div class="CodeMirror-gutters" style="display: none; height: 468px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">logFC</span> &nbsp;<span class="cm-variable">AveExpr</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">P.Value</span> &nbsp;<span class="cm-variable">adj.P.Val</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">B</span> <span class="cm-variable">change</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TBC1D2B</span> <span class="cm-operator">-</span><span class="cm-number">1.0284628</span> <span class="cm-number">5.620700</span> <span class="cm-operator">-</span><span class="cm-number">5.837748</span> <span class="cm-number">8.228423e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.352549</span> &nbsp; <span class="cm-variable">DOWN</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLIC1</span> &nbsp; &nbsp;<span class="cm-number">0.9888221</span> <span class="cm-number">9.954273</span> &nbsp;<span class="cm-number">5.773178</span> <span class="cm-number">9.545919e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.231487</span> &nbsp; &nbsp; <span class="cm-variable">UP</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DLEU1</span> &nbsp; &nbsp;<span class="cm-number">1.8301554</span> <span class="cm-number">6.950685</span> &nbsp;<span class="cm-number">5.741354</span> <span class="cm-number">1.027259e-05</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.171586</span> &nbsp; &nbsp; <span class="cm-variable">UP</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 104px;"></div><div class="CodeMirror-gutters" style="display: none; height: 104px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\039.png" alt="039" style="zoom:50%;" /></p><ol start='20' ><li><span>对T检验结果的P值和limma包差异分析的P值画散点图，看看哪些基因相差很大。</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">head</span>(<span class="cm-variable">DEG_t.test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DEG_t.test1</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">DEG_t.test</span>[<span class="cm-variable">rownames</span>(<span class="cm-variable">nrDEG</span>),]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 可以看到logFC是相反的</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">DEG_t.test1</span>[,<span class="cm-number">3</span>],<span class="cm-variable">nrDEG</span>[,<span class="cm-number">1</span>]) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 可以看到使用limma包和t.test本身的p值差异尚可接受</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">DEG_t.test1</span>[,<span class="cm-number">4</span>],<span class="cm-variable">nrDEG</span>[,<span class="cm-number">4</span>]) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-operator">-</span><span class="cm-variable">log10</span>(<span class="cm-variable">DEG_t.test1</span>[,<span class="cm-number">4</span>]),<span class="cm-operator">-</span><span class="cm-variable">log10</span>(<span class="cm-variable">nrDEG</span>[,<span class="cm-number">4</span>]))</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 208px;"></div><div class="CodeMirror-gutters" style="display: none; height: 208px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">nrDEG</span>)</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">logFC</span> &nbsp;<span class="cm-variable">AveExpr</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">t</span> &nbsp; &nbsp; &nbsp;<span class="cm-variable">P.Value</span> &nbsp;<span class="cm-variable">adj.P.Val</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">B</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">TBC1D2B</span> <span class="cm-operator">-</span><span class="cm-number">1.0284628</span> <span class="cm-number">5.620700</span> <span class="cm-operator">-</span><span class="cm-number">5.837748</span> <span class="cm-number">8.228423e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.352549</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">CLIC1</span> &nbsp; &nbsp;<span class="cm-number">0.9888221</span> <span class="cm-number">9.954273</span> &nbsp;<span class="cm-number">5.773178</span> <span class="cm-number">9.545919e-06</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.231487</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DLEU1</span> &nbsp; &nbsp;<span class="cm-number">1.8301554</span> <span class="cm-number">6.950685</span> &nbsp;<span class="cm-number">5.741354</span> <span class="cm-number">1.027259e-05</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.171586</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SH3BP2</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">1.3835699</span> <span class="cm-number">4.463438</span> <span class="cm-operator">-</span><span class="cm-number">5.735847</span> <span class="cm-number">1.040396e-05</span> <span class="cm-number">0.02282628</span> <span class="cm-number">3.161205</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">GPM6A</span> &nbsp; &nbsp;<span class="cm-number">2.5471980</span> <span class="cm-number">6.915045</span> &nbsp;<span class="cm-number">5.043623</span> <span class="cm-number">5.260547e-05</span> <span class="cm-number">0.08915221</span> <span class="cm-number">1.822622</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">YTHDC2</span> &nbsp;<span class="cm-operator">-</span><span class="cm-number">0.5187135</span> <span class="cm-number">7.602354</span> <span class="cm-operator">-</span><span class="cm-number">4.873743</span> <span class="cm-number">7.877050e-05</span> <span class="cm-number">0.08915221</span> <span class="cm-number">1.485155</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">&gt;</span> <span class="cm-variable">head</span>(<span class="cm-variable">DEG_t.test</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">avg_1</span> &nbsp; &nbsp;<span class="cm-variable">avg_2</span> &nbsp; &nbsp; <span class="cm-variable">log2FC</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">pvals</span> &nbsp; &nbsp; <span class="cm-variable">p.adj</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">SGSM2</span> &nbsp;<span class="cm-number">7.875615</span> <span class="cm-number">8.791753</span> &nbsp;<span class="cm-number">0.1587582</span> <span class="cm-number">1.629755e-05</span> <span class="cm-number">0.1430273</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">PDE8A</span> &nbsp;<span class="cm-number">6.622749</span> <span class="cm-number">7.965007</span> &nbsp;<span class="cm-number">0.2662455</span> <span class="cm-number">4.058944e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DLEU1</span> &nbsp;<span class="cm-number">7.616197</span> <span class="cm-number">5.786041</span> <span class="cm-operator">-</span><span class="cm-number">0.3964941</span> <span class="cm-number">6.965416e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">LDOC1</span> &nbsp;<span class="cm-number">4.456446</span> <span class="cm-number">2.152471</span> <span class="cm-operator">-</span><span class="cm-number">1.0498998</span> <span class="cm-number">8.993339e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">USP6NL</span> <span class="cm-number">5.988866</span> <span class="cm-number">7.058738</span> &nbsp;<span class="cm-number">0.2371274</span> <span class="cm-number">9.648226e-05</span> <span class="cm-number">0.1693457</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">COMMD4</span> <span class="cm-number">4.157971</span> <span class="cm-number">3.407405</span> <span class="cm-operator">-</span><span class="cm-number">0.2872063</span> <span class="cm-number">2.454557e-04</span> <span class="cm-number">0.2644545</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 416px;"></div><div class="CodeMirror-gutters" style="display: none; height: 416px;"></div></div></div></pre><figure><table><thead><tr><th><img src="img\004_生信人应该这样学R语言\040.png" referrerpolicy="no-referrer" alt="040"></th><th><img src="img\004_生信人应该这样学R语言\041.png" referrerpolicy="no-referrer" alt="041"></th><th><img src="img\004_生信人应该这样学R语言\042.png" referrerpolicy="no-referrer" alt="042"></th></tr></thead><tbody></tbody></table></figure><ol start='21' ><li><span>其他：</span></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制两组（"stable", "progres."）差异分析的箱线图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">ggplot2</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">ggpubr</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">my_comparisons</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-builtin">list</span>(</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">c</span>(<span class="cm-string">"stable"</span>, <span class="cm-string">"progres."</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">dat</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">data.frame</span>(<span class="cm-variable">group</span> <span class="cm-operator">=</span> <span class="cm-variable">group</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">sampleID</span> <span class="cm-operator">=</span> <span class="cm-variable">names</span>(<span class="cm-variable">experSet</span>[<span class="cm-string">'DLEU1'</span>,]),</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">values</span> <span class="cm-operator">=</span> <span class="cm-variable">as.numeric</span>(<span class="cm-variable">experSet</span>[<span class="cm-string">'DLEU1'</span>,]))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ggboxplot</span>(<span class="cm-variable">dat</span>,<span class="cm-variable">x</span> <span class="cm-operator">=</span> <span class="cm-string">"group"</span>,<span class="cm-variable">y</span> <span class="cm-operator">=</span> <span class="cm-string">"values"</span>,<span class="cm-variable">col</span> <span class="cm-operator">=</span> <span class="cm-string">"group"</span>,<span class="cm-variable">add</span> <span class="cm-operator">=</span> <span class="cm-string">"jitter"</span>) <span class="cm-operator">+</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># 设置要比较的分组，同时使用t.test方法进行计算</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">stat_compare_means</span>(<span class="cm-variable">comparisons</span> <span class="cm-operator">=</span> <span class="cm-variable">my_comparisons</span>, <span class="cm-variable">method</span> <span class="cm-operator">=</span> <span class="cm-string">"t.test"</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 312px;"></div><div class="CodeMirror-gutters" style="display: none; height: 312px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\043.png" alt="043" style="zoom:67%;" /></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 绘制热图</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">pheatmap</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_gene</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">head</span>(<span class="cm-variable">rownames</span>(<span class="cm-variable">nrDEG</span>),<span class="cm-number">25</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">experSet</span>[<span class="cm-variable">choose_gene</span>,]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">choose_matrix</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">t</span>(<span class="cm-variable">scale</span>(<span class="cm-variable">t</span>(<span class="cm-variable">choose_matrix</span>)))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">pheatmap</span>(<span class="cm-variable">choose_matrix</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 156px;"></div><div class="CodeMirror-gutters" style="display: none; height: 156px;"></div></div></div></pre><p><img src="img\004_生信人应该这样学R语言\044.png" alt="044" style="zoom:67%;" /></p><h2 id='十八r语言可视化'><span>十八、R语言可视化</span></h2><ul><li><span>rstudio rmarkdown官方教程：</span><code>https://rmarkdown.rstudio.com/lesson-1.html</code></li></ul><h2 id='十九shiny编写网页'><span>十九、shiny编写网页</span></h2><h2 id='二十r语言操作图片'><span>二十、R语言操作图片</span></h2><h2 id='二一r语言爬虫'><span>二一、R语言爬虫</span></h2><ul><li><span>RCurl</span></li><li><span>rvest</span></li></ul><h2 id='二二r语言id转换'><span>二二、R语言ID转换</span></h2><ul><li><span>见 生物信息学-008_ID转换。</span></li></ul><h2 id='二三多个差异分析结果直接量量取交集并集'><span>二三、多个差异分析结果直接量量取交集并集</span></h2><ul><li><a href='http://www.biotrainee.com/thread-1288-1-1.html' target='_blank' class='url'>http://www.biotrainee.com/thread-1288-1-1.html</a></li><li><span>交集/并集</span></li></ul><h2 id='二四wgcna'><span>二四、WGCNA</span></h2><ul><li><a href='http://www.biotrainee.com/thread-205-1-1.html'><span>[tutorial] 学习WGCNA总结</span></a><span> </span></li><li><a href='https://tiramisutes.github.io/'><span>个人博客</span></a><span> </span></li></ul><h2 id='二五rna-seq分析'><span>二五、RNA-seq分析</span></h2><ul><li><span>RNAseq analysis in R：</span><a href='https://combine-australia.github.io/RNAseq-R/' target='_blank' class='url'>https://combine-australia.github.io/RNAseq-R/</a></li><li><span>曾键明的RNA-seq的分析代码：</span><a href='https://github.com/jmzeng1314/my-R/blob/master/10-RNA-seq-3-groups/hisat2_mm10_htseq.R' target='_blank' class='url'>https://github.com/jmzeng1314/my-R/blob/master/10-RNA-seq-3-groups/hisat2_mm10_htseq.R</a></li></ul><pre class="md-fences md-end-block ty-contain-cm" spellcheck="false" lang="r"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 10.9991px; left: 3.99306px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">DT</span><span class="cm-operator">::</span><span class="cm-variable">datatable</span>()</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sessionInfo</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 52px;"></div><div class="CodeMirror-gutters" style="display: none; height: 52px;"></div></div></div></pre></div></div>
</body>
</html>